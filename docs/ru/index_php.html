<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="HandheldFriendly" content="true" />
    <title>Документация &laquo; phpDaemon</title>
    <!-- <base href="http://daemon.io/" /> -->
    
    <link rel="shortcut icon" href="/favicon.png" type="image/png" />
    <link rel="icon" href="/favicon.png" type="image/png" />

    <link rel="stylesheet" href="../css/normalize.min.css" />
    <link rel="stylesheet" href="../css/highlight.github.css" />
    <link rel="stylesheet" href="../css/font-awesome.min.css" />
    <link rel="stylesheet" href="../css/styles.doc.css" />
</head>
<body>
    <header>
        <div class="center">
            <a href="/" id="logo" title="phpDaemon">phpDaemon</a>
            <a href="?" id="langchoose" title="phpDaemon">{language}</a>
            <menu>
                <li><span><a href="http://daemon.io/examples.html" title="Examples">Примеры</a></span></li>
                <li><span><a href="/faq.html" title="FAQ">ЧАВО</a></span></li>
                <li class="active"><span><a href="http://daemon.io/docs/ru/" title="Documentation">Документация</a></span></li>
                <li><span><a href="https://github.com/kakserpom/phpdaemon/issues" title="Tracker" target="_blank">Задачи/ошибки</a></span></li>
                <li><span><a href="http://daemon.io/team.html" title="Team">Команда</a></span></li>
                <li><span><a href="http://daemon.io/contribute.html" title="Contribute">Участие</a></span></li>
                <li><span><a href="http://daemon.io/publications.html" title="Publications">Публикации</a></span></li>
            </menu>
        </div>
    </header>
    <div class="lang-chooser">
        <!-- <div class="center"> -->
            <ul>
                <li><a href="/docs/en/">English</a></li><li class="active"><a href="/docs/ru/">Русский</a></li>
            </ul>
        <!-- </div> -->
    </div>
    <div class="mainhead"></div>
    <a class="toggle_sidebar_button">
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
    </a>
    <div class="sidebar">
        <ul>
<li><a href="#intro"><span>Введение</span></a>
<ul>
<li><a href="#intro/usage"><span>Пользование документацией</span></a>
<ul>
<li><a href="#intro/usage/hotkeys"><span>Горячие клавиши</span></a></li>
</ul></li></li>
</ul></li>
<li><a href="#install"><span>Установка</span></a>
<ul>
<li><a href="#install/requirements"><span>Требования</span></a></li>
<li><a href="#install/sources"><span>Исходный код</span></a></li>
<li><a href="#install/composer"><span>Composer</span></a></li>
<li><a href="#install/redhat"><span>CentOS/RedHat</span></a></li>
<li><a href="#install/ubuntu"><span>Ubuntu</span></a></li>
<li><a href="#install/gentoo"><span>Gentoo</span></a></li>
</ul></li>
<li><a href="#basics"><span>Основы</span></a>
<ul>
<li><a href="#basics/pseudotypes"><span>Псевдотипы</span></a>
<ul>
<li><a href="#basics/pseudotypes/url"><span>url</span></a></li>
</ul></li></li>
</ul></li>
<li><a href="#control"><span>Управление</span></a></li>
<li><a href="#examples"><span>Примеры</span></a></li>
<li><a href="#app_resolver"><span>Маршрутизация</span></a></li>
<li><a href="#config"><span>Конфигурация</span></a>
<ul>
<li><a href="#config/types"><span>Типы данных</span></a>
<ul>
<li><a href="#config/types/size"><span>Size</span></a></li>
<li><a href="#config/types/time"><span>Time</span></a></li>
<li><a href="#config/types/number"><span>Number</span></a></li>
</ul></li>
<li><a href="#config/variables"><span>Глобальные опции</span></a>
<ul>
<li><a href="#config/variables/file"><span>Конфигурационный файл</span></a></li>
<li><a href="#config/variables/graceful_restart"><span>Плавный перезапуск рабочих процессов</span></a></li>
<li><a href="#config/variables/pathes"><span>Основные пути</span></a></li>
<li><a href="#config/variables/master"><span>Связанные с мастер-процессом</span></a></li>
<li><a href="#config/variables/requests"><span>Запросы</span></a></li>
<li><a href="#config/variables/workers"><span>Рабочие процессы</span></a></li>
<li><a href="#config/variables/logging"><span>Журналирование и отладка</span></a></li>
<li><a href="#config/variables/eio"><span>Подсистема ввода-вывода POSIX</span></a></li>
</ul></li>
<li><a href="#config/application"><span>Приложения</span></a></li>
</ul></li>
<li><a href="#development"><span>Разработка</span></a>
<ul>
<li><a href="#development/pseudotypes"><span>Псевдотипы</span></a>
<ul>
<li><a href="#development/pseudotypes/url"><span>url</span></a></li>
</ul></li>
<li><a href="#development/app_instance"><span>Приложение</span></a></li>
<li><a href="#development/request"><span>Обработка запросов</span></a></li>
<li><a href="#development/servers_clients"><span>Серверы и клиенты</span></a></li>
<li><a href="#development/debugging"><span>Отладка</span></a></li>
</ul></li>
<li><a href="#servers"><span>Серверы</span></a>
<ul>
<li><a href="#servers/options"><span>Опции серверов</span></a></li>
<li><a href="#servers/http"><span>HTTP</span></a>
<ul>
<li><a href="#servers/http/options"><span>Опции</span></a></li>
</ul></li>
<li><a href="#servers/fastcgi"><span>FastCGI</span></a>
<ul>
<li><a href="#servers/fastcgi/options"><span>Опции</span></a></li>
</ul></li>
<li><a href="#servers/debugconsole"><span>DebugConsole</span></a>
<ul>
<li><a href="#servers/debugconsole/options"><span>Опции</span></a></li>
</ul></li>
<li><a href="#servers/flashpolicy"><span>FlashPolicy</span></a>
<ul>
<li><a href="#servers/flashpolicy/options"><span>Опции</span></a></li>
</ul></li>
<li><a href="#servers/ident"><span>Servers\Ident</span></a></li>
<li><a href="#servers/ircbouncer"><span>Servers\IRCBouncer</span></a></li>
<li><a href="#servers/lock"><span>Lock</span></a></li>
<li><a href="#servers/socks"><span>Servers\Socks</span></a></li>
<li><a href="#servers/websocket"><span>WebSocket</span></a>
<ul>
<li><a href="#servers/websocket/options"><span>Опции</span></a></li>
</ul></li></li>
</ul></li>
<li><a href="#clients"><span>Клиенты</span></a>
<ul>
<li><a href="#clients/basics"><span>Основы</span></a>
<ul>
<li><a href="#clients/basics/options"><span>Опции клиентов</span></a></li>
</ul></li>
<li><a href="#clients/asterisk"><span>Asterisk</span></a>
<ul>
<li><a href="#clients/asterisk/use"><span>Использование</span></a>
<ul>
<li><a href="#clients/asterisk/use/connect"><span>Соединение</span></a></li>
<li><a href="#clients/asterisk/use/io"><span>Немного о формате ввода-вывода</span></a></li>
<li><a href="#clients/asterisk/use/cmds"><span>Отправка команд и получение ответа</span></a></li>
<li><a href="#clients/asterisk/use/events"><span>Получение событий сервера</span></a></li>
</ul></li>
<li><a href="#clients/asterisk/example"><span>Пример реконнекта</span></a></li>
<li><a href="#clients/asterisk/pool"><span>Класс Pool <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/Asterisk/Pool.php"><i class="fa fa-github"></i></a></span></a>
<ul>
<li><a href="#clients/asterisk/pool/options"><span>Опции по-умолчанию</span></a></li>
<li><a href="#clients/asterisk/pool/methods"><span>Методы</span></a></li>
</ul></li>
<li><a href="#clients/asterisk/connection"><span>Класс Connection <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/Asterisk/Connection.php"><i class="fa fa-github"></i></a></span></a>
<ul>
<li><a href="#clients/asterisk/connection/methods"><span>Методы</span></a></li>
</ul></li></li>
</ul></li>
<li><a href="#clients/dns"><span>Clients\DNS</span></a></li>
<li><a href="#clients/gibson"><span>Clients\Gibson</span></a></li>
<li><a href="#clients/http"><span>HTTP</span></a>
<ul>
<li><a href="#clients/http/examples"><span>Примеры</span></a></li>
<li><a href="#clients/http/pool"><span>Класс Pool <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/HTTP/Pool.php"><i class="fa fa-github"></i></a></span></a>
<ul>
<li><a href="#clients/http/pool/options"><span>Опции по-умолчанию</span></a></li>
<li><a href="#clients/http/pool/methods"><span>Методы</span></a></li>
</ul></li>
<li><a href="#clients/http/connection"><span>Класс Connection <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/HTTP/Connection.php"><i class="fa fa-github"></i></a></span></a>
<ul>
<li><a href="#clients/http/connection/properties"><span>Свойства</span></a></li>
<li><a href="#clients/http/connection/methods"><span>Методы</span></a></li>
</ul></li></li>
</ul></li>
<li><a href="#clients/icmp"><span>Clients\ICMP</span></a></li>
<li><a href="#clients/irc"><span>Clients\IRC</span></a></li>
<li><a href="#clients/lock"><span>Lock</span></a></li>
<li><a href="#clients/memcache"><span>Clients\Memcache</span></a></li>
<li><a href="#clients/mongo"><span>Clients\Mongo</span></a></li>
<li><a href="#clients/mysql"><span>MySQL</span></a>
<ul>
<li><a href="#clients/mysql/use"><span>Использование</span></a>
<ul>
<li><a href="#clients/mysql/use/prepare"><span>Подготовка объекта соединения</span></a></li>
</ul></li>
<li><a href="#clients/mysql/examples"><span>Примеры</span></a></li>
<li><a href="#clients/mysql/pool"><span>Класс Pool <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/MySQL/Pool.php"><i class="fa fa-github"></i></a></span></a>
<ul>
<li><a href="#clients/mysql/pool/options"><span>Опции по-умолчанию</span></a></li>
<li><a href="#clients/mysql/pool/methods"><span>Методы</span></a></li>
</ul></li>
<li><a href="#clients/mysql/connection"><span>Класс Connection <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/MySQL/Connection.php"><i class="fa fa-github"></i></a></span></a>
<ul>
<li><a href="#clients/mysql/connection/properties"><span>Свойства</span></a></li>
<li><a href="#clients/mysql/connection/methods"><span>Методы</span></a></li>
</ul></li></li>
</ul></li>
<li><a href="#clients/postgresql"><span>Clients\PostgreSQL</span></a></li>
<li><a href="#clients/redis"><span>Clients\Redis</span></a></li>
<li><a href="#clients/valve"><span>Clients\Valve</span></a></li>
<li><a href="#clients/websocket"><span>Clients\WebSocket</span></a></li>
<li><a href="#clients/xmpp"><span>Clients\XMPP</span></a></li>
</ul></li>
<li><a href="#lib"><span>Библиотеки</span></a>
<ul>
<li><a href="#lib/cache"><span>Cache</span></a>
<ul>
<li><a href="#lib/cache/capped-storage"><span>Класс CappedStorage <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Cache/CappedStorage.php"><i class="fa fa-github"></i></a></span></a>
<ul>
<li><a href="#lib/cache/capped-storage/properties"><span>Свойства</span></a></li>
<li><a href="#lib/cache/capped-storage/methods"><span>Методы</span></a></li>
</ul></li>
<li><a href="#lib/cache/item"><span>Класс Item <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Cache/Item.php"><i class="fa fa-github"></i></a></span></a>
<ul>
<li><a href="#lib/cache/item/properties"><span>Свойства</span></a></li>
<li><a href="#lib/cache/item/methods"><span>Методы</span></a></li>
</ul></li>
<li><a href="#lib/cache/capped-storage-hits"><span>Класс CappedStorageHits <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Cache/CappedStorageHits.php"><i class="fa fa-github"></i></a></span></a></li>
</ul></li>
<li><a href="#lib/complexjob"><span>ComplexJob</span></a>
<ul>
<li><a href="#lib/complexjob/consts"><span>Константы</span></a></li>
<li><a href="#lib/complexjob/properties"><span>Свойства</span></a></li>
<li><a href="#lib/complexjob/methods"><span>Методы</span></a></li>
</ul></li>
<li><a href="#lib/shellcommand"><span>ShellCommand</span></a>
<ul>
<li><a href="#lib/shellcommand/examples"><span>Примеры</span></a></li>
<li><a href="#lib/shellcommand/properties"><span>Свойства</span></a></li>
<li><a href="#lib/shellcommand/methods"><span>Методы</span></a></li>
</ul></li>
<li><a href="#lib/timer"><span>Timer</span></a>
<ul>
<li><a href="#lib/timer/global-functions"><span>Глобальные функции </span></a></li>
<li><a href="#lib/timer/properties"><span>Свойства</span></a></li>
<li><a href="#lib/timer/methods"><span>Методы</span></a></li>
</ul></li>
<li><a href="#lib/transport-context"><span>TransportContext</span></a>
<ul>
<li><a href="#lib/transport-context/filesystem"><span>Класс FileSystem <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/FS/FileSystem.php"><i class="fa fa-github"></i></a></span></a>
<ul>
<li><a href="#lib/transport-context/filesystem/properties"><span>Свойства</span></a></li>
<li><a href="#lib/transport-context/filesystem/methods"><span>Методы</span></a></li>
</ul></li>
<li><a href="#lib/transport-context/file"><span>Класс File <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/FS/File.php"><i class="fa fa-github"></i></a></span></a>
<ul>
<li><a href="#lib/transport-context/file/properties"><span>Свойства</span></a></li>
<li><a href="#lib/transport-context/file/methods"><span>Методы</span></a></li>
</ul></li>
<li><a href="#lib/transport-context/filewatcher"><span>Класс FileWatcher <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/FS/FileWatcher.php"><i class="fa fa-github"></i></a></span></a>
<ul>
<li><a href="#lib/transport-context/filewatcher/properties"><span>Свойства</span></a></li>
<li><a href="#lib/transport-context/filewatcher/methods"><span>Методы</span></a></li>
</ul></li></li>
</ul></li>
<li><a href="#lib/pubsub"><span>PubSub</span></a>
<ul>
<li><a href="#lib/pubsub/pubsub"><span>Класс PubSub <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/PubSub/PubSub.php"><i class="fa fa-github"></i></a></span></a>
<ul>
<li><a href="#lib/pubsub/pubsub/methods"><span>Методы</span></a></li>
</ul></li>
<li><a href="#lib/pubsub/pubsubevent"><span>Класс PubSubEvent <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/PubSub/PubSubEvent.php"><i class="fa fa-github"></i></a></span></a></li>
<li><a href="#lib/pubsub/application"><span>Класс Application <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/SockJS/Application.php"><i class="fa fa-github"></i></a></span></a>
<ul>
<li><a href="#lib/pubsub/application/methods"><span>Методы</span></a></li>
</ul></li></li>
</ul></li></li>
</ul></li>
<li><a href="#apps"><span>Приложения</span></a>
<ul>
<li><a href="#apps/mongonode"><span>MongoNode</span></a>
<ul>
<li><a href="#apps/mongonode/use"><span>Использование</span></a></li>
</ul></li>
<li><a href="#apps/serverstatus"><span>ServerStatus</span></a>
<ul>
<li><a href="#apps/serverstatus/note"><span>Примечание</span></a></li>
</ul></li></li>
</ul></li>
<li><a href="#utils"><span>Утилиты</span></a>
<ul>
<li><a href="#utils/binary"><span>Binary</span></a>
<ul>
<li><a href="#utils/binary/methods"><span>Методы</span></a></li>
</ul></li>
<li><a href="#utils/crypt"><span>Crypt</span></a>
<ul>
<li><a href="#utils/crypt/methods"><span>Методы</span></a></li>
</ul></li>
<li><a href="#utils/datetime"><span>DateTime</span></a>
<ul>
<li><a href="#utils/datetime/methods"><span>Методы</span></a></li>
</ul></li>
<li><a href="#utils/irc"><span>IRC</span></a>
<ul>
<li><a href="#utils/irc/methods"><span>Методы</span></a></li>
</ul></li>
<li><a href="#utils/mime"><span>MIME</span></a>
<ul>
<li><a href="#utils/mime/methods"><span>Методы</span></a></li>
</ul></li>
<li><a href="#utils/shmentity"><span>ShmEntity</span></a>
<ul>
<li><a href="#utils/shmentity/methods"><span>Методы</span></a></li>
</ul></li>
<li><a href="#utils/terminal"><span>Terminal</span></a>
<ul>
<li><a href="#utils/terminal/methods"><span>Методы</span></a></li>
</ul></li></li>
</ul></li>
<li><a href="#structures"><span>Структуры</span></a>
<ul>
<li><a href="#structures/object-storage"><span>ObjectStorage</span></a>
<ul>
<li><a href="#structures/object-storage/methods"><span>Методы</span></a></li>
</ul></li>
<li><a href="#structures/stack-callbacks"><span>StackCallbacks</span></a></li>
<li><a href="#structures/static-object-watchdog"><span>StaticObjectWatchdog</span></a></li>
<li><a href="#structures/strict-static-object-watchdog"><span>StrictStaticObjectWatchdog</span></a></li>
<li><a href="#structures/deferred-event-handlers"><span>DeferredEventHandlers</span></a></li>
<li><a href="#structures/event-handlers"><span>EventHandlers</span></a></li>
<li><a href="#structures/sessions"><span>Sessions</span></a></li>
<li><a href="#structures/dnode"><span>DNode</span></a>
<ul>
<li><a href="#structures/dnode/methods"><span>Методы</span></a></li>
</ul></li></li>
</ul></li>
<li><a href="#network"><span>Сеть</span></a>
<ul>
<li><a href="#network/pool"><span>Пул</span></a>
<ul>
<li><a href="#network/pool/properties"><span>Свойства</span></a></li>
<li><a href="#network/pool/methods"><span>Методы</span></a></li>
</ul></li>
<li><a href="#network/client"><span>Client</span></a>
<ul>
<li><a href="#network/client/methods"><span>Методы</span></a></li>
</ul></li>
<li><a href="#network/connection"><span>Connection</span></a>
<ul>
<li><a href="#network/connection/properties"><span>Свойства</span></a></li>
<li><a href="#network/connection/methods"><span>Методы</span></a></li>
</ul></li>
<li><a href="#network/server"><span>Server</span></a>
<ul>
<li><a href="#network/server/properties"><span>Свойства</span></a></li>
<li><a href="#network/server/methods"><span>Методы</span></a></li>
</ul></li>
<li><a href="#network/input"><span>Input</span></a>
<ul>
<li><a href="#network/input/properties"><span>Свойства</span></a></li>
<li><a href="#network/input/methods"><span>Методы</span></a></li>
</ul></li></li>
</ul></li>
<li><a href="#faq"><span>ЧаВО</span></a></li>
<li><a href="#publications"><span>Публикации</span></a></li>
<li><a href="#contribute"><span>Внести свою лепту</span></a>
<ul>
<li><a href="#contribute/this-doc"><span>Эта документация</span></a>
<ul>
<li><a href="#contribute/this-doc/commiting"><span>Внесение изменений</span></a></li>
<li><a href="#contribute/this-doc/markdown"><span>Формат документации</span></a>
<ul>
<li><a href="#contribute/this-doc/markdown/nesting"><span>Вложенность</span></a></li>
<li><a href="#contribute/this-doc/markdown/const"><span>Константы</span></a></li>
<li><a href="#contribute/this-doc/markdown/headers"><span>Заголовки</span></a></li>
<li><a href="#contribute/this-doc/markdown/lists"><span>Списки</span></a></li>
<li><a href="#contribute/this-doc/markdown/italic_bold"><span>Курсив и жирный</span></a></li>
<li><a href="#contribute/this-doc/markdown/simple_code"><span>Однострочный код</span></a></li>
<li><a href="#contribute/this-doc/markdown/multi_code"><span>Многострочный код</span></a></li>
<li><a href="#contribute/this-doc/markdown/tables"><span>Таблицы</span></a></li>
</ul></li></li>
</ul></li>
<li><a href="#contribute/php-doc"><span>PHPDoc</span></a></li>
<li><a href="#contribute/code"><span>Программный код</span></a></li>
</ul></li>
<li><a href="#doc-authors"><span>Авторы документации</span></a>
<ul>
<li><a href="#doc-authors/writing"><span>Написание</span></a></li>
<li><a href="#doc-authors/translation"><span>Перевод на русский</span></a></li>
<li><a href="#doc-authors/proofreading"><span>Корректура русской версии</span></a></li>
<li><a href="#doc-authors/scripting"><span>Программирование</span></a></li>
</ul></li>
</ul>

    </div>
    <div class="sidebar-downbtn">
        <i class="fa fa-arrow-down"></i>
    </div>
    <div class="main_wrap">
        <div class="main_container">
            
            <h2 id="intro"><div class="in anchor">Введение</div>

</h2>
<p class="doc-notice"><strong>Achtung!</strong><br />Only Russian version is available at the moment, but we are about to publish the English one and a variety of other translations. Currently you may consider reading old Wiki or auto-translating this page.<br />We are terribly sorry for the inconviniece.</p>
<p class="doc-notice">Документация активно дорабатывается!</p>
<p>PHPDaemon — это асинхронный демонизируемый фреймворк.
С&#160;его помощью легко писать очень быстрые сетевые приложения, веб-сервисы и многое другое.
Из&#160;коробки идут сервера FastCGI, HTTP, CGI, FlashPolicy, Telnet, WebSocket; клиенты MySQL, Redis, MongoDB, PostgreSQL, Memcached, IRC, XMPP и&#160;другие.
Работать с&#160;сетью действительно просто. Программист средней руки может написать, к&#160;примеру, полноценного IRC-бота за&#160;час.</p>
<ul>
<li>Официальный сайт <a href="http://daemon.io/">daemon.io</a>.  </li>
<li>GitHub репозиторий <a href="https://github.com/kakserpom/phpdaemon/">github.com/kakserpom/phpdaemon</a>.  </li>
<li>Обсудить проект можно&#160;в <a href="http://groups.google.com/group/phpdaemon">Google Groups</a>.  </li>
<li><a href="https://github.com/kakserpom/phpdaemon/issues">Отслеживание задач/ошибок</a></li>
</ul>
<h3 id="intro/usage"><div class="in anchor">Пользование документацией<span class="header-path"> <i>&larr;</i> <a href="#intro">Введение</a></span></div>

</h3>
<p>Как видите, вся документация представлена на одной странице, поэтому вы можете пользоваться обычным поиском по странице (горячая клавиша <code>Ctrl</code>&#160;+&#160;<code>F</code> или <code>Cmd</code>&#160;+&#160;<code>F</code>)</p>
<h4 id="intro/usage/hotkeys"><div class="in anchor">Горячие клавиши<span class="header-path"> <i>&larr;</i> <a href="#intro/usage">Пользование документацией</a> <i>&larr;</i> <a href="#intro">Введение</a></span></div>

</h4>
<ul>
<li><code>Ctrl</code> + <code>↑</code> — к предыдущему разделу на текущем уровне</li>
<li><code>Ctrl</code> + <code>↓</code> — к следующему разделу на текущем уровне</li>
<li><code>Ctrl</code> + <code>→</code> — на уровень вглубь</li>
<li><code>Ctrl</code> + <code>←</code> — на уровень ближе к поверхности</li>
</ul>
<h2 id="install"><div class="in anchor">Установка</div>

</h2>
<h3 id="install/requirements"><div class="in anchor">Требования<span class="header-path"> <i>&larr;</i> <a href="#install">Установка</a></span></div>

</h3>
<ul>
<li><code>PHP</code> версии не ниже 5.4;</li>
<li>Модули <code>posix</code>, <code>pcntl</code>, <code>socket</code>, <code>shmop</code>;</li>
<li><code>libevent 2</code>;</li>
<li><code>pecl-event</code> версии не ниже 1.6.1;</li>
</ul>
<p>Рекомендуется также установить:</p>
<ul>
<li><code>pecl-eio</code> для увеличения проиводительности файловой системы;</li>
<li><code>pecl-proctitle</code> для именования процессов в&#160;понятные названия: &#171;phpd: worker process&#187; (для PHP версии ниже 5.5);</li>
<li><code>pecl-inotify</code> для мониторинга файловой системы.</li>
</ul>
<h3 id="install/sources"><div class="in anchor">Исходный код<span class="header-path"> <i>&larr;</i> <a href="#install">Установка</a></span></div>

</h3>
<p>Вы можете клонировать PHPDaemon репозиторий<br />
$&nbsp;<code>git clone https://github.com/kakserpom/phpdaemon.git</code></p>
<p>Или скачать текущую версию в виде архива<br />
$&nbsp;<code>wget https://github.com/kakserpom/phpdaemon/archive/master.zip</code></p>
<p>Установите необходимые модули<br />
$&nbsp;<code>pecl install event eio proctitle inotify</code></p>
<h3 id="install/composer"><div class="in anchor">Composer<span class="header-path"> <i>&larr;</i> <a href="#install">Установка</a></span></div>

</h3>
<p>Добавьте раздел в ваш composer.json</p>
<pre><code>"require" : {
    "kakserpom/phpdaemon" : "dev-master"
}</code></pre>
<p>Подробная информации о пакете на <a href="https://packagist.org/packages/kakserpom/phpdaemon">packagist.org</a>.</p>
<h3 id="install/redhat"><div class="in anchor">CentOS/RedHat<span class="header-path"> <i>&larr;</i> <a href="#install">Установка</a></span></div>

</h3>
<p>Для начала необходимо установить все сопутстсующие утилиты.<br />
$&nbsp;<code>sudo yum install -y git gcc openssl-devel libevent</code></p>
<p>Чтобы установить PHP 5.5 необходимо добавить Remi и Epel репозитории, потому что стандартный содержит старую версию.</p>
<p>Для RHEL/CentOS 6.4-6.0 32 Bit.<br />
$&nbsp;<code>sudo rpm -Uvh http://download.fedoraproject.org/pub/epel/6/i386/epel-release-6-8.noarch.rpm</code><br />
$&nbsp;<code>sudo rpm -Uvh http://rpms.famillecollet.com/enterprise/remi-release-6.rpm</code></p>
<p>Для RHEL/CentOS 6.4-6.0 64 Bit.<br />
$&nbsp;<code>sudo rpm -Uvh http://download.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm</code><br />
$&nbsp;<code>sudo rpm -Uvh http://rpms.famillecollet.com/enterprise/remi-release-6.rpm</code></p>
<p>Устанавливаем PHP.<br />
$&nbsp;<code>sudo yum --enablerepo=remi,remi-test install -y php-cli php-devel php-pear php-process</code></p>
<p>Далее устанавливаем pecl модули.<br />
$&nbsp;<code>sudo -i</code><br />
$&nbsp;<code>pecl install event eio</code></p>
<p>В PHP отсутсвует контроль подгрузки модулей. Для корректной работы модуля event и eio необходим модуль sockets.
В системах RedHat/CentOS модули подгружаются в порядке названия, поэтому назовем конфиги этих модулей как z-event.ini и z-eio.ini соответсвенно.<br />
$&nbsp;<code>echo "extension=event.so" &gt; /etc/php.d/z-event.ini</code>
$&nbsp;<code>echo "extension=eio.so" &gt; /etc/php.d/z-eio.ini</code></p>
<p><code>Ctrl + D</code> - выходим из sudo</p>
<p>Установите <code>date.timezone</code> в /etc/php.ini в соответствие с временной зоной сервера.
Раскомментируйте и отредактируйте строку <code>;date.timezone =</code> (например, <code>date.timezone = Europe/Moscow</code>)<br />
$&nbsp;<code>sudo vi /etc/php.ini</code></p>
<p>Подготовим директорию для установки PHPDaemon.<br />
$&nbsp;<code>sudo mkdir /opt/phpdaemon</code><br />
$&nbsp;<code>sudo chown [your user]:[your group] /opt/phpdaemon</code><br />
$&nbsp;<code>cd /opt/phpdaemon</code></p>
<p>Устанавливаем PHPDaemon.<br />
$&nbsp;<code>cd /opt/phpdaemon</code><br />
$&nbsp;<code>git clone https://github.com/kakserpom/phpdaemon.git ./</code></p>
<p>Создаем конфигурационный файл из примера.<br />
$&nbsp;<code>cp /opt/phpdaemon/conf/phpd.conf.example /opt/phpdaemon/conf/phpd.conf</code></p>
<p>Сделаем ссылку на phpd для удобного управления демоном<br />
$&nbsp;<code>ln -s /opt/phpdaemon/bin/phpd /usr/bin/phpd</code></p>
<p>Пробуем запустить демон.<br />
$&nbsp;<code>sudo phpd start --verbose-tty=1</code></p>
<p>Опция <code>--verbose-tty=1</code> указывет демону выводить журнал в терминал.</p>
<p>Если вы видите что-то похожее на это:</p>
<pre><code>[PHPD] Loaded config file: '/opt/phpdaemon/conf/phpd.conf'
[PHPD] Loaded config file: 'conf/conf.d/ExampleJabberBot.conf'
[PHPD] Loaded config file: 'conf/conf.d/FastCGI.conf'
[PHPD] Loaded config file: 'conf/conf.d/FlashpolicyServer.conf'
[PHPD] Loaded config file: 'conf/conf.d/HTTPServer.conf'
[PHPD] Loaded config file: 'conf/conf.d/IdentServer.conf'
[PHPD] Loaded config file: 'conf/conf.d/SSL-sample.conf'
[PHPD] Loaded config file: 'conf/conf.d/WebSocketServer.conf'</code></pre>
<p>Поздравляем! PHPDaemon запущен!</p>
<h3 id="install/ubuntu"><div class="in anchor">Ubuntu<span class="header-path"> <i>&larr;</i> <a href="#install">Установка</a></span></div>

</h3>
<p>Для начала необходимо установить все сопутстсующие утилиты.<br />
$&nbsp;<code>sudo apt-get install gcc make libcurl4-openssl-dev libevent-dev git libevent</code></p>
<p>Устанавливаем PHP 5.5.<br />
$&nbsp;<code>sudo apt-get install php5-cli php5-dev php-pear</code></p>
<p>Далее устанавливаем pecl модули.<br />
$&nbsp;<code>sudo -i</code><br />
$&nbsp;<code>pecl install event eio</code><br />
$&nbsp;<code>echo "extension=event.so" &gt; /etc/php5/mods-available/event.ini</code><br />
$&nbsp;<code>echo "extension=eio.so" &gt; /etc/php5/mods-available/eio.ini</code></p>
<p>Создаем ссылки
$&nbsp;<code>ln -s /etc/php5/mods-available/event.ini /etc/php5/cli/conf.d/event.ini</code><br />
$&nbsp;<code>ln -s /etc/php5/mods-available/eio.ini /etc/php5/cli/conf.d/eio.ini</code></p>
<p><code>Ctrl + D</code> - выходим из sudo</p>
<p>Подготовим директорию для установки PHPDaemon.<br />
$&nbsp;<code>sudo mkdir /opt/phpdaemon</code>
$&nbsp;<code>sudo chown [your user]:[your group] /opt/phpdaemon</code><br />
$&nbsp;<code>cd /opt/phpdaemon</code></p>
<p>Устанавливаем PHPDaemon.<br />
$&nbsp;<code>cd /opt/phpdaemon</code><br />
$&nbsp;<code>git clone https://github.com/kakserpom/phpdaemon.git ./</code></p>
<p>Создаем конфигурационный файл из примера.<br />
$&nbsp;<code>cp /opt/phpdaemon/conf/phpd.conf.example /opt/phpdaemon/conf/phpd.conf</code></p>
<p>Сделаем ссылку на phpd для удобного управления демоном<br />
$&nbsp;<code>alias phpd='/opt/phpdaemon/bin/phpd'</code></p>
<p>Локальный алиас для sudo<br />
$&nbsp;<code>alias sudo='sudo '</code></p>
<p>Пробуем запустить демон.<br />
$&nbsp;<code>sudo phpd start --verbose-tty=1</code></p>
<p>Опция <code>--verbose-tty=1</code> указывет демону выводить журнал в терминал.</p>
<p>Если вы видите что-то похожее на это:</p>
<pre><code>[PHPD] Loaded config file: '/opt/phpdaemon/conf/phpd.conf'
[PHPD] Loaded config file: 'conf/conf.d/ExampleJabberBot.conf'
[PHPD] Loaded config file: 'conf/conf.d/FastCGI.conf'
[PHPD] Loaded config file: 'conf/conf.d/FlashpolicyServer.conf'
[PHPD] Loaded config file: 'conf/conf.d/HTTPServer.conf'
[PHPD] Loaded config file: 'conf/conf.d/IdentServer.conf'
[PHPD] Loaded config file: 'conf/conf.d/SSL-sample.conf'
[PHPD] Loaded config file: 'conf/conf.d/WebSocketServer.conf'</code></pre>
<p>Поздравляем! PHPDaemon запущен!</p>
<p>Добавим алиасы чтобы они были доступны после перезагрузки
$&nbsp;<code>echo "alias phpd='/opt/phpdaemon/bin/phpd'" &gt;&gt; ~/.bashrc'</code>
$&nbsp;<code>echo "alias sudo='sudo /opt/phpdaemon/bin/phpd'" &gt;&gt; ~/.bashrc'</code></p>
<h3 id="install/gentoo"><div class="in anchor">Gentoo<span class="header-path"> <i>&larr;</i> <a href="#install">Установка</a></span></div>

</h3>
<p>Вы можете установить PHPDaemon с помощью <a href="https://github.com/lexa-uw/layman-phpdaemon">layman overlay</a>.</p>
<p>Добавьте ссылку в секцию overlays в файле layman.cfg:<br />
<code>https://github.com/lexa-uw/layman-phpdaemon/blob/master/layman.xml</code></p>
<p>В итоге будет выглядеть примерно так:</p>
<pre><code>overlays  : http://www.gentoo.org/proj/en/overlays/repositories.xml
            https://github.com/lexa-uw/layman-phpdaemon/blob/master/layman.xml</code></pre>
<p>Выполняем команды<br />
$&nbsp;<code>sudo layman -L</code><br />
$&nbsp;<code>sudo layman -a phpdaemon</code><br />
$&nbsp;<code>sudo emerge www-servers/phpdaemon</code></p>
<p>К примеру, нижеследующие команды устанавливают phpdaemon версии 0.4.1, 1.0_beta2 и еженедельный релиз.</p>
<pre><code>$ sudo emerge "=www-servers/phpdaemon-0.4.1" "=www-servers/phpdaemon-1.0_beta2" "www-servers/phpdaemon"
Это пакеты, которые будут объединены по порядку:

Расчёт зависимостей... готово!
[ebuild   R   ~] www-servers/phpdaemon-0.4.1:0.4::phpdaemon  USE="libevent -examples -runkit" 0 kB
[ebuild   R   ~] www-servers/phpdaemon-1.0_beta2:1.0::phpdaemon  USE="eio event -runkit" 0 kB
[ebuild   R   ~] www-servers/phpdaemon-20130907:weekly::phpdaemon  USE="eio event -runkit" 0 kB
...</code></pre>
<p>После установки вы можете использовать "eselect phpdaemon set"  для создания символической ссылки на /usr/bin/phpd</p>
<pre><code>$ sudo eselect phpdaemon list
Available phpdaemon targets:
  [1]   phpd0.4
  [2]   phpd1.0
  [3]   phpdweekly
$ sudo eselect phpdaemon set 3
$ sudo eselect phpdaemon show
Current phpdaemon:
  weekly</code></pre>
<p>Добавить phpdaemon в автозагрузку:</p>
<pre><code>$ rc-update add phpd default
 * service phpd added to runlevel default</code></pre>
<p>Добавить отдельные init.d скрипты для разных версий:</p>
<pre><code>$ ln -s /etc/init.d/phpd /etc/init.d/phpd-0.4
$ ln -s /etc/init.d/phpd /etc/init.d/phpd-1.0
$ ln -s /etc/init.d/phpd /etc/init.d/phpd-weekly</code></pre>
<p>Добавить phpd-1.0 в автозагрузку:</p>
<pre><code>$ rc-update add phpd-1.0 default
 * service phpd added to runlevel default</code></pre>
<h2 id="basics"><div class="in anchor">Основы</div>

</h2>
<p>PHPDaemon представляет из&#160;себя один мастер-процесс с&#160;несколькими рабочими процессами.</p>
<p>Приложение, в&#160;зависимости от&#160;нагрузки, инициализируется в&#160;одном или нескольких рабочих процессах.
Во&#160;втором случае запрос будет передан одному свободному рабочему процессу.</p>
<p>Механизма взаимодействия между ребочими процессами не&#160;предусмотрено, поэтому для синхронизации приложений в&#160;разных процессах вы&#160;можете использовать стороннее&#160;ПО, например Redis.
Также есть возможность задать опцию приложения <code>limit-instances N;</code>, чтобы ограничить кол-во копий приложения во&#160;всех рабочих процессах.</p>
<p>Исполняющий файл находится в дирктории <code>./bin/phpd</code>.
Вы можете создать свой исполняющий файл, как показано в примере <code>./bin/sampleapp</code>.
Перед запуском демон проверяет переменную <code>$configFile</code>, используя её для загрузки конфигурации.</p>
<h3 id="basics/pseudotypes"><div class="in anchor">Псевдотипы<span class="header-path"> <i>&larr;</i> <a href="#basics">Основы</a></span></div>

</h3>
<h4 id="basics/pseudotypes/url"><div class="in anchor">url<span class="header-path"> <i>&larr;</i> <a href="#basics/pseudotypes">Псевдотипы</a> <i>&larr;</i> <a href="#basics">Основы</a></span></div>

</h4>
<p>Псевдотип url @TODO</p>
<h2 id="control"><div class="in anchor">Управление</div>

</h2>
<table class="invis">
  <tr>
    <td class="nowrap">$ <code>phpd start</code></td>
    <td>Запуск демона</td>
  </tr>
  <tr>
    <td class="nowrap">$ <code>phpd stop</code></td>
    <td>Остановка демона<br><code>SYSCTL: SIGTERM, SIGQUIT</code></td>
  </tr>
  <tr>
    <td class="nowrap">$ <code>phpd hardstop</code></td>
    <td>Принудительная остановка демона<br><code>SYSCTL: SIGINT, SIGKILL</code></td>
  </tr>
  <tr>
    <td class="nowrap">$ <code>phpd update</code></td>
    <td>Обновление конфигурации<br><code>SYSCTL: SIGHUP</code></td>
  </tr>
  <tr>
    <td class="nowrap">$ <code>phpd reload</code></td>
    <td>Плавный перезапуск всех рабочих процессов<br><code>SYSCTL: SIGUSR2</code></td>
  </tr>
  <tr>
    <td class="nowrap">$ <code>phpd reopenlog</code></td>
    <td>Переоткрытие журналов<br><code>SYSCTL: SIGUSR1</code></td>
  </tr>
  <tr>
    <td class="nowrap">$ <code>phpd restart</code></td>
    <td>Плавный перезапуск демона</td>
  </tr>
  <tr>
    <td class="nowrap">$ <code>phpd hardrestart</code></td>
    <td>Принудительный перезапуск демона</td>
  </tr>
  <tr>
    <td class="nowrap">$ <code>phpd status</code></td>
    <td>Вывод статуса демона</td>
  </tr>
  <tr>
    <td class="nowrap">$ <code>phpd fullstatus</code></td>
    <td>Вывод подробной информации работы демона</td>
  </tr>
  <tr>
    <td class="nowrap">$ <code>phpd configtest</code></td>
    <td>Вывод глобальных опций. В скобках будет указано значение по-умочанию.</td>
  </tr>
  <tr>
    <td class="nowrap">$ <code>phpd log [-n K]</code></td>
    <td>Вывод журнала в реальном времени с помощью команды <code>tail -f</code>. C параметром <code>-n K</code> выводится K последних строк. Или используйте <code>-n +K</code> для вывода строк, начиная с K.</td>
  </tr>
  <tr>
    <td class="nowrap">$ <code>phpd runworker</code></td>
    <td>Запуск рабочего процесса без мастер-процесса. Используется для отладки.</td>
  </tr>
</table>
<h2 id="examples"><div class="in anchor">Примеры</div>

</h2>
<p>Примеры</p>
<h2 id="app_resolver"><div class="in anchor">Маршрутизация</div>

</h2>
<p>Получая запросы демон первым делом должен определить какому приложению он&#160;должен передать обработку.
Для этого служит метод <code>getRequestRoute</code> в&#160;классе <code>AppResolver</code> [<a href="https://github.com/kakserpom/phpdaemon/blob/master/PHPDaemon/Core/AppResolver.php#L159">GitHub</a>].</p>
<p>Вы&#160;можете определить свой обработчик, пример которого лежит в <code>./conf/AppResolver.php</code> [<a href="https://github.com/kakserpom/phpdaemon/blob/master/conf/AppResolver.php">GitHub</a>].</p>
<p>Метод <code>getRequestRoute</code> принимает два параметра:</p>
<ul>
<li><code>$req</code> &#8212; объект <code>stdClass</code>, с&#160;параметрами запроса;</li>
<li><code>$upstream</code> &#8212; объект сервера, принимающий входящие запросы, например <code>PHPDaemon\Servers\HTTP\Connection</code>.</li>
</ul>
<p>Результатом работы может быть:</p>
<ul>
<li>Имя приложения;</li>
<li><code>null</code> для попытки передать запрос приложению по-умолчанию;</li>
<li><code>false</code> для завершения обработки запроса.</li>
</ul>
<p>Не&#160;забудьте указать&#160;в <a href="#osnovnyie-puti">конфиге</a> путь до&#160;вашего AppResolver, например <code>path './conf/AppResolver.php';</code>.</p>
<p>В&#160;настройках <a href="#serveryi">сервера</a>, принимающего запросы, с&#160;помощью опции <code>responder</code> можно указать имя приложения по-умолчанию, которому будет передан запрос, если <code>getRequestRoute</code> вернул <code>null</code>.</p>
<h2 id="config"><div class="in anchor">Конфигурация</div>

</h2>
<h3 id="config/types"><div class="in anchor">Типы данных<span class="header-path"> <i>&larr;</i> <a href="#config">Конфигурация</a></span></div>

</h3>
<p>Большинство опций phpdaemon описывается своими типами данных, позволяющие указывать значения расширенным форматом.</p>
<h4 id="config/types/size"><div class="in anchor">Size<span class="header-path"> <i>&larr;</i> <a href="#config/types">Типы данных</a> <i>&larr;</i> <a href="#config">Конфигурация</a></span></div>

</h4>
<p>Предназначен для записи объема информации. Можно записать в виде целого числа или целого числа с постфиксом.</p>
<p>Формат записи: <code>integer [bBkKmMgG]?</code></p>
<p>|| <strong>Постфикс</strong> || <strong>Множитель</strong> || <strong>Пример</strong> || <strong>Значение</strong> ||
|| b, B || 1 || 1b || 1 ||
|| k || 1000 || 1k || 1000 ||
|| K || 1024 || 1K || 1024 ||
|| m || 1000 <em> 1000 || 1m || 1000000 ||
|| M || 1024 </em> 1024 || 1M || 1048576 ||
|| g || 1000 <em> 1000 </em> 1000 || 1g || 1000000000 ||
|| G || 1024 <em> 1024 </em> 1024 || 1G || 1073741824 ||</p>
<!--
Примеры:
|| **Пример** || **Значение** ||
|| 1 || 1 ||
|| 1b || 1 ||
|| 1m || 1000000 ||
|| 1M || 1048576 ||
-->
<h4 id="config/types/time"><div class="in anchor">Time<span class="header-path"> <i>&larr;</i> <a href="#config/types">Типы данных</a> <i>&larr;</i> <a href="#config">Конфигурация</a></span></div>

</h4>
<p>Предназначен для записи количества секунд. Число может быть с плавающей точкой с использованием только символа <code>"."</code>.</p>
<p>Формат записи: <code>float [smhd]?</code> или <code>(float [smhd])+</code></p>
<p>|| <strong>Постфикс</strong> || <strong>Множитель</strong> || <strong>Пример</strong> || <strong>Значение</strong> ||
|| s || 1 || 1s || 1 ||
|| m || 60 || 1m || 60 ||
|| h || 60 <em> 60 || 2h 12s || 7212 ||
|| d || 60 </em> 60 * 24 || 1d 15m 32s || 87332 ||</p>
<!--
Примеры:
|| **Пример** || **Значение** ||
|| 1 || 1 ||
|| 1s || 1 ||
|| 1d || 86400 ||
|| 1d 15m 32s || 87332 ||
-->
<h4 id="config/types/number"><div class="in anchor">Number<span class="header-path"> <i>&larr;</i> <a href="#config/types">Типы данных</a> <i>&larr;</i> <a href="#config">Конфигурация</a></span></div>

</h4>
<p>Предназначен для записи чисел.</p>
<p>Формат записи: <code>integer [kKmMgG]?</code></p>
<p>|| <strong>Постфикс</strong> || <strong>Множитель</strong> || <strong>Пример</strong> || <strong>Значение</strong> ||
|| k, K || 1000 || 1k || 1000 ||
|| m, M || 1000 <em> 1000 || 1M || 1000000 ||
|| g, G || 1000 </em> 1000 * 1000 || 1g || 1000000000 ||</p>
<!--
Примеры:
|| **Пример** || **Значение** ||
|| 1 || 1 ||
|| 1K || 1000 ||
-->
<h3 id="config/variables"><div class="in anchor">Глобальные опции<span class="header-path"> <i>&larr;</i> <a href="#config">Конфигурация</a></span></div>

</h3>
<p>Два способа установки опций:</p>
<ol>
<li>Конфигурационный файл <code>./conf/phpd.conf</code>;</li>
<li>Параметры командной строки, например <code>--max-workers=1</code>.</li>
</ol>
<blockquote>
<p>Параметры командной строки имеют больший приоритет.</p>
</blockquote>
<h4 id="config/variables/file"><div class="in anchor">Конфигурационный файл<span class="header-path"> <i>&larr;</i> <a href="#config/variables">Глобальные опции</a> <i>&larr;</i> <a href="#config">Конфигурация</a></span></div>

</h4>
<p>Формат записи опций следующий:<br />
<code>название-опции;</code> или <code>название-опции значение;</code></p>
<p><code>название-опции</code> не чувствительно к регистру и использованию знака дефиса&nbsp;<code>"-"</code>.
Следующие варианты написания равнозначны:</p>
<ul>
<li><code>add-include-path</code>;</li>
<li><code>addincludepath</code>;</li>
<li><code>addIncludePath</code>;</li>
<li><code>ADDInclude-path</code>.</li>
</ul>
<p>Значение может отсутствовать, что приравнивется к <code>bool(true)</code>, либо может быть записано следующими способами:</p>
<ul>
<li><code>null</code>;</li>
<li>булевым выражением <code>false</code> или <code>true</code>;</li>
<li>целым числом;</li>
<li>числом с плавающей точкой;</li>
<li>строкой; если в строке присутствует символ пробела&nbsp;<code>" "</code> или запятая&nbsp;<code>","</code>, то строку необходимо обернуть одинарными или двойными кавычками;</li>
<li>массивом.</li>
</ul>
<p>Для записи массива используется разделитель пробел&nbsp;<code>" "</code> или запятая&nbsp;<code>","</code>. В одном значении можно использовать оба разделителя одновременно.</p>
<p>|| <strong>Пример опции</strong> || <strong>Вывод var_dump</strong> ||
|| var-name; || bool(true) ||
|| var-name null; || NULL ||
|| var-name true; || bool(true) ||
|| var-name false; || bool(false) ||
|| var-name 0; || int(0) ||
|| var-name 1; || int(1) ||
|| var-name 3.14; || float(3.14) ||
|| var-name "3.14"; || string(4) "3.14" ||
|| var-name "пример. длинной строки,второй пример"; || string(67) "пример. длинной строки,второй пример" ||
|| var-name пример. длинной строки,второй пример; || array(5) {<br>&nbsp;&nbsp;&nbsp;&nbsp;[0]=><br>&nbsp;&nbsp;&nbsp;&nbsp;string(13) "пример."<br>&nbsp;&nbsp;&nbsp;&nbsp;[1]=><br>&nbsp;&nbsp;&nbsp;&nbsp;string(14) "длинной"<br>&nbsp;&nbsp;&nbsp;&nbsp;[2]=><br>&nbsp;&nbsp;&nbsp;&nbsp;string(12) "строки"<br>&nbsp;&nbsp;&nbsp;&nbsp;[3]=><br>&nbsp;&nbsp;&nbsp;&nbsp;string(12) "второй"<br>&nbsp;&nbsp;&nbsp;&nbsp;[4]=><br>&nbsp;&nbsp;&nbsp;&nbsp;string(12) "пример"<br>} ||
|| var-name 1, 'a' null 3.14 'пару слов'; || array(5) {<br>&nbsp;&nbsp;&nbsp;&nbsp;[0]=><br>&nbsp;&nbsp;&nbsp;&nbsp;int(1)<br>&nbsp;&nbsp;&nbsp;&nbsp;[1]=><br>&nbsp;&nbsp;&nbsp;&nbsp;string(1) "a"<br>&nbsp;&nbsp;&nbsp;&nbsp;[2]=><br>&nbsp;&nbsp;&nbsp;&nbsp;NULL<br>&nbsp;&nbsp;&nbsp;&nbsp;[3]=><br>&nbsp;&nbsp;&nbsp;&nbsp;float(3.14)<br>&nbsp;&nbsp;&nbsp;&nbsp;[4]=><br>&nbsp;&nbsp;&nbsp;&nbsp;string(17) "пару слов"<br>} ||</p>
<p>Ниже будут перечислены глобальные опции демона в формате:<br />
<code>название-опции (тип-данных = значение-по-умолчанию);</code></p>
<h4 id="config/variables/graceful_restart"><div class="in anchor">Плавный перезапуск рабочих процессов<span class="header-path"> <i>&larr;</i> <a href="#config/variables">Глобальные опции</a> <i>&larr;</i> <a href="#config">Конфигурация</a></span></div>

</h4>
<ul>
<li>
<p><code>:p</code>max-requests (<a href="#config/types/number">Number</a> = '10k')`<br />
Максимальное количество запросов перед перезапуском рабочего процесса.
<code>0</code> – неограничено.</p>
</li>
<li>
<p><code>:p</code>max-memory-usage (<a href="#config/types/size">Size</a> = '0b')`<br />
Максимальный допустимый порог потребления памяти рабочим процессом.
<code>0</code> – неограничено.</p>
</li>
<li>
<p><code>:p</code>max-idle (<a href="#config/types/time">Time</a> = '0s')`<br />
Максимальное время простоя рабочего процесса перед перезапуском.
<code>0</code> – неограничено.</p>
</li>
<li>
<p><code>:p</code>auto-reload (<a href="#config/types/time">Time</a> = '0s')`<br />
Задает интервал проверки всех подключенных файлов. При изменении файлов плавно перезагружает рабочие процессы.</p>
</li>
<li><code>auto-reimport (boolean = false)</code><br />
На лету импортирует методы и функции из измененных файлов с помощью runkit, без перезагрузки рабочего процесса.</li>
</ul>
<h4 id="config/variables/pathes"><div class="in anchor">Основные пути<span class="header-path"> <i>&larr;</i> <a href="#config/variables">Глобальные опции</a> <i>&larr;</i> <a href="#config">Конфигурация</a></span></div>

</h4>
<ul>
<li>
<p><code>pid-file (string = '/var/run/phpd.pid')</code><br />
Путь к pid-файлу. Убедитесь что имеется доступ на запись.</p>
</li>
<li>
<p><code>config-file (string = '/etc/phpdaemon/phpd.conf;/etc/phpd/phpd.conf;./conf/phpd.conf')</code><br />
Путь к файлу конфигурации. Можно указать несколько через разделитель <code>";"</code>.<br />
Будет загружен только первый найденный конфигурационный файл.</p>
</li>
<li>
<p><code>path (string = '/etc/phpdaemon/AppResolver.php;./conf/AppResolver.php')</code><br />
Путь к Application Resolver. Можно указать несколько через разделитель <code>";"</code>.<br />
Будет загружен только первый найденный файл.</p>
</li>
<li><code>add-include-path (string = null)</code><br />
Дополнительные пути для директивы <a href="http://www.php.net/manual/ru/ini.core.php#ini.include-path">include_path</a>.<br />
Можно указать несколько через разделитель <code>":"</code>.</li>
</ul>
<h4 id="config/variables/master"><div class="in anchor">Связанные с мастер-процессом<span class="header-path"> <i>&larr;</i> <a href="#config/variables">Глобальные опции</a> <i>&larr;</i> <a href="#config">Конфигурация</a></span></div>

</h4>
<ul>
<li>
<p><code>:p</code>mpm-delay (<a href="#config/types/time">Time</a> = '0.1s')`<br />
Интервал между срабатываниями Мульти-Процессного Менеджера.<br />
МПМ отвечает за запуск/выключение рабочих процессов, согласно настройкам.</p>
</li>
<li>
<p><code>:p</code>start-workers (<a href="#config/types/number">Number</a> = 4)`<br />
Кол-во рабочих процессов при запуске демона.</p>
</li>
<li>
<p><code>:p</code>min-workers (<a href="#config/types/number">Number</a> = 4)`<br />
Минимальное допустимое кол-во рабочих процессов.</p>
</li>
<li>
<p><code>:p</code>max-workers (<a href="#config/types/number">Number</a> = 8)`<br />
Максимальное допустимое кол-во рабочих процессов.</p>
</li>
<li>
<p><code>:p</code>min-spare-workers (<a href="#config/types/number">Number</a> = 2)`<br />
Минимальное количество простаивающих рабочих процессов: phpDaemon запустит дополнительный рабочие процессы когда нагрузка увеличится, чтобы простаивающих рабочих процессов было достаточно. Сверху ограничивается параметром max-workers.</p>
</li>
<li>
<p><code>:p</code>max-spare-workers (<a href="#config/types/number">Number</a> = 0)`<br />
Максимальное кол-во простаивающих рабочих процессов. phpDaemon выключит дополнительные рабочие процессы когда нагрузка спадёт.</p>
</li>
<li>
<p><code>:p</code>master-priorty (<a href="#config/types/number">Number</a> = 100)`<br />
Приоритет мастер-процесса. Чем меньше значение, тем выше приоритет.</p>
</li>
<li>
<p><code>:p</code>ipc-thread-priority (<a href="#config/types/number">Number</a> = 100)`<br />
Приоритет IPC процесса. Чем меньше значение, тем выше приоритет.</p>
</li>
<li>
<p><code>:p</code>worker-priority (<a href="#config/types/number">Number</a> = 4)`<br />
Приоритет рабочего процесса. Чем меньше значение, тем выше приоритет.</p>
</li>
<li><code>throw-exception-on-shutdown (boolean = false)</code><br />
Выбрасывать исключение <code>Exception('event shutdown')</code> по завершению процесса.</li>
</ul>
<h4 id="config/variables/requests"><div class="in anchor">Запросы<span class="header-path"> <i>&larr;</i> <a href="#config/variables">Глобальные опции</a> <i>&larr;</i> <a href="#config">Конфигурация</a></span></div>

</h4>
<ul>
<li>
<p><code>locale (string = '')</code><br />
Устанавливает настройки локали. Можно указать несколько через разделитель <code>","</code>.</p>
</li>
<li><code>ob-filter-auto (boolean = true)</code><br />
Включить стандартный <code>ob_</code> фильтр.</li>
</ul>
<h4 id="config/variables/workers"><div class="in anchor">Рабочие процессы<span class="header-path"> <i>&larr;</i> <a href="#config/variables">Глобальные опции</a> <i>&larr;</i> <a href="#config">Конфигурация</a></span></div>

</h4>
<ul>
<li>
<p><code>chroot (string = '/')</code><br />
Смена системного корня для рабочих процессов.</p>
</li>
<li>
<p><code>cwd (string = '.')</code><br />
Задание рабочей директории для рабочих процессов.</p>
</li>
<li>
<p><code>user (string = null)</code><br />
Пользователь для рабочих процессов. Используйте безопасного пользователя, не используйте root, если не знаете что делаете.</p>
</li>
<li>
<p><code>group (string = null)</code><br />
Группа для рабочих процессов. Используйте безопасную группу, не используйте root, если не знаете что делаете.</p>
</li>
<li><code>:p</code>auto-gc (<a href="#config/types/number">Number</a> = '1k')`<br />
Включает сборщик мусора вызываемый каждые n запросов. <code>0</code> – выключает совсем.</li>
</ul>
<h4 id="config/variables/logging"><div class="in anchor">Журналирование и отладка<span class="header-path"> <i>&larr;</i> <a href="#config/variables">Глобальные опции</a> <i>&larr;</i> <a href="#config">Конфигурация</a></span></div>

</h4>
<ul>
<li>
<p><code>logging (boolean = true)</code><br />
Включает журналирование.</p>
</li>
<li>
<p><code>log-storage (string = '/var/log/phpdaemon.log')</code><br />
Путь к файлу журнала.</p>
</li>
<li>
<p><code>log-errors (boolean = true)</code><br />
Включает журналирование локальных ошибок таких как Undefined route in WebSocketServer, и т.д.</p>
</li>
<li>
<p><code>log-worker-set-state (boolean = false)</code><br />
Включает журналирование смены состояния рабочего процесса.</p>
</li>
<li>
<p><code>log-events (boolean = false)</code><br />
Включает журналирование сетевых событий.</p>
</li>
<li>
<p><code>log-signals (boolean = false)</code><br />
Включает журналирование системных сигналов.</p>
</li>
<li>
<p><code>verbose-tty (boolean = false)</code><br />
Если параметр включен, журнал будет выводиться в терминал (STDOUT).</p>
<blockquote>
<p>Учтите, что в обычном варианте запуска (не runworker) ввод из терминала игнорируется, хотя после запуска с этим параметром может показаться, что программа привязана к терминалу.</p>
</blockquote>
</li>
<li><code>restrict-error-control (boolean = false)</code><br />
Выключает оператор управления ошибками <code>"@"</code>.</li>
</ul>
<h4 id="config/variables/eio"><div class="in anchor">Подсистема ввода-вывода POSIX<span class="header-path"> <i>&larr;</i> <a href="#config/variables">Глобальные опции</a> <i>&larr;</i> <a href="#config">Конфигурация</a></span></div>

</h4>
<ul>
<li>
<p><code>eio-enabled (boolean = true)</code><br />
Включает поддержку EIO.</p>
</li>
<li>
<p><code>:p</code>eio-set-max-idle (<a href="#config/types/time">Time</a> = null)`<br />
Устанавливает максимальное количество ожидающих потоков.</p>
</li>
<li>
<p><code>:p</code>eio-set-min-parallel (<a href="#config/types/number">Number</a> = null)`<br />
Устанавливает минимальное количество параллельных потоков.</p>
</li>
<li>
<p><code>:p</code>eio-set-max-parallel (<a href="#config/types/number">Number</a> = null)`<br />
Устанавливает максимальное количество параллельных потоков.</p>
</li>
<li>
<p><code>:p</code>eio-set-max-poll-reqs (<a href="#config/types/number">Number</a> = null)`<br />
Устанавливает максимальное количество обрабатываемых запросов.</p>
</li>
<li><code>:p</code>eio-set-max-poll-time (<a href="#config/types/time">Time</a> = null)`<br />
Устанавливает максимальное время выполнения.</li>
</ul>
<h3 id="config/application"><div class="in anchor">Приложения<span class="header-path"> <i>&larr;</i> <a href="#config">Конфигурация</a></span></div>

</h3>
<ul>
<li>
<p><code>enable (boolean = true)</code>
Разрешает демону инициализацию приложения. По-умочанию, описанное в конфигурационном файле приложение, всегда включено.</p>
</li>
<li><code>limit-instances (integer = null)</code>
Ограничивает кол-во инициализированных приложений во всех рабочих процессах. По-умолчанию ограничения нет.</li>
</ul>
<h2 id="development"><div class="in anchor">Разработка</div>

</h2>
<h3 id="development/pseudotypes"><div class="in anchor">Псевдотипы<span class="header-path"> <i>&larr;</i> <a href="#development">Разработка</a></span></div>

</h3>
<h4 id="development/pseudotypes/url"><div class="in anchor">url<span class="header-path"> <i>&larr;</i> <a href="#development/pseudotypes">Псевдотипы</a> <i>&larr;</i> <a href="#development">Разработка</a></span></div>

</h4>
<p>Псевдотип url @TODO</p>
<h3 id="development/app_instance"><div class="in anchor">Приложение<span class="header-path"> <i>&larr;</i> <a href="#development">Разработка</a></span></div>

</h3>
<p>Приложением в phpDaemon является наследник класса AppInstance, для того чтобы создать новое приложение, необходимо создать файл applications/[имя].php и объявить в нем class Example extends AppInstance. Затем, ядро будет вызывать методы в ответ на которые приложение должно выполнять необходимые операции:</p>
<ul>
<li>init() - инициализации приложения. Приложению необходимо сохранить необходимые зависимости и подготовиться к запуску.</li>
<li>onReady() - означает что рабочий процесс, в котором запущено приложение, готов к обработке.</li>
<li>onShutdown() - завершение приложения.</li>
<li>beginRequest(Request $req, AppInstance $upstream) - запрашивается объект нового запроса к приложению. Метод может вернуть false, это значит что приложение отказывается (или не умеет) обрабатывать запросы. После вызова этого метода, объект запроса попадает в очередь и вызывается итеративно.</li>
</ul>
<p>Класс декларируется как class ExampleRequest extends Request.
Методы:</p>
<ul>
<li>init() - вызывается единожды при создании объекта запроса.</li>
<li>run() - вызывается диспетчером очереди до тер пор, пока не будет возращен код 1 или не будет вызван метод terminate().</li>
<li>terminate() - его не следует перезагружать. Метод прерывает и завершает выполнение запроса.</li>
<li>sleep($seconds) - время в секундах, через которое необходимо вернуться к запросу.</li>
<li>wakeup() - прервать sleep.</li>
<li>onAbort() - событие сброса запроса, вызывается в случае если клиент отвалился.</li>
<li>header($header) - установить заголовок HTTP-ответа.</li>
<li>out($str) - записать строку в поток вывода.</li>
<li>combinedOut($str) - записать строку в поток вывода, содержащую и заголовки и тело.</li>
<li>stdin($str) - обработчик потока ввода запроса.</li>
<li>finish($status) - 0 - normal, -1 - abort, -2 - termination</li>
<li>chunked() - устанавливает Transfer-Encoding: chunked.</li>
</ul>
<h3 id="development/request"><div class="in anchor">Обработка запросов<span class="header-path"> <i>&larr;</i> <a href="#development">Разработка</a></span></div>

</h3>
<h3 id="development/servers_clients"><div class="in anchor">Серверы и клиенты<span class="header-path"> <i>&larr;</i> <a href="#development">Разработка</a></span></div>

</h3>
<h3 id="development/debugging"><div class="in anchor">Отладка<span class="header-path"> <i>&larr;</i> <a href="#development">Разработка</a></span></div>

</h3>
<h2 id="servers"><div class="in anchor">Серверы</div>

</h2>
<p>Серверы предназначены для приема запросов и передачи их приложениям.</p>
<p>Каждый сервер представляет собой класс наследуемый от <a target="_self" class="tpl-inlink" href="#network/server">Сеть\Сервер<i class="fa fa-caret-square-o-up"></i></a>, который в свой очередь наследуется от <a target="_self" class="tpl-inlink" href="#network/pool">Сеть\Пул<i class="fa fa-caret-square-o-up"></i></a>. 
Сервер можно инициировать прямо в пользовательском приложении,  например:</p>
<pre><code class="language-php">/* ... */
$this-&gt;pool = \PHPDaemon\Servers\FlashPolicy::getInstance([
    'listen' =&gt; 'tcp://0.0.0.0:843'
]);
$this-&gt;pool-&gt;onReady();
/* ... */</code></pre>
<p>Но не забывайте, что в таком случае следует отправлять ему onReady(), onShutdown() и onConfigUpdated() события.</p>
<p>В большинстве случаев сервер запускается одноименнным приложением Pool.</p>
<pre><code class="language-ruby"># контекст для ssl соединения (опционально)
TransportContext:myContext {
    ssl;
    certFile "/path/to/cert.pem";
    pkFile "/path/to/privkey.pem";
    passphrase "";
    verifyPeer true;
    allowSelfSigned true;
}

# слушаем 80 и 443 порт
Pool:HTTPServer {
    listen "tcp://0.0.0.0:80", "tcp://0.0.0.0:443##myContext";
    port 80;
    privileged;
    maxconcurrency 1;
}</code></pre>
<h3 id="servers/options"><div class="in anchor">Опции серверов<span class="header-path"> <i>&larr;</i> <a href="#servers">Серверы</a></span></div>

</h3>
<p>В данном разделе перечислены опции, используемые всеми серверами.</p>
<ul>
<li>
<p><code>listen (string|array)</code><br />
Прослушиваемые сервером адреса. Можно указать несколько через разделитель&nbsp;<code>","</code>.</p>
</li>
<li>
<p><code>privileged</code><br />
@TODO</p>
</li>
<li>
<p><code>max-concurrency</code><br />
Максимальное количество открытых соединений.</p>
</li>
<li>
<p><code>max-allowed-packet</code><br />
Максимальный допустимый размер пакета.</p>
</li>
<li>
<p><code>connection-class</code><br />
Класс соединения по-умолчанию.</p>
</li>
<li>
<p><code>name</code><br />
@TODO</p>
</li>
<li>
<p><code>allowed-clients</code><br />
Разрешенные IP-адреса или маски через запятую.</p>
</li>
<li>
<p><code>ssl</code><br />
Включает ssl.</p>
</li>
<li>
<p><code>ssl-port</code><br />
@TODO</p>
</li>
<li>
<p><code>cert-file</code><br />
@TODO</p>
</li>
<li>
<p><code>pk-file</code><br />
@TODO</p>
</li>
<li>
<p><code>passphrase</code><br />
@TODO</p>
</li>
<li>
<p><code>verify-peer</code><br />
@TODO</p>
</li>
<li>
<p><code>allow-self-signed</code><br />
@TODO</p>
</li>
<li>
<p><code>verify-depth</code><br />
@TODO</p>
</li>
<li><code>ca-file</code><br />
@TODO</li>
</ul>
<h3 id="servers/http"><div class="in anchor">HTTP <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Servers/HTTP"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#servers">Серверы</a></span></div>

</h3>
<p>Сервер использует пространство имен <a target="_self" class="tpl-inlink" href="#httprequest">HTTPRequest<i class="fa fa-caret-square-o-up"></i></a>.</p>
<p>Это транспортное приложение предоставляет HTTP сервер для phpDaemon. Входящие Websocket соединения будут переданы приложению WebsocketServer.</p>
<p>HTTP пробует определить приложение через AppResolver, не забудьте сконфигурировать его.</p>
<h4 id="servers/http/options"><div class="in anchor">Опции<span class="header-path"> <i>&larr;</i> <a href="#servers/http">HTTP <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Servers/HTTP"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#servers">Серверы</a></span></div>

</h4>
<ul>
<li>
<p><code>listen (string = 'tcp://0.0.0.0')</code><br />
Какие адреса слушать, через запятую</p>
</li>
<li>
<p><code>port (integer = 80)</code><br />
Прослушиваемый порт</p>
</li>
<li>
<p><code>allowed-clients (string = '127.0.0.1')</code><br />
IP адреса (через запятую) которым позволено делать запросы. CIDR-маски поддерживаются</p>
</li>
<li>
<p><code>send-file (boolean = false)</code><br />
Оптимизирует обработку запросов, предварительно записывая их в файл.
Опция будет игнорироваться если передан параметр <code>server['DONT_USE_SENDFILE']</code></p>
</li>
<li>
<p><code>send-file-dir (string = '/dev/shm')</code><br />
Директория для sendfile</p>
</li>
<li>
<p><code>send-file-prefix (string = 'http-')</code><br />
Префикс для sendfile файлов</p>
</li>
<li>
<p><code>send-file-onlybycommand (boolean = false)</code><br />
Включать sendfile если передан <code>server['USE_SENDFILE']</code></p>
</li>
<li>
<p><code>expose (boolean = true)</code><br />
Включать версию PHPDaemon в заголовке <code>X-Powered-By</code></p>
</li>
<li>
<p><code>:p</code>keepalive (<a href="#config/types/time">Time</a> = '0s')`<br />
Таймаут бездействия перед закрытием keep-alive соединения</p>
</li>
<li>
<p><code>:p</code>chunksize (<a href="#config/types/size">Size</a> = '8k')`<br />
Размер куска</p>
</li>
<li>
<p><code>defaultcharset (string = 'utf-8')</code><br />
Кодировка по-умолчанию</p>
</li>
<li>
<p><code>wss-name (string = '')</code><br />
Имя пула WebSocket-сервера, куда направлять WebSocket-соединения</p>
</li>
<li>
<p><code>fps-name (string = '')</code><br />
Имя пула FlashPolicy-сервера, куда адресовать FlashPolicy-соединения</p>
</li>
<li>
<p><code>:p</code>upload-max-size (<a href="#config/types/size">Size</a> = ini_get('upload_max_filesize'))`<br />
Максимальный размер загружаемого файла</p>
</li>
<li><code>responder (string = null)</code><br />
Имя приложения по-умолчанию для обработки запросов с данного сервера</li>
</ul>
<h3 id="servers/fastcgi"><div class="in anchor">FastCGI <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Servers/FastCGI"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#servers">Серверы</a></span></div>

</h3>
<p>Сервер использует пространство имен <a target="_self" class="tpl-inlink" href="#httprequest">HTTPRequest<i class="fa fa-caret-square-o-up"></i></a>.</p>
<p>Это транспортное приложение представляет FastCGI сервер для phpDaemon.</p>
<p>После конфигурирования phpDaemon вам также следует задействовать веб-сервер, который поддерживает FastCGI. Если вы еще не сделали выбор в пользу одного из них, мы советуем <a target="_blank" class="tpl-outlink" href="http://nginx.org">NGINX<i class="fa fa-external-link"></i></a>.</p>
<p>Веб-сервер может передавать FastCGI-серверу параметр APPNAME, который содержит название приложения которое должно обработать данный запрос. Если параметр не передан, FastCGI-сервер попробует определить это через AppResolver.</p>
<p>Пример конфигурации NGINX:</p>
<pre><code class="language-nginx">location /Example/ {
    fastcgi_pass unix:/tmp/phpdaemon.fcgi.sock;
    fastcgi_param APPNAME Example;
    include fastcgi_params;
}</code></pre>
<h4 id="servers/fastcgi/options"><div class="in anchor">Опции<span class="header-path"> <i>&larr;</i> <a href="#servers/fastcgi">FastCGI <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Servers/FastCGI"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#servers">Серверы</a></span></div>

</h4>
<ul>
<li>
<p><code>listen (string = 'tcp://127.0.0.1,unix:///tmp/phpdaemon.fcgi.sock')</code><br />
Какие адреса слушать, через запятую</p>
</li>
<li>
<p><code>port (integer = 80)</code><br />
Прослушиваемый порт</p>
</li>
<li>
<p><code>auto-read-body-file (boolean = true)</code><br />
Автоматически реагирует на FastCGI параметр REQUEST_BODY_FILE и читает тело запроса из файла, созданного веб-сервером</p>
</li>
<li>
<p><code>allowed-clients (string = '127.0.0.1')</code><br />
IP адреса (через запятую) которым позволено делать запросы. CIDR-маски поддерживаются</p>
</li>
<li>
<p><code>send-file (boolean = false)</code><br />
Оптимизирует обработку запросов, предварительно записывая их в файл.
Опция будет игнорироваться если передан параметр <code>server['DONT_USE_SENDFILE']</code></p>
</li>
<li>
<p><code>send-file-dir (string = '/dev/shm')</code><br />
Директория для sendfile</p>
</li>
<li>
<p><code>send-file-prefix (string = 'fcgi-')</code><br />
Префикс для sendfile файлов</p>
</li>
<li>
<p><code>send-file-onlybycommand (boolean = false)</code><br />
Включать sendfile если передан <code>server['USE_SENDFILE']</code></p>
</li>
<li>
<p><code>expose (boolean = true)</code><br />
Включать версию PHPDaemon в заголовке <code>X-Powered-By</code></p>
</li>
<li>
<p><code>:p</code>keepalive (<a href="#config/types/time">Time</a> = '0s')`<br />
Таймаут бездействия перед закрытием keep-alive соединения</p>
<blockquote>
<p>Если вы используете значение отличное от 0, учтите что nginx и некоторые другие веб-сервера НЕ ПОДДЕРЖИВАЮТ keep-alive соединения с FastCGI-бекэндами.</p>
</blockquote>
</li>
<li>
<p><code>:p</code>chunksize (<a href="#config/types/size">Size</a> = '8k')`<br />
Размер куска</p>
</li>
<li>
<p><code>defaultcharset (string = 'utf-8')</code><br />
Кодировка по-умолчанию</p>
</li>
<li>
<p><code>wss-name (string = '')</code><br />
Имя пула WebSocket-сервера, куда направлять WebSocket-соединения</p>
</li>
<li>
<p><code>fps-name (string = '')</code><br />
Имя пула FlashPolicy-сервера, куда адресовать FlashPolicy-соединения</p>
</li>
<li>
<p><code>:p</code>upload-max-size (<a href="#config/types/size">Size</a> = ini_get('upload_max_filesize'))`<br />
Максимальный размер загружаемого файла</p>
</li>
<li><code>responder (string = null)</code><br />
Имя приложения по-умолчанию для обработки запросов с данного сервера</li>
</ul>
<h3 id="servers/debugconsole"><div class="in anchor">DebugConsole <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Servers/DebugConsole"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#servers">Серверы</a></span></div>

</h3>
<p>Это транспортное приложение предоставляет интерактивную отладочную консоль для phpDaemon.</p>
<pre><code># telnet 127.0.0.1 8818
Trying 127.0.0.1...
Connected to 127.0.0.1.
Escape character is '^]'.
Welcome! DebugConsole for phpDaemon.

login secret
OK.
eval echo 123;
123</code></pre>
<h4 id="servers/debugconsole/options"><div class="in anchor">Опции<span class="header-path"> <i>&larr;</i> <a href="#servers/debugconsole">DebugConsole <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Servers/DebugConsole"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#servers">Серверы</a></span></div>

</h4>
<ul>
<li>
<p><code>listen (string = 'tcp://127.0.0.1')</code><br />
Какие адреса слушать, через запятую</p>
</li>
<li>
<p><code>port (integer = 8818)</code><br />
Прослушиваемый порт</p>
</li>
<li><code>passphrase (string = 'secret')</code><br />
Пароль для аутентификации</li>
</ul>
<h3 id="servers/flashpolicy"><div class="in anchor">FlashPolicy <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Servers/FlashPolicy"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#servers">Серверы</a></span></div>

</h3>
<p>Это простое приложение предоставляет Flashpolicy сервер для phpDaemon.</p>
<p>Это приложение необходимо включить в случае если вы хотите присоединяться к серверу посредством Flash.</p>
<h4 id="servers/flashpolicy/options"><div class="in anchor">Опции<span class="header-path"> <i>&larr;</i> <a href="#servers/flashpolicy">FlashPolicy <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Servers/FlashPolicy"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#servers">Серверы</a></span></div>

</h4>
<ul>
<li>
<p><code>listen (string = '0.0.0.0')</code><br />
Какие адреса слушать, через запятую</p>
</li>
<li>
<p><code>port (integer = 843)</code><br />
Прослушиваемый порт</p>
</li>
<li><code>file (string = getcwd() . '/conf/crossdomain.xml')</code><br />
Файл Flash-политики</li>
</ul>
<h3 id="servers/ident"><div class="in anchor">Servers\Ident<span class="header-path"> <i>&larr;</i> <a href="#servers">Серверы</a></span></div>

</h3>
<h3 id="servers/ircbouncer"><div class="in anchor">Servers\IRCBouncer<span class="header-path"> <i>&larr;</i> <a href="#servers">Серверы</a></span></div>

</h3>
<h3 id="servers/lock"><div class="in anchor">Lock <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Servers/Lock"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#servers">Серверы</a></span></div>

</h3>
<p>Требует рефакторинга</p>
<h3 id="servers/socks"><div class="in anchor">Servers\Socks<span class="header-path"> <i>&larr;</i> <a href="#servers">Серверы</a></span></div>

</h3>
<h3 id="servers/websocket"><div class="in anchor">WebSocket <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Servers/WebSocket"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#servers">Серверы</a></span></div>

</h3>
<p>Сервер использует пространство имен <a target="_self" class="tpl-inlink" href="#httprequest">HTTPRequest<i class="fa fa-caret-square-o-up"></i></a>.</p>
<p>Это транспортное приложение представляет WebSocket сервер для phpDaemon.</p>
<p>Ваше приложение должно получать ссылку на экземпляр WebSocketServer и вызывать addRoute() для добавления своих путей. Callback-функция пути должна возвращать новый экземпляр вашего класса, который наследуется от WebSocketRoute и определяет метод onFrame. Внутри метода onFrame мы можете обращаться к $this->client->sendFrame() для отправки пакетов клиенту.</p>
<h4 id="servers/websocket/options"><div class="in anchor">Опции<span class="header-path"> <i>&larr;</i> <a href="#servers/websocket">WebSocket <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Servers/WebSocket"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#servers">Серверы</a></span></div>

</h4>
<ul>
<li>
<p><code>listen (string = '0.0.0.0')</code>
Какие адреса слушать, через запятую</p>
</li>
<li>
<p><code>port (integer = 8047)</code>
Прослушиваемый порт</p>
</li>
<li>
<p><code>:p</code>max-allowed-packet (<a href="#config/types/size">Size</a> = new \PHPDaemon\Config\Entry\Size('1M'))`
Максимальный размер пакета</p>
</li>
<li>
<p><code>expose (boolean = true)</code>
Включать версию PHPDaemon в заголовке <code>X-Powered-By</code></p>
</li>
<li><code>fps-name (string = '')</code>
Имя пула FlashPolicy-сервера, куда адресовать FlashPolicy-соединения</li>
</ul>
<h2 id="clients"><div class="in anchor">Клиенты</div>

</h2>
<p>В основе всех клиентов лежит пространство имен <a target="_self" class="tpl-inlink" href="#network">Network<i class="fa fa-caret-square-o-up"></i></a>, изучение которого даст большее представление о возможностях клиентов и сетевой работы демона в целом.</p>
<h3 id="clients/basics"><div class="in anchor">Основы<span class="header-path"> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h3>
<h4 id="clients/basics/options"><div class="in anchor">Опции клиентов<span class="header-path"> <i>&larr;</i> <a href="#clients/basics">Основы</a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h4>
<ul>
<li>
<p><code>server (string)</code>
Адрес сервера. Записывается специальным форматом, описанном в разделе <a target="_self" class="tpl-inlink" href="#clients/basics/option-server">Опция server<i class="fa fa-caret-square-o-up"></i></a></p>
</li>
<li>
<p><code>servers (array)</code>
Адреса серверов, записанные в формате опции <code>server</code>, разделенные символом запятая <code>,</code>.
При подключении клиента будет использоваться рандомно выбранный сервер.
Учтите, данная опция будет игнорироваться если установлена опция <code>server</code>.</p>
</li>
<li><code>maxconnperserv</code></li>
<li><code>protologging</code></li>
</ul>
<h3 id="clients/asterisk"><div class="in anchor">Asterisk <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/Asterisk"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h3>
<pre><code class="language-php">namespace PHPDaemon\Clients\Asterisk;</code></pre>
<p class="doc-notice">Раздел устарел!</p>
<p><a target="_blank" class="tpl-outlink" href="http://www.asterisk.org/">Asterisk<i class="fa fa-external-link"></i></a> - это АТС с открытым исходным кодом.
AMI - программный интерфейс (API) Asterisk для управления системой, который позволяет разработчикам отправлять команды на сервер, считывать результаты их выполнения, а так же получать уведомления о происходящих событиях в реальном времени.
Клиент Asterisk обеспечивает высокоуровневый интерфейс к AMI, позволяющий разработчикам контролировать сервер Asterisk из приложений.</p>
<p>В основе документирования клиента лежит материал книги <a target="_blank" class="tpl-outlink" href="http://asterisk.ru/store/files/Asterisk_RU_OReilly_DRAFT.pdf">Asterisk: будущее телефонии<i class="fa fa-external-link"></i></a>.</p>
<h4 id="clients/asterisk/use"><div class="in anchor">Использование<span class="header-path"> <i>&larr;</i> <a href="#clients/asterisk">Asterisk <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/Asterisk"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h4>
<p>@TODO это из вики, проверить</p>
<p>Перед тем как посылать команды и получать события с сервера, нужно получить сессию(сессии) соединения(соединений) в вашем приложении. В вашем приложении вы получаете объект AsteriskDriver посредством:</p>
<pre><code class="language-php">$this-&gt;pbxDriver = Daemon::$appResolver-&gt;getInstanceByAppName('AsteriskDriver');</code></pre>
<h5 id="clients/asterisk/use/connect"><div class="in anchor">Соединение<span class="header-path"> <i>&larr;</i> <a href="#clients/asterisk/use">Использование</a> <i>&larr;</i> <a href="#clients/asterisk">Asterisk <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/Asterisk"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h5>
<p>Далее получаете объект AsteriskDriverSession посредством:</p>
<pre><code class="language-php">$session = $this-&gt;pbxDriver-&gt;getConnection();
// или
foreach($this-&gt;pbxConnections as $addr =&gt; $conn) {
    $session = $this-&gt;pbxDriver-&gt;getConnection($addr);
    // что-нибудь делаем...
}</code></pre>
<p>Добавляете (композиция) в него текущий контекст соединения посредством:</p>
<pre><code class="language-php">$session-&gt;context = $this;</code></pre>
<p>При соединении:</p>
<pre><code class="language-php">$session-&gt;onConnected(function(SocketSession $session, $status) {
    // ваш код, в зависимости от соединения
});</code></pre>
<p>При разрыве:</p>
<pre><code class="language-php">$session-&gt;onFinish(function(SocketSession $session) {
    // возможно запустить интервал реконнекта...
});</code></pre>
<p>Предположим у вас несколько серверов Asterisk с которых вы хотите получать события(events) и на которые вы хотите отправлять команды(actions). Так же вы хотите отслеживать падение соединения(connection failed), и осуществлять реконнект. Смотрите пример реконнекта ниже.</p>
<h5 id="clients/asterisk/use/io"><div class="in anchor">Немного о формате ввода-вывода<span class="header-path"> <i>&larr;</i> <a href="#clients/asterisk/use">Использование</a> <i>&larr;</i> <a href="#clients/asterisk">Asterisk <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/Asterisk"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h5>
<p>Хотя протокол AMI является строковым, драйвер при вводе-выводе работает с ассоциативными массивами. При получении ответа на действие или события все заголовки и их значения приводятся к нижнему регистру, если значение не содержит информацию, для которой важен регистр - например имя пира.</p>
<h5 id="clients/asterisk/use/cmds"><div class="in anchor">Отправка команд и получение ответа<span class="header-path"> <i>&larr;</i> <a href="#clients/asterisk/use">Использование</a> <i>&larr;</i> <a href="#clients/asterisk">Asterisk <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/Asterisk"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h5>
<p>Для отправки команды и получения ответа вы можете воспользоваться либо методом-помощником, который снабжен подробным комментарием из документации Asterisk, либо универсальным методом Connection::action.</p>
<p>В любом случае для каждой команды вы определяете функцию обратного вызова, в которую будет передан объект сессии соединения и ассоциативный массив пар заголовок-значение ответа.</p>
<p>Клиент корректно обрабатывает, что порядок следования пакетов ответа не определен, корректно собирает составные пакеты ответа.</p>
<pre><code class="language-php">$session-&gt;getSipPeers(function(SocketSession $session, array $packet) {
    // $session-&gt;addr содержит адрес соединения
    // $session-&gt;context содержит контекст вызова (если был установлен)
    // $packet - это массив пар заголовок-значение ответа
    // что-нибудь делаем
})
// или
$session-&gt;getConfig('chan_dahdi.conf', array($this, 'doSomething'));
public function doSomething(SocketSession $session, array $packet) {

}
// или
$session-&gt;action('Ping', function(SocketSession $session, array $packet) {
    if($packet['response'] == 'success' &amp;&amp; $packet['ping'] == 'pong') {
        // успешно сыграли в пинг-понг
    }    
});
// или
// $channel содержит канал из события
$session-&gt;redirect(array(
    'Channel' =&gt; $channel,
    'Context' =&gt; 'internal',
    'Exten' =&gt; '116',
    'Priority' =&gt; 1
), function(SocketSession $session, array $packet) {
  // узнаем успешно или нет из ответа сервера содержащегося в ассоциативном массиве $packet
});</code></pre>
<h5 id="clients/asterisk/use/events"><div class="in anchor">Получение событий сервера<span class="header-path"> <i>&larr;</i> <a href="#clients/asterisk/use">Использование</a> <i>&larr;</i> <a href="#clients/asterisk">Asterisk <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/Asterisk"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h5>
<p>Функция обратного вызова при наступлении события в данном соединении определяется один раз и передается методу onEvent().</p>
<pre><code class="language-php">$session-&gt;onEvent(array($this, 'onPbxEvent'));</code></pre>
<p>Когда запущено несколько воркеров, чтобы не получилось, что события канала(характеризуются наличием уникального идентификатора(uniqueid) канала) кратны количеству воркеров(workers) можно воспользоваться таблицей блокировки. Вот пример, когда в качестве таблицы блокировки используется MongoDB коллекция(collection), которая позволяет ставить уникальный индекс на документ:</p>
<pre><code class="language-php">$session-&gt;onEvent(array($this, 'onPbxEvent'));
// db.events.ensureIndex({"event": 1, "addr": 1}, {unique: true});
public function onPbxEvent(SocketSession $session, array $event) {
    if(method_exists('Foo_PbxEventDispatcher', "{$event['event']}Handler")) {
        $handler = "{$event['event']}Handler";
        if(isset($event['uniqueid']) || isset($event['uniqueid1'])) {
            $appInstance = $this;
            $this-&gt;db-&gt;events-&gt;insert(
                array(
                        'ts' =&gt; microtime(true),
                        'event' =&gt; $event,
                        'addr' =&gt; $session-&gt;addr
                ),
                function($result) use ($appInstance, $session, $event) {
                    if($result['err'] === null) {
                        $handler = "{$event['event']}Handler";
                        Foo_PbxEventDispatcher::$handler($appInstance, $session, $event);
                    }
                }
            );
        }
        else {
            Foo_PbxEventDispatcher::$handler($this, $session, $event);
        }
    }
}</code></pre>
<h4 id="clients/asterisk/example"><div class="in anchor">Пример реконнекта<span class="header-path"> <i>&larr;</i> <a href="#clients/asterisk">Asterisk <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/Asterisk"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h4>
<pre><code class="language-php">class Foo extends AppInstance {
    // ...
    public function onInit() {
        // pbxConnections - array of connections
        foreach($this-&gt;pbxConnections as $addr =&gt; $conn) {
            $pbx_driver_session = $this-&gt;pbxDriver-&gt;getConnection($addr);
            if($pbx_driver_session instanceof SocketSession) {
                $pbx_driver_session-&gt;context = $this;
                //$pbx_driver_session-&gt;onError(array($this, 'onPbxError'));
                $pbx_driver_session-&gt;onConnected(array($this, 'onPbxConnected'));
                $pbx_driver_session-&gt;onEvent(array($this, 'onPbxEvent'));
                $pbx_driver_session-&gt;onFinish(array($this, 'onPbxFinish'));
            }
            else {
                $this-&gt;runPbxReconnectInterval($pbx_driver_session);
            }
        }
    }
    // ...
    public function onPbxConnected(SocketSession $session, $status) {
        if($status) {
            if($session-&gt;context instanceof PbxReconnector) {
                $session-&gt;context-&gt;finish();
            }
            // do something...
        }
        else {
            $this-&gt;runPbxReconnectInterval($session);
        }
    }
    // ...
    public function onPbxFinish(SocketSession $session) {
        $this-&gt;runPbxReconnectInterval($session);
    }
    // ...
    public function runPbxReconnectInterval(SocketSession $session) {
                if(Daemon::$process-&gt;terminated) {
            return;
        }
        foreach ($this-&gt;queue as &amp;$r) {
            if($r instanceof PbxReconnector) {
                if ($r-&gt;attrs-&gt;addr == $session-&gt;addr) {
                    return;
                }
            }
        }
        $interval = $this-&gt;pushRequest(new PbxReconnector($this, $this));
        $interval-&gt;attrs-&gt;addr = $session-&gt;addr;
    }
    // ...
}
// ...
class PbxReconnector extends Request {
        public $interval = 0.3;

    public function run() {
        $pbx_driver_session = $this-&gt;appInstance-&gt;pbxDriver-&gt;getConnection($this-&gt;attrs-&gt;addr);
        if($pbx_driver_session) {
            if($this-&gt;appInstance-&gt;config-&gt;{'pbxreconnectorlogging'}-&gt;value) {
                Daemon::log('Reconnecting to ' . $this-&gt;attrs-&gt;addr);
            }
            $pbx_driver_session-&gt;context = $this;
            $pbx_driver_session-&gt;onConnected(array($this-&gt;appInstance, 'onPbxConnected'));
            $pbx_driver_session-&gt;onFinish(array($this-&gt;appInstance, 'onPbxFinish'));
        }
        $this-&gt;sleep($this-&gt;interval);
    }
}</code></pre>
<h4 id="clients/asterisk/pool"><div class="in anchor">Класс Pool <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/Asterisk/Pool.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#clients/asterisk">Asterisk <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/Asterisk"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h4>
<pre><code class="language-php">namespace PHPDaemon\Clients\Asterisk;
class Pool extends \PHPDaemon\Network\Client;</code></pre>
<h5 id="clients/asterisk/pool/options"><div class="in anchor">Опции по-умолчанию<span class="header-path"> <i>&larr;</i> <a href="#clients/asterisk/pool">Класс Pool <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/Asterisk/Pool.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients/asterisk">Asterisk <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/Asterisk"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h5>
<ul>
<li><code>authtype (string = 'md5')</code></li>
<li><code>port (integer = 5280)</code></li>
</ul>
<h5 id="clients/asterisk/pool/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#clients/asterisk/pool">Класс Pool <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/Asterisk/Pool.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients/asterisk">Asterisk <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/Asterisk"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h5>
<p><md:method>
boolean public static getConnection ( callable $cb )
boolean public static getConnection ( string $url = null, callable $cb = null, integer $pri = 0 )</p>
<p>Выполняет callback-функцию когда будет установлена связь с сервером. Возвращает <code>false</code> если соединение невозможно установить</p>
<p>$cb
callback ( <a href="#../../connection">Connection</a> $conn, array $packet )
вызывается когда будет установлена связь с сервером</p>
<p>$url
адрес сервера</p>
<p>$pri
приоритет данного вызова среди других. Чем больше значение, тем выше приоритет
</md:method></p>
<p><md:method>
</md:method></p>
<h4 id="clients/asterisk/connection"><div class="in anchor">Класс Connection <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/Asterisk/Connection.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#clients/asterisk">Asterisk <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/Asterisk"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h4>
<pre><code class="language-php">namespace PHPDaemon\Clients\Asterisk;
class Connection extends \PHPDaemon\Network\ClientConnection;</code></pre>
<h5 id="clients/asterisk/connection/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#clients/asterisk/connection">Класс Connection <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/Asterisk/Connection.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients/asterisk">Asterisk <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/Asterisk"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h5>
<p><md:method>
void public getSipPeers ( callable $cb )</p>
<p>Выводит список сконфигурированных в данный момент равноправных участников SIP с указанием их статуса<br />
Привилегии: system, all</p>
<p>$cb
callback ( <a href="#../">Connection</a> $conn, array $packet )
вызывается когда будет получен результат
</md:method></p>
<p><md:method>
void public getIaxPeers ( callable $cb )</p>
<p>Выводит список всех равноправных участников IAX2 с указанием их текущего статуса<br />
Привилегии: none</p>
<p>$cb
callback ( <a href="#../">Connection</a> $conn, array $packet )
вызывается когда будет получен результат
</md:method></p>
<p><md:method>
void public getConfig ( string $filename, callable $cb )</p>
<p>Извлекает данные из конфигурационного файла Asterisk<br />
Привилегии: config, all</p>
<p>$filename
имя конфигурационного файла, из которого должны извлекаться данные</p>
<p>$cb
callback ( <a href="#../">Connection</a> $conn, array $packet )
вызывается когда будет получен результат
</md:method></p>
<p><md:method>
void public getConfigJSON ( string $filename, callable $cb )</p>
<p>Возвращает данные из конфигурационного файла Asterisk в JSON формате<br />
Привилегии: config, all</p>
<p>$filename
имя конфигурационного файла, из которого должны извлекаться данные</p>
<p>$cb
callback ( <a href="#../">Connection</a> $conn, array $packet )
вызывается когда будет получен результат
</md:method></p>
<p><md:method>
void public setVar ( string $channel, string $variable, string $value, callable $cb )</p>
<p>Задает значение глобальной переменной или переменной канала<br />
Привилегии: call, all</p>
<p>$channel
канал, для переменной которого задается значение. Если не указан, переменная будет задана как глобальная</p>
<p>$variable
имя переменной</p>
<p>$value
значение</p>
<p>$cb
callback ( <a href="#../">Connection</a> $conn, array $packet )
вызывается когда будет получен результат
</md:method></p>
<p><md:method>
void public coreShowChannels ( callable $cb )</p>
<p>Отображает все активные каналы</p>
<p>$cb
callback ( <a href="#../">Connection</a> $conn, array $packet )
вызывается когда будет получен результат
</md:method></p>
<p><md:method>
void public status ( callable $cb, string $channel = null )</p>
<p>Представляет статус одного или более каналов с подробной информацией об их текущем состоянии<br />
Привилегии: call, all</p>
<p>$channel
ограничивает вывод статусом заданного канала</p>
<p>$cb
callback ( <a href="#../">Connection</a> $conn, array $packet )
вызывается когда будет получен результат
</md:method></p>
<p><md:method>
void public redirect ( array $params, callable $cb )</p>
<p>Перенаправляет канал в новый контекст, добавочный номер и приоритет диалплана<br />
Привилегии: call, all</p>
<p>$params
ассоциативный массив параметров команды</p>
<p>$cb
callback ( <a href="#../">Connection</a> $conn, array $packet )
вызывается когда будет получен результат
</md:method></p>
<p><md:method>
void public originate ( array $params, callable $cb )</p>
<p>Формирует исходящий вызов из Asterisk и соединяет канал с контекстом/добавочным номером/приоритетом или приложением диалплана<br />
Привилегии: call, all</p>
<p>$params
ассоциативный массив параметров команды</p>
<p>$cb
callback ( <a href="#../">Connection</a> $conn, array $packet )
вызывается когда будет получен результат
</md:method></p>
<p><md:method>
void public extensionState ( array $params, callable $cb )</p>
<p>Сообщает о состоянии заданного добавочного номера. Если добавочный номер имеет подсказку, эта команда обеспечит передачу состояния устройства, соединенного с данным добавочным номером<br />
Привилегии: call, all</p>
<p>$params
ассоциативный массив параметров команды</p>
<p>$cb
callback ( <a href="#../">Connection</a> $conn, array $packet )
вызывается когда будет получен результат
</md:method></p>
<p><md:method>
void public ping ( callable $cb )</p>
<p>Посылает запрос на сервер Asterisk, чтобы убедиться, что он до сих пор отвечает. Asterisk ответит сообщением Pong. Эта команда также может использоваться, чтобы не допустить разрыва соединения в результате истечения времени ожидания</p>
<p>$cb
callback ( <a href="#../">Connection</a> $conn, array $packet )
вызывается когда будет получен результат
</md:method></p>
<p><md:method>
void public action ( string $action, callable $cb, array $params = null, array $assertion = null )</p>
<p>Отправляет на сервер произвольную команду</p>
<p>$action
команда</p>
<p>$cb
callback ( <a href="#../">Connection</a> $conn, array $packet )
вызывается когда будет получен результат</p>
<p>$params
ассоциативный массив параметров команды</p>
<p>$assertion
@TODO If more events may follow as response this is a main part or full an action complete event indicating that all data has been sent
</md:method></p>
<p><md:method>
void public logoff ( callable $cb = null )</p>
<p>Завершает сеанс</p>
<p>$cb
callback ( <a href="#../">Connection</a> $conn, array $packet )
вызывается когда будет получен результат
</md:method></p>
<h3 id="clients/dns"><div class="in anchor">Clients\DNS<span class="header-path"> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h3>
<h3 id="clients/gibson"><div class="in anchor">Clients\Gibson<span class="header-path"> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h3>
<h3 id="clients/http"><div class="in anchor">HTTP <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/HTTP"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h3>
<pre><code class="language-php">namespace PHPDaemon\Clients\HTTP;</code></pre>
<p>Предназначен для выполнения GET и POST запросов на удаленные хосты.</p>
<p>Клиент использует пространство имен <a target="_self" class="tpl-inlink" href="#httprequest">HTTPRequest<i class="fa fa-caret-square-o-up"></i></a>.</p>
<h4 id="clients/http/examples"><div class="in anchor">Примеры<span class="header-path"> <i>&larr;</i> <a href="#clients/http">HTTP <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/HTTP"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h4>
<p>Получение файла <a target="_blank" class="tpl-outlink" href="http://www.google.com/robots.txt">google.com/robots.txt<i class="fa fa-external-link"></i></a> GET запросом:</p>
<pre><code class="language-php">$httpclient = \PHPDaemon\Clients\HTTP\Pool::getInstance();

$httpclient-&gt;get('http://www.google.com/robots.txt',
    function ($conn, $success) {
        // обработка данных ответа
    }
);</code></pre>
<p>Рабочий пример клиента представлен в <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/HTTP/Examples/Simple.php">Clients/HTTP/Examples/Simple.php<i class="fa fa-github"></i></a></p>
<h4 id="clients/http/pool"><div class="in anchor">Класс Pool <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/HTTP/Pool.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#clients/http">HTTP <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/HTTP"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h4>
<pre><code class="language-php">namespace PHPDaemon\Clients\HTTP;
class Pool extends \PHPDaemon\Network\Client;</code></pre>
<h5 id="clients/http/pool/options"><div class="in anchor">Опции по-умолчанию<span class="header-path"> <i>&larr;</i> <a href="#clients/http/pool">Класс Pool <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/HTTP/Pool.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients/http">HTTP <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/HTTP"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h5>
<ul>
<li><code>port (integer = 80)</code></li>
<li><code>ssl-port (integer = 443)</code></li>
<li><code>expose (boolean = true)</code></li>
</ul>
<h5 id="clients/http/pool/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#clients/http/pool">Класс Pool <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/HTTP/Pool.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients/http">HTTP <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/HTTP"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h5>
<p><md:method>
void public get ( url $url, array $params )
void public get ( url $url, callable $resultcb )</p>
<p>Осуществляет GET запрос</p>
<p>$url
запрашиваемый URL</p>
<p>$params
ассоциативный массив параметров запроса</p>
<p>$resultcb
callback ( <a href="#../../connection">Connection</a> $conn, boolean $success )
Вызывается когда на запрос пришел ответ, либо произошла ошибка
</md:method></p>
<p><md:method>
void public post ( url $url, array $data, array $params )
void public post ( url $url, array $data, callable $resultcb )</p>
<p>Осуществляет POST запрос</p>
<p>$url
запрашиваемый URL</p>
<p>$data
ассоциативный массив POST-параметров</p>
<p>$params
ассоциативный массив параметров запроса</p>
<p>$resultcb
callback ( <a href="#../../connection">Connection</a> $conn, boolean $success )
Вызывается когда на запрос пришел ответ, либо произошла ошибка
</md:method></p>
<p><md:method>
string public static buildUrl ( string $str )
string public static buildUrl ( array $mixed )</p>
<p>Генерирует URL-кодированную строку запроса из предоставленного ассоциативного (или индексного) массива <code>:hc</code>$mixed<code>или возвращает строку</code>:hc<code>$str</code>. В случае ошибки возвращает <code>:hc</code>false`</p>
<p>$mixed
массив параметров URL
</md:method></p>
<p><md:method>
string public static parseUrl ( string $str )
string public static parseUrl ( array $mixed )</p>
<p>Разбирает массив <code>:hc</code>$mixed<code>или строку</code>:hc<code>$str</code> и возвращает ассоциативный массив, содержащий необходимые компоненты URL: <code>:hc</code>[$scheme, $host, $uri, $port]<code>. В случае ошибки возвращает</code>:hc<code>false</code>.<br />
См. <a target="_blank" class="tpl-outlink" href="http://php.net/parse_url">php.net/parse_url<i class="fa fa-external-link"></i></a></p>
<p>$mixed
массив параметров URL
</md:method></p>
<h4 id="clients/http/connection"><div class="in anchor">Класс Connection <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/HTTP/Connection.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#clients/http">HTTP <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/HTTP"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h4>
<pre><code class="language-php">namespace PHPDaemon\Clients\HTTP;
class Connection extends \PHPDaemon\Network\ClientConnection;</code></pre>
<h5 id="clients/http/connection/properties"><div class="in anchor">Свойства<span class="header-path"> <i>&larr;</i> <a href="#clients/http/connection">Класс Connection <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/HTTP/Connection.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients/http">HTTP <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/HTTP"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h5>
<p><md:prop>
array public $headers;
Заголовки ответа
</md:prop></p>
<p><md:prop>
string public $body;
Тело ответа
</md:prop></p>
<p><md:prop>
integer public $contentLength;
Длина тела ответа
</md:prop></p>
<p><md:prop>
string public $cookie;
Ассоциативный массив Cookies пришедших в ответе
</md:prop></p>
<p><md:prop>
boolean public $chunked;
Если true, то в заголовках был получен <code>Transfer-Encoding: chunked</code>
</md:prop></p>
<p><md:prop>
integer public $protocolError;
Если не <code>:hc</code>null`, то произошла серьезная ошибка при обработке ответа на запрос. Содержит номер строки в файле <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/HTTP/Connection.php">Connection.php<i class="fa fa-github"></i></a>, по которому можно определить характер ошибки
</md:prop></p>
<p><md:prop>
integer public $responseCode;</p>
<p>Код ответа. См. <a target="_blank" class="tpl-outlink" href="http://ru.wikipedia.org/wiki/Список_кодов_состояния_HTTP">Список кодов состояния HTTP<i class="fa fa-external-link"></i></a>
</md:prop></p>
<p><md:prop>
string public $lastURL;
Последний запрошенный url
</md:prop></p>
<p><md:prop>
string public $rawHeaders;
Заголовки ответа в сыром виде
</md:prop></p>
<h5 id="clients/http/connection/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#clients/http/connection">Класс Connection <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/HTTP/Connection.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients/http">HTTP <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/HTTP"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h5>
<p><md:method>
string public getBody ( )</p>
<p>Возвращает тело ответа
</md:method></p>
<p><md:method>
string public getHeaders ( )</p>
<p>Возвращает ассоциативный массив заголовков ответа
</md:method></p>
<p><md:method>
string public getHeader ( string $name )</p>
<p>Возвращает заголовок ответа по имени или <code>:hc</code>null`</p>
<p>$name
имя заголовка
</md:method></p>
<h3 id="clients/icmp"><div class="in anchor">Clients\ICMP<span class="header-path"> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h3>
<h3 id="clients/irc"><div class="in anchor">Clients\IRC<span class="header-path"> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h3>
<h3 id="clients/lock"><div class="in anchor">Lock <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/Lock"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h3>
<p>Требует рефакторинга</p>
<h3 id="clients/memcache"><div class="in anchor">Clients\Memcache<span class="header-path"> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h3>
<h3 id="clients/mongo"><div class="in anchor">Clients\Mongo<span class="header-path"> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h3>
<h3 id="clients/mysql"><div class="in anchor">MySQL <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/MySQL"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h3>
<pre><code class="language-php">namespace PHPDaemon\Clients\MySQL;</code></pre>
<p>Клиент для СУБД <a target="_blank" class="tpl-outlink" href="http://mysql.com/">MySQL<i class="fa fa-external-link"></i></a></p>
<h4 id="clients/mysql/use"><div class="in anchor">Использование<span class="header-path"> <i>&larr;</i> <a href="#clients/mysql">MySQL <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/MySQL"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h4>
<p>@TODO</p>
<p>В вашем приложении вам следует получать объект MySQLClient посредством <code>Daemon::$appResolver-&gt;getInstanceByAppName('MySQLClient')</code> и использовать как описано ниже.</p>
<h5 id="clients/mysql/use/prepare"><div class="in anchor">Подготовка объекта соединения<span class="header-path"> <i>&larr;</i> <a href="#clients/mysql/use">Использование</a> <i>&larr;</i> <a href="#clients/mysql">MySQL <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/MySQL"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h5>
<pre><code>/*
  @method getConnection
  @description Establishes connection.
  @param string Optional. Address.
  @return integer Connection's ID.
*/</code></pre>
<p>Вам следует получить объект MySQLClientSession посредством метода $MySQLClient->getConnection(), затем вы можете положить ваш текущий запрос/сессию/что-нибудь еще в текущий контекст соединения (в свойство context).</p>
<p>Затем используйте:</p>
<pre><code class="language-php">$this-&gt;sql-&gt;onConnected(
    function($sql, $success) {
        if (!$success) {
            return;
        }
        // your connection-dependent code
    }
);</code></pre>
<h4 id="clients/mysql/examples"><div class="in anchor">Примеры<span class="header-path"> <i>&larr;</i> <a href="#clients/mysql">MySQL <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/MySQL"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h4>
<pre><code class="language-php">$sql-&gt;query('SHOW VARIABLES', 
   function($sql, $success) {
      $sql-&gt;context-&gt;queryResult = $sql-&gt;resultRows; // save the result
      $sql-&gt;context-&gt;wakeup(); // wake up the request immediately
   }
);</code></pre>
<p>Когда callback-функция вызвана, $sql->context содержит ваш объект, который вы туда положили перед этим. $sql->resultRows хранит результат в виде массива ассоциативных массивов. $sql->resultFields содержит поля ответа в виде массива ассоциативных массивов.</p>
<h4 id="clients/mysql/pool"><div class="in anchor">Класс Pool <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/MySQL/Pool.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#clients/mysql">MySQL <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/MySQL"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h4>
<pre><code class="language-php">namespace PHPDaemon\Clients\MySQL;
class Pool extends \PHPDaemon\Network\Client;</code></pre>
<h5 id="clients/mysql/pool/options"><div class="in anchor">Опции по-умолчанию<span class="header-path"> <i>&larr;</i> <a href="#clients/mysql/pool">Класс Pool <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/MySQL/Pool.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients/mysql">MySQL <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/MySQL"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h5>
<ul>
<li><code>server (string = 'tcp://root@127.0.0.1/')</code></li>
<li><code>port (integer = 3306)</code></li>
<li><code>max-conn-per-serv (integer = 32)</code></li>
</ul>
<h5 id="clients/mysql/pool/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#clients/mysql/pool">Класс Pool <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/MySQL/Pool.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients/mysql">MySQL <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/MySQL"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h5>
<p><md:method>
boolean public static getConnection ( callable $cb )
boolean public static getConnection ( string $url = null, callable $cb = null, integer $pri = 0 )</p>
<p>Выполняет callback-функцию когда будет установлена связь с сервером. Возвращает <code>false</code> если соединение невозможно установить</p>
<p>$cb
callback ( <a href="#../../connection">Connection</a> $conn )
вызывается когда будет установлена связь с сервером</p>
<p>$url
адрес сервера</p>
<p>$pri
приоритет данного вызова среди других. Чем больше значение, тем выше приоритет
</md:method></p>
<p><md:method>
string public static escape ( string $string )</p>
<p>Экранирует специальные символы: <code>\0</code>, <code>\n</code>, <code>\r</code>, <code>\</code>, <code>'</code>, <code>"</code></p>
<p>$string
исходная строка
</md:method></p>
<p><md:method>
string public static likeEscape ( string $string )</p>
<p>Работает как метод <code>:hc</code>Pool::escape<code>с дополнительными символами:</code>%<code>и</code>_`</p>
<p>$string
исходная строка
</md:method></p>
<p><md:method>
string public static value ( mixed $mixed )</p>
<p>Преобразует строку или число <code>:hc</code>$mixed<code>для использоания в SQL-выражении и возвращает значение в одинарных кавычках</code>'<code>. Для всех остальных типов возвращает</code>'null'`</p>
<p>$mixed
конвертируемые данные
</md:method></p>
<p><md:method>
string public static values ( mixed $arr )</p>
<p>Преобразует массив <code>:hc</code>$arr<code>для использоания в SQL-выражении и возвращает список значений, разделенные запятой</code>,`. Для всех остальных типов возвращает пустую строку</p>
<p>$mixed
конвертируемые данные
</md:method></p>
<h4 id="clients/mysql/connection"><div class="in anchor">Класс Connection <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/MySQL/Connection.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#clients/mysql">MySQL <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/MySQL"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h4>
<pre><code class="language-php">namespace PHPDaemon\Clients\MySQL;
class Connection extends \PHPDaemon\Network\ClientConnection;</code></pre>
<h5 id="clients/mysql/connection/properties"><div class="in anchor">Свойства<span class="header-path"> <i>&larr;</i> <a href="#clients/mysql/connection">Класс Connection <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/MySQL/Connection.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients/mysql">MySQL <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/MySQL"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h5>
<p><md:prop>
string public $serverver;
@TODO
</md:prop></p>
<p><md:prop>
string public $serverCaps;
@TODO
</md:prop></p>
<p><md:prop>
string public $serverLang;
@TODO
</md:prop></p>
<p><md:prop>
string public $serverStatus;
@TODO
</md:prop></p>
<p><md:prop>
integer public $warnCount;
@TODO
</md:prop></p>
<p><md:prop>
string public $message;
@TODO Flags of this MySQL client
</md:prop></p>
<p><md:prop>
string public $dbname;
Текущая база данных
</md:prop></p>
<p><md:prop>
array public $resultRows;
Массив результата SQL-запроса в виде ассоциативных массивов
</md:prop></p>
<p><md:prop>
array public $resultFields;
Массив колонок таблицы в виде ассоциативных массивов
</md:prop></p>
<p><md:prop>
string public $context;
Контекст для выполняемых SQL-запросов
</md:prop></p>
<p><md:prop>
integer public $insertId;
Идентификатор, сгенерированный при последнем INSERT-запросе
</md:prop></p>
<p><md:prop>
integer public $affectedRows;
Число затронутых SQL-запросом строк
</md:prop></p>
<p><md:prop>
integer public $protover;
@TODO
</md:prop></p>
<p><md:prop>
integer public $timeout;
@TODO
</md:prop></p>
<p><md:prop>
integer public $errno;
Численный код ошибки выполнения SQL-запроса
</md:prop></p>
<p><md:prop>
string public $errmsg;
Текст ошибки выполнения SQL-запроса
</md:prop></p>
<h5 id="clients/mysql/connection/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#clients/mysql/connection">Класс Connection <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/MySQL/Connection.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients/mysql">MySQL <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Clients/MySQL"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h5>
<p><md:method>
void public onConnected ( callable $callback )</p>
<p>Выполняет callback-функцию когда будет установлена связь с сервером</p>
<p>$callback
callback ( <a href="#../">Connection</a> $conn, boolean $success )
вызывается когда установлена связь с сервером, либо произошла ошибка
</md:method></p>
<p><md:method>
boolean public query ( string $query, callable $callback = NULL )</p>
<p>Осуществляет SQL-запрос к серверу</p>
<p>$query
SQL-запрос</p>
<p>$callback
callback ( <a href="#../">Connection</a> $conn, boolean $success )
вызывается когда получен результат SQL-запроса, либо произошла ошибка
</md:method></p>
<p><md:method>
boolean public ping ( callable $callback = NULL )</p>
<p>Проверяет работает ли соединение с сервером. Если оно утеряно, автоматически предпринимается попытка пересоединения</p>
<p>$callback
callback ( <a href="#../">Connection</a> $conn, boolean $success )
вызывается когда получен результат, либо произошла ошибка
</md:method></p>
<p><md:method>
boolean public selectDB ( string $name )</p>
<p>Выбирает базу данных MySQL</p>
<p>$name
имя выбираемой базы данных
</md:method></p>
<h3 id="clients/postgresql"><div class="in anchor">Clients\PostgreSQL<span class="header-path"> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h3>
<h3 id="clients/redis"><div class="in anchor">Clients\Redis<span class="header-path"> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h3>
<h3 id="clients/valve"><div class="in anchor">Clients\Valve<span class="header-path"> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h3>
<h3 id="clients/websocket"><div class="in anchor">Clients\WebSocket<span class="header-path"> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h3>
<h3 id="clients/xmpp"><div class="in anchor">Clients\XMPP<span class="header-path"> <i>&larr;</i> <a href="#clients">Клиенты</a></span></div>

</h3>
<h2 id="lib"><div class="in anchor">Библиотеки</div>

</h2>
<h3 id="lib/cache"><div class="in anchor">Cache <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Cache"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h3>
<pre><code class="language-php">namespace PHPDaemon\Cache;</code></pre>
<p>Механизм локального LRU-кеша ключ-значение.</p>
<blockquote>
<p>Используется для кеширования замыканий созданных через create_function. Также используется в <a target="_self" class="tpl-inlink" href="##clients/dns">Clients\DNS<i class="fa fa-caret-square-o-up"></i></a></p>
</blockquote>
<h4 id="lib/cache/capped-storage"><div class="in anchor">Класс CappedStorage <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Cache/CappedStorage.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#lib/cache">Cache <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Cache"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h4>
<pre><code class="language-php">namespace PHPDaemon\Cache;
abstact class CappedStorage;</code></pre>
<p>Базовый абстрактный класс.</p>
<h5 id="lib/cache/capped-storage/properties"><div class="in anchor">Свойства<span class="header-path"> <i>&larr;</i> <a href="#lib/cache/capped-storage">Класс CappedStorage <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Cache/CappedStorage.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib/cache">Cache <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Cache"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h5>
<p><md:prop>
callable public $sorter;
Метод сортировки
</md:prop></p>
<p><md:prop>
integer public $maxCacheSize;
Максимальное количество элементов в кеше
</md:prop></p>
<p><md:prop>
integer public $capWindow;
Количество элементов, которые пропускаются в кеш сверх максимального количества, для уменьшения количества сортировок
</md:prop></p>
<p><md:prop>
array public $cache;
Ассоциативный массив хранимых элементов
</md:prop></p>
<h5 id="lib/cache/capped-storage/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#lib/cache/capped-storage">Класс CappedStorage <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Cache/CappedStorage.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib/cache">Cache <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Cache"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h5>
<p><md:method>
string public hash ( string $key )</p>
<p>Возвращает хеш ключа, который идентифицирует элемент хранилища, по-умолчанию используется crc32()</p>
<p>$key
ключ элемента
</md:method></p>
<p><md:method>
<a href="#../../item">Item</a> public put ( string $key, mixed $value, float $ttl = null )</p>
<p>Добавляет элемент в кеш <a target="_self" class="tpl-inlink" href="##../../item">Item<i class="fa fa-caret-square-o-up"></i></a> с значением <code>:hc</code>$value`</p>
<p>$key
ключ элемента</p>
<p>$value
значение</p>
<p>$ttl
время жизни в секундах
</md:method></p>
<p><md:method>
void public invalidate ( string $key )</p>
<p>Удаляет элемент кеша</p>
<p>$key
ключ
</md:method></p>
<p><md:method>
<a href="#../../item">Item</a> public get ( string $key )</p>
<p>Возвращает элемент хранилища <a target="_self" class="tpl-inlink" href="##../../item">Item<i class="fa fa-caret-square-o-up"></i></a></p>
<p>$key
ключ
</md:method></p>
<p><md:method>
mixed public getValue ( string $key )</p>
<p>Возвращает значение элемента хранилища</p>
<p>$key
ключ элемента
</md:method></p>
<h4 id="lib/cache/item"><div class="in anchor">Класс Item <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Cache/Item.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#lib/cache">Cache <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Cache"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h4>
<pre><code class="language-php">namespace PHPDaemon\Cache;
class Item;</code></pre>
<h5 id="lib/cache/item/properties"><div class="in anchor">Свойства<span class="header-path"> <i>&larr;</i> <a href="#lib/cache/item">Класс Item <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Cache/Item.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib/cache">Cache <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Cache"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h5>
<p><md:prop>
integer public $hits;
Количество обращений к значению элемента
</md:prop></p>
<p><md:prop>
integer public $expire;
Временная метка до которой элемент действителен
</md:prop></p>
<h5 id="lib/cache/item/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#lib/cache/item">Класс Item <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Cache/Item.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib/cache">Cache <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Cache"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h5>
<p><md:method>
integer public getHits ( )</p>
<p>Возвращает количество обращений к значению элемента
</md:method></p>
<p><md:method>
mixed public getValue ( )</p>
<p>Возвращает значение элемента
</md:method></p>
<p><md:method>
void public addListener ( callable $cb )</p>
<p>Переданная функция обратного вызова будет вызвана когда будет установлено значение элемента</p>
<p>$cb
функция обратного вызова
</md:method></p>
<p><md:method>
void public setValue ( mixed $value )</p>
<p>Устанавливает значение элемента</p>
<p>$value
значение
</md:method></p>
<h4 id="lib/cache/capped-storage-hits"><div class="in anchor">Класс CappedStorageHits <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Cache/CappedStorageHits.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#lib/cache">Cache <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Cache"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h4>
<pre><code class="language-php">namespace PHPDaemon\Cache;
class CappedStorageHits extends CappedStorage;</code></pre>
<p>Реализация <a target="_self" class="tpl-inlink" href="##../capped-storage">CappedStorage<i class="fa fa-caret-square-o-up"></i></a> с сортировкой по количеству обращений</p>
<h3 id="lib/complexjob"><div class="in anchor">ComplexJob <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Core/ComplexJob.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h3>
<p>```php:p
namespace PHPDaemon\Core;
class ComplexJob extends [ArrayAccess](<a href="http://php.net/manual/class.arrayaccess.php">http://php.net/manual/class.arrayaccess.php</a>);</p>
<pre><code>
Объект класса ComplexJob позволяет повесить функцию обратного вызова на завершение всех объявленных в нем процедур. Это удобно, когда нужно выполнить ряд независимых цепочек действий.

#### examples # Примеры

```php
$j = new ComplexJob(function($j) { // Когда всё выполнилось
   D($j['foo']); // this
   D($j['foobar']); // is
   D($j['bar']); // sparta
});

/* Добавляем задачу */
$j('foo', function($name, $j) { 
   $j[$name] = 'this'; // Вызываем setResult()

   /* Еще задачу */
   $j('foobar', function($name, $j) { 
      $j[$name] = 'is';
   });
});

/* И еще одну */
$j('bar', function($name, $j) {
   $j[$name] = 'sparta';
});

$j(); // Запускаем</code></pre>
<h4 id="lib/complexjob/consts"><div class="in anchor">Константы<span class="header-path"> <i>&larr;</i> <a href="#lib/complexjob">ComplexJob <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Core/ComplexJob.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h4>
<p><md:const>
const STATE_WAITING = 1;
Состояние: ожидание
</md:const></p>
<p><md:const>
const STATE_RUNNING = 2;
Состояние: в процессе
</md:const></p>
<p><md:const>
const STATE_DONE = 3;
Состояние: завершено
</md:const></p>
<h4 id="lib/complexjob/properties"><div class="in anchor">Свойства<span class="header-path"> <i>&larr;</i> <a href="#lib/complexjob">ComplexJob <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Core/ComplexJob.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h4>
<p><md:prop>
callable public $listeners;
Стек функций обратного вызова, которые вызываются при успешном выполнении всех объявленных процедур
</md:prop></p>
<p><md:prop>
integer public $results;
Ассоциативный массив результатов установленных через <code>:h</code>setResult($value, $value)<code>или</code>:h<code>$job[$name] = $value;</code>
</md:prop></p>
<p><md:prop>
integer public $state;
Состояние (константа STATE_*) 
</md:prop></p>
<p><md:prop>
array public $jobs;
Ассоциативный массив, хранящий функции обратного вызова подзадач
</md:prop></p>
<p><md:prop>
array public $resultsNum;
Количество выполненных подзадач
</md:prop></p>
<p><md:prop>
array public $jobsNum;
Количество подзадач
</md:prop></p>
<h4 id="lib/complexjob/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#lib/complexjob">ComplexJob <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Core/ComplexJob.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h4>
<p><md:method>
void public __construct ( callable $cb = null )</p>
<p>Конструктор</p>
<p>$cb
функция обратного вызова для метода addListener
</md:method></p>
<p><md:method>
void public addListener ( callable $cb )</p>
<p>Переданная функция будет вызвана когда все подзадачи выполнены</p>
<p>$cb
функция обратного вызова
</md:method></p>
<p><md:method>
mixed public offsetExists ( string $j )</p>
<p>Позволяет сделать <code>:hc</code>isset($j[$name])`</p>
<p>$j
имя подзадачи
</md:method></p>
<p><md:method>
mixed public offsetGet ( string $j )</p>
<p>Позволяет сделать <code>:hc</code>isset($job[$name])`</p>
<p>$j
имя подзадачи
</md:method></p>
<p><md:method>
mixed public offsetSet ( string $j, mixed $v )</p>
<p>Позволяет сделать <code>:hc</code>$job[$name] = $value`</p>
<p>$j
имя подзадачи</p>
<p>$v
значение
</md:method></p>
<p><md:method>
mixed public offsetUnset ( string $j )</p>
<p>Позволяет сделать <code>:hc</code>unset($job[$name])`</p>
<p>$j
имя подзадачи
</md:method></p>
<p><md:method>
array public getResults ( )</p>
<p>Возвращает ассоциативный массив результатов
</md:method></p>
<p><md:method>
void public keep ( boolean $keep = true )</p>
<p>Включает опцию keep, при которой, после выполнения всех подзадач не вызывается метод <code>:hc</code>cleanup()`</p>
<p>$keep
true/false
</md:method></p>
<p><md:method>
boolean public hasCompleted ( )</p>
<p>Выполнены ли все подзадачи?
</md:method></p>
<p><md:method>
<a href="#../">ComplexJob</a> public maxConcurrency ( integer $n = -1 )</p>
<p>Устанавливает максимальное количество одновременно выполняемых задач</p>
<p>$n
Натуральное число. При <code>-1</code> ограничение не действует.
</md:method></p>
<p><md:method>
boolean public setResult ( string $jobname, mixed $result = null )</p>
<p>Устанавливает результат выполнения подзадачи</p>
<p>$jobname
Название подзадачи</p>
<p>$result
Результат
</md:method></p>
<p><md:method>
mixed public getResult ( string $jobname )</p>
<p>Получить результат выполнения подзадачи по имени</p>
<p>$jobname
имя подзадачи
</md:method></p>
<p><md:method>
void public checkQueue ( )</p>
<p>Вызывается автоматически. Проверяет полна ли очередь и если нет, то пробует запустить еще подзадач из <code>backlog</code> и <code>more</code>.
</md:method></p>
<p><md:method>
<a href="#../">ComplexJob</a> public more ( callable $cb = null )</p>
<p>Задает функцию обратного вызова, которая автоматически вызывается каждый раз, когда можно добавить еще подзадач.</p>
<p>$cb
функция обратного вызова
</md:method></p>
<p><md:method>
boolean public isQueueFull ( )</p>
<p>Проверяет полна ли на данный момент очередь задач (превышен ли параметр <code>maxConcurrency</code>)
</md:method></p>
<p><md:method>
boolean public addJob ( string $name, callable $cb )</p>
<p>Добавляет подзадачу</p>
<p>$name
имя подзадачи</p>
<p>$cb
функция обратного вызова
</md:method></p>
<p><md:method>
void public cleanup ( )</p>
<p>Удаляет сохраненные результаты и функции обратного вызова. Вызывается автоматически, не задан параметр <code>keep</code>. В этом случае, во избежание утечек памяти вызывайте этот метод сами, когда закончили работать с данными.
</md:method></p>
<p><md:method>
void public execute ( )</p>
<p>Выполняет 
</md:method></p>
<p><md:method>
boolean public __invoke ( string $name = null, callable $cb = null )</p>
<p>Синоним <code>addJob ( $name, $cb )</code>. Пример: <code>:hc</code>$job('job', )`
</md:method></p>
<p><md:method>
boolean public __invoke ( )</p>
<p>Синоним <code>execute()</code>. Пример: <code>:hc</code>$job()`
</md:method></p>
<h3 id="lib/shellcommand"><div class="in anchor">ShellCommand <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Core/ShellCommand.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h3>
<pre><code class="language-php">namespace PHPDaemon\Core;
class ShellCommand extends \PHPDaemon\Network\IOStream;</code></pre>
<p>Класс является наследником IOStream, так что в нём доступны такие методы как read[ln], write[ln], и так далее.</p>
<h4 id="lib/shellcommand/examples"><div class="in anchor">Примеры<span class="header-path"> <i>&larr;</i> <a href="#lib/shellcommand">ShellCommand <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Core/ShellCommand.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h4>
<h5 id="lib/shellcommand/examples/simple"><div class="in anchor">Простое выполнение, аналог функции shell_exec</div>

</h5>
<pre><code class="language-php">ShellCommand::exec('echo "foo"', function($commandInstance, $output) {
   D($output); // foo
});</code></pre>
<h5 id="lib/shellcommand/examples/with_params"><div class="in anchor">С дополнительными параметрами и переменными окружения</div>

</h5>
<pre><code class="language-php">$command = 'git log';
$cb = function($commandInstance, $output) {
     D($output); // foo
};
$arguments = ['-1', '--pretty' =&gt; 'oneline'];
$env = [];
ShellCommand::exec($command, $cb, $arguments, $env);</code></pre>
<blockquote>
<p>Аргументы будут экранированы с помощью <code>escapeshellarg</code></p>
</blockquote>
<h5 id="lib/shellcommand/examples/packet-processing"><div class="in anchor">Пакетная обработка вывода</div>

</h5>
<p>@TODO</p>
<h4 id="lib/shellcommand/properties"><div class="in anchor">Свойства<span class="header-path"> <i>&larr;</i> <a href="#lib/shellcommand">ShellCommand <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Core/ShellCommand.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h4>
<p><md:prop>
string public $binPath;
Исполняемый путь
</md:prop></p>
<p><md:prop>
string public $setUser;
Имя Unix-пользователя от имени которого выполняется команда
</md:prop></p>
<p><md:prop>
string public $setGroup;
Имя Unix-группы от имени которого выполняется команда
</md:prop></p>
<p><md:prop>
string public $chroot = '/';
Подмена корневого каталога для выполняемой команды
</md:prop></p>
<p><md:prop>
string public $cwd;
@TODO
</md:prop></p>
<h4 id="lib/shellcommand/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#lib/shellcommand">ShellCommand <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Core/ShellCommand.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h4>
<p><md:method>
void public static exec ( string $binPath = null, callable $cb = null, array $args = null, array $env = null )</p>
<p>Выполняет команду (статический метод)</p>
<p>$binPath
исполняемый путь</p>
<p>$cb
функция обратного вызова</p>
<p>$args
массив аргументов</p>
<p>$env
ассоциативный массив переменных окружения (можно передать $_ENV`)
</md:method></p>
<p><md:method>
string public getCmd ( )</p>
<p>Возвращает строку исполняемой команды
</md:method></p>
<p><md:method>
<a href="#../">ShellCommand</a> public setUser ( string $val )</p>
<p>Задает имя Unix-пользователя от имени которого выполняется команда</p>
<p>$val
имя пользователя
</md:method></p>
<p><md:method>
<a href="#../">ShellCommand</a> public setGroup ( string $val )</p>
<p>Задает название Unix-группы от которой выполняется команда</p>
<p>$val
название группы
</md:method></p>
<p><md:method>
<a href="#../">ShellCommand</a> public setCwd ( string $dir )</p>
<p>Установить рабочий каталог для выполняемой команды</p>
<p>$dir
путь
</md:method></p>
<p><md:method>
<a href="#../">ShellCommand</a> public setChroot ( string $dir )</p>
<p>Подменяет корневой каталог для выполняемой команды</p>
<p>$dir
путь
</md:method></p>
<p><md:method>
<a href="#../">ShellCommand</a> public setArgs ( array $args = NULL )</p>
<p>Установить список аргументов</p>
<p>$args
массив аргументов
</md:method></p>
<p><md:method>
<a href="#../">ShellCommand</a> public setEnv ( array $env = NULL )</p>
<p>Задает ассоциативный массив переменных окружения (можно передать $_ENV`)</p>
<p>$env
массив
</md:method></p>
<p><md:method>
<a href="#../">ShellCommand</a> public nice ( integer $nice = NULL )</p>
<p>Задает приоритет выделения процессорного времени (меньше — выше)</p>
<p>$nice
целое число
</md:method></p>
<p><md:method>
string public static buildArgs ( array $args )</p>
<p>Строит строку аргументов по массиву</p>
<p>$args
массив аргумент
</md:method></p>
<p><md:method>
<a href="#../">ShellCommand</a> public execute ( string $binPath = NULL, array $args = NULL, array $env = NULL )</p>
<p>Непосредственно выполняет команду</p>
<p>$binPath
исполняемый путь</p>
<p>$args
массив аргументов</p>
<p>$env
ассоциативный массив переменных окружения (можно передать $_ENV`)
</md:method></p>
<p><md:method>
boolean public finishWrite ( )</p>
<p>Закрывает поток ввода исполняемого процесса, когда буфер будет прочитан
</md:method></p>
<p><md:method>
void public close ( )</p>
<p>Завершает процесс
</md:method></p>
<p><md:method>
<a href="#../">ShellCommand</a> public closeWrite ( )</p>
<p>Безусловно закрывает поток ввода исполняемого процесса (STDIN)
</md:method></p>
<p><md:method>
boolean public eof ( )</p>
<p>Достигнут ли EOF (Конец Файла)?
</md:method></p>
<p><md:method>
<a href="#../">ShellCommand</a> public onEOF ( callable $cb = NULL )</p>
<p>Переданная функция обратного вызова будет вызвана когда достигнут EOF (Конец Файла)</p>
<p>$cb
функция обратного вызова
</md:method></p>
<h3 id="lib/timer"><div class="in anchor">Timer <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Core/Timer.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h3>
<p>```php:p
namespace PHPDaemon\Core;
class Timer;</p>
<pre><code>
С помощью этого класса можно создавать отложенные во времени события (таймеры)

#### examples # Примеры

```php
$i = 0;
setTimeout(function($timer) use (&amp;$i) {
 D("Пять секунд прошло!");

 if (++$i &lt; 3) {
    // запуск таймера ещё на 5 секунд
    $timer-&gt;timeout();
 } else {
    D('Конец');
    $timer-&gt;free();
 }
}, 5e6);</code></pre>
<h4 id="lib/timer/global-functions"><div class="in anchor">Глобальные функции <span class="header-path"> <i>&larr;</i> <a href="#lib/timer">Timer <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Core/Timer.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h4>
<p><md:method>
integer setTimeout ( callable $cb, integer $timeout = null, integer $id = null, integer $priority = null )</p>
<p>Функция-псевдоним <code>Timer::add</code></p>
<p>$cb
функция обратного вызова</p>
<p>$timeout
количество микросекунд через которое должна быть выполнена функция обратного вызова</p>
<p>$id
идентификатор таймера</p>
<p>$priority
приоритет события таймера
</md:method></p>
<p><md:method>
</md:method></p>
<h4 id="lib/timer/properties"><div class="in anchor">Свойства<span class="header-path"> <i>&larr;</i> <a href="#lib/timer">Timer <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Core/Timer.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h4>
<p><md:prop>
integer public $id;
Идентификатор таймера
</md:prop></p>
<p><md:prop>
integer public $lastTimeout;
Количество микросекунд на которое был взведен таймер последний раз
</md:prop></p>
<p><md:prop>
boolean public $finished = false;
Завершен ли данный таймер?
</md:prop></p>
<p><md:prop>
callable public $cb;
Функция обратного вызова
</md:prop></p>
<p><md:prop>
array public static $list = [];
Ассоциативный массив всех таймеров
</md:prop></p>
<p><md:prop>
integer public $priority;
Приоритет события данного таймера 
</md:prop></p>
<h4 id="lib/timer/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#lib/timer">Timer <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Core/Timer.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h4>
<p><md:method>
void public __construct ( callable $cb, integer $timeout = null, integer $id = null, integer $priority = null )</p>
<p>Конструктор</p>
<p>$cb
функция обратного вызова</p>
<p>$timeout
количество микросекунд через которое должна быть выполнена функция обратного вызова</p>
<p>$id
идентификатор таймера</p>
<p>$priority
приоритет события таймера
</md:method></p>
<p><md:method>
void public setPriority ( integer $priority )</p>
<p>@TODO</p>
<p>$priority
@TODO
</md:method></p>
<p><md:method>
integer public static add ( callable $cb, integer $timeout = null, integer $id = null, integer $priority = null )</p>
<p>@TODO</p>
<p>$cb
@TODO</p>
<p>$timeout
@TODO</p>
<p>$id
@TODO</p>
<p>$priority
@TODO
</md:method></p>
<p><md:method>
boolean public static setTimeout ( integer $id, integer $timeout = NULL )</p>
<p>@TODO</p>
<p>$id
@TODO</p>
<p>$timeout
@TODO
</md:method></p>
<p><md:method>
void public static remove ( integer $id )</p>
<p>@TODO</p>
<p>$id
@TODO
</md:method></p>
<p><md:method>
void public static cancelTimeout ( integer $id )</p>
<p>@TODO</p>
<p>$id
@TODO
</md:method></p>
<p><md:method>
void public timeout ( integer $timeout = null )</p>
<p>@TODO</p>
<p>$timeout
@TODO
</md:method></p>
<p><md:method>
void public cancel ( )</p>
<p>@TODO
</md:method></p>
<p><md:method>
void public finish ( )</p>
<p>@TODO
</md:method></p>
<p><md:method>
void public __destruct ( )</p>
<p>@TODO
</md:method></p>
<p><md:method>
void public free ( )</p>
<p>@TODO
</md:method></p>
<h3 id="lib/transport-context"><div class="in anchor">TransportContext <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Core/TransportContext.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h3>
<p>```php:p
namespace PHPDaemon\Core;
class TransportContext extends AppInstance;</p>
<pre><code>
@TODO

### fs # FS #&gt; FS &lt;a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/FS"&gt;&lt;i class="fa fa-github"&gt;&lt;/i&gt;&lt;/a&gt;

```php
namespace PHPDaemon\FS;</code></pre>
<h4 id="lib/transport-context/filesystem"><div class="in anchor">Класс FileSystem <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/FS/FileSystem.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#lib/transport-context">TransportContext <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Core/TransportContext.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h4>
<pre><code class="language-php">namespace PHPDaemon\FS;
class FileSystem;</code></pre>
<h5 id="lib/transport-context/filesystem/properties"><div class="in anchor">Свойства<span class="header-path"> <i>&larr;</i> <a href="#lib/transport-context/filesystem">Класс FileSystem <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/FS/FileSystem.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib/transport-context">TransportContext <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Core/TransportContext.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h5>
<p><md:prop>
boolean public static $supported;
@TODO
</md:prop></p>
<p><md:prop>
Event public static $ev;
@TODO
</md:prop></p>
<p><md:prop>
resource public static $fd;
@TODO
</md:prop></p>
<p><md:prop>
array public static $modeTypes;
@TODO
</md:prop></p>
<p><md:prop>
integer public static $badFDttl = 5;
@TODO
</md:prop></p>
<p><md:prop>
<a href="#libraries/cache/capped-storage">CappedStorage</a> public static $fdCache;
@TODO
</md:prop></p>
<p><md:prop>
integer public static $fdCacheSize = 128;
@TODO
</md:prop></p>
<p><md:prop>
string public static $eioVer = '1.2.1';
@TODO
</md:prop></p>
<h5 id="lib/transport-context/filesystem/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#lib/transport-context/filesystem">Класс FileSystem <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/FS/FileSystem.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib/transport-context">TransportContext <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Core/TransportContext.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h5>
<p><md:method>
void public static init ( )</p>
<p>@TODO
</md:method></p>
<p><md:method>
void public static initEvent ( )</p>
<p>@TODO
</md:method></p>
<p><md:method>
boolean public static checkFileReadable ( string $path )</p>
<p>@TODO</p>
<p>$path
@TODO
</md:method></p>
<p><md:method>
void public static waitAllEvents ( )</p>
<p>@TODO
</md:method></p>
<p><md:method>
void public static updateConfig ( )</p>
<p>@TODO
</md:method></p>
<p><md:method>
string public static sanitizePath ( string $path )</p>
<p>@TODO</p>
<p>$path
@TODO
</md:method></p>
<p><md:method>
array public static statPrepare ( array $stat )</p>
<p>@TODO</p>
<p>$stat
@TODO
</md:method></p>
<p><md:method>
resource public static stat ( string $path, callable $cb, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$path
@TODO</p>
<p>$cb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
resource public static unlink ( string $path, callable $cb = null, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$path
@TODO</p>
<p>$cb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
resource public static rename ( string $path, string $newpath, callable $cb = null, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$path
@TODO</p>
<p>$newpath
@TODO</p>
<p>$cb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
resource public static statvfs ( string $path, callable $cb, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$path
@TODO</p>
<p>$cb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
resource public static lstat ( string $path, callable $cb, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$path
@TODO</p>
<p>$cb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
resource public static realpath ( string $path, callable $cb, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$path
@TODO</p>
<p>$cb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
resource public static sync ( callable $cb = null, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$cb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
resource public static syncfs ( callable $cb = null, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$cb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
resource public static touch ( string $path, integer $mtime, integer $atime = null, callable $cb = null, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$path
@TODO</p>
<p>$mtime
@TODO</p>
<p>$atime
@TODO</p>
<p>$cb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
resource public static rmdir ( string $path, callable $cb = null, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$path
@TODO</p>
<p>$cb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
resource public static mkdir ( string $path, integer $mode, callable $cb = null, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$path
@TODO</p>
<p>$mode
@TODO</p>
<p>$cb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
resource public static readdir ( string $path, callable $cb = null, integer $flags, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$path
@TODO</p>
<p>$cb
@TODO</p>
<p>$flags
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
resource public static truncate ( string $path, integer $offset = 0, callable $cb = null, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$path
@TODO</p>
<p>$offset
@TODO</p>
<p>$cb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
boolean public static sendfile ( mixed $outfd, string $path, callable $cb, callable $startCb = null, integer $offset = 0, integer $length = null, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$outfd
@TODO</p>
<p>$path
@TODO</p>
<p>$cb
@TODO</p>
<p>$startCb
@TODO</p>
<p>$offset
@TODO</p>
<p>$length
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
resource public static chown ( string $path, integer $uid, integer $gid = -1, callable $cb, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$path
@TODO</p>
<p>$uid
@TODO</p>
<p>$gid
@TODO</p>
<p>$cb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
resource public static readfile ( string $path, callable $cb, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$path
@TODO</p>
<p>$cb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
void public static readfileChunked ( string $path, callable $cb, callable $chunkcb, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$path
@TODO</p>
<p>$cb
@TODO</p>
<p>$chunkcb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
string public static genRndTempnam ( string $dir = null, string $prefix = 'php' )</p>
<p>@TODO</p>
<p>$dir
@TODO</p>
<p>$prefix
@TODO
</md:method></p>
<p><md:method>
string public static genRndTempnamPrefix ( string $dir, string $prefix )</p>
<p>@TODO</p>
<p>$dir
@TODO</p>
<p>$prefix
@TODO
</md:method></p>
<p><md:method>
void public static tempnam ( string $dir, string $prefix, callable $cb )</p>
<p>@TODO</p>
<p>$dir
@TODO</p>
<p>$prefix
@TODO</p>
<p>$cb
@TODO
</md:method></p>
<p><md:method>
resource public static open ( string $path, string $flags, callable $cb, integer $mode = null, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$path
@TODO</p>
<p>$flags
@TODO</p>
<p>$cb
@TODO</p>
<p>$mode
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<h4 id="lib/transport-context/file"><div class="in anchor">Класс File <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/FS/File.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#lib/transport-context">TransportContext <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Core/TransportContext.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h4>
<pre><code class="language-php">namespace PHPDaemon\FS;
class File;</code></pre>
<h5 id="lib/transport-context/file/properties"><div class="in anchor">Свойства<span class="header-path"> <i>&larr;</i> <a href="#lib/transport-context/file">Класс File <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/FS/File.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib/transport-context">TransportContext <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Core/TransportContext.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h5>
<p><md:prop>
integer public priority = 10;
@TODO
</md:prop></p>
<p><md:prop>
integer public $chunkSize = 4096;
@TODO
</md:prop></p>
<p><md:prop>
integer public $offset = 0;
@TODO
</md:prop></p>
<p><md:prop>
string public $fdCacheKey;
@TODO
</md:prop></p>
<p><md:prop>
boolean public $append;
@TODO
</md:prop></p>
<p><md:prop>
string public $path;
@TODO
</md:prop></p>
<p><md:prop>
boolean public $writing = false;
@TODO
</md:prop></p>
<p><md:prop>
boolean public $closed = false;
@TODO
</md:prop></p>
<h5 id="lib/transport-context/file/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#lib/transport-context/file">Класс File <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/FS/File.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib/transport-context">TransportContext <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Core/TransportContext.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h5>
<p><md:method>
void public __construct ( resource $fd, string $path )</p>
<p>@TODO</p>
<p>$fd
@TODO</p>
<p>$path
@TODO
</md:method></p>
<p><md:method>
resource public getFd ( )</p>
<p>@TODO
</md:method></p>
<p><md:method>
mixed public static convertFlags ( string $mode, boolean $text = false )</p>
<p>@TODO</p>
<p>$mode
@TODO</p>
<p>$text
@TODO
</md:method></p>
<p><md:method>
resource public truncate ( integer $offset = 0, callable $cb = null, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$offset
@TODO</p>
<p>$cb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
resource public stat ( callable $cb, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$cb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
resource public statRefresh ( callable $cb, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$cb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
resource public statvfs ( callable $cb, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$cb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
resource public sync ( callable $cb, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$cb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
resource public datasync ( callable $cb, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$cb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
resource public write ( string $data, callable $cb = null, integer $offset = null, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$data
@TODO</p>
<p>$cb
@TODO</p>
<p>$offset
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
resource public chown ( integer $uid, integer $gid = -1, callable $cb, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$uid
@TODO</p>
<p>$gid
@TODO</p>
<p>$cb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
resource public touch ( integer $mtime, integer $atime = null, callable $cb = null, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$mtime
@TODO</p>
<p>$atime
@TODO</p>
<p>$cb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
void public clearStatCache ( )</p>
<p>@TODO
</md:method></p>
<p><md:method>
boolean public read ( integer $length, integer $offset = null, callable $cb = null, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$length
@TODO</p>
<p>$offset
@TODO</p>
<p>$cb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
boolean public sendfile ( mixed $outfd, callable $cb, callable $startCb = null, integer $offset = 0, integer $length = null, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$outfd
@TODO</p>
<p>$cb
@TODO</p>
<p>$startCb
@TODO</p>
<p>$offset
@TODO</p>
<p>$length
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
resource public readahead ( integer $length, integer $offset = null, callable $cb = null, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$length
@TODO</p>
<p>$offset
@TODO</p>
<p>$cb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
boolean public readAll ( callable $cb, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$cb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
resource public readAllChunked ( callable $cb = null, callable $chunkcb = null, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$cb
@TODO</p>
<p>$chunkcb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
string public __toString ( )</p>
<p>@TODO
</md:method></p>
<p><md:method>
void public setChunkSize ( integer $n )</p>
<p>@TODO</p>
<p>$n
@TODO
</md:method></p>
<p><md:method>
resource public seek ( integer $offset, callable $cb, integer $pri = EIO_PRI_DEFAULT )</p>
<p>@TODO</p>
<p>$offset
@TODO</p>
<p>$cb
@TODO</p>
<p>$pri
@TODO
</md:method></p>
<p><md:method>
integer public tell ( )</p>
<p>@TODO
</md:method></p>
<p><md:method>
resource public close ( )</p>
<p>@TODO
</md:method></p>
<p><md:method>
void public __destruct ( )</p>
<p>@TODO
</md:method></p>
<h4 id="lib/transport-context/filewatcher"><div class="in anchor">Класс FileWatcher <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/FS/FileWatcher.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#lib/transport-context">TransportContext <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Core/TransportContext.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h4>
<pre><code class="language-php">namespace PHPDaemon\FS;
class FileWatcher;</code></pre>
<h5 id="lib/transport-context/filewatcher/properties"><div class="in anchor">Свойства<span class="header-path"> <i>&larr;</i> <a href="#lib/transport-context/filewatcher">Класс FileWatcher <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/FS/FileWatcher.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib/transport-context">TransportContext <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Core/TransportContext.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h5>
<p><md:prop>
array public files = [];
@TODO
</md:prop></p>
<p><md:prop>
resource public $inotify;
@TODO
</md:prop></p>
<p><md:prop>
array public $descriptors = [];
@TODO
</md:prop></p>
<h5 id="lib/transport-context/filewatcher/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#lib/transport-context/filewatcher">Класс FileWatcher <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/FS/FileWatcher.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib/transport-context">TransportContext <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Core/TransportContext.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h5>
<p><md:method>
void public __construct ( )</p>
<p>@TODO
</md:method></p>
<p><md:method>
boolean public addWatch ( string $path, mixed $subscriber, integer $flags = NULL )</p>
<p>@TODO</p>
<p>$path
@TODO</p>
<p>$subscriber
@TODO</p>
<p>$flags
@TODO
</md:method></p>
<p><md:method>
boolean public rmWatch ( string $path, mixed $subscriber )</p>
<p>@TODO</p>
<p>$path
@TODO</p>
<p>$subscriber
@TODO
</md:method></p>
<p><md:method>
void public onFileChanged ( string $path )</p>
<p>@TODO</p>
<p>$path
@TODO
</md:method></p>
<p><md:method>
void public watch ( )</p>
<p>@TODO
</md:method></p>
<h3 id="lib/pubsub"><div class="in anchor">PubSub <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/PubSub"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h3>
<pre><code class="language-php">namespace PHPDaemon\PubSub;</code></pre>
<h4 id="lib/pubsub/pubsub"><div class="in anchor">Класс PubSub <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/PubSub/PubSub.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#lib/pubsub">PubSub <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/PubSub"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h4>
<pre><code class="language-php">namespace PHPDaemon\PubSub;
class PubSub;</code></pre>
<h5 id="lib/pubsub/pubsub/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#lib/pubsub/pubsub">Класс PubSub <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/PubSub/PubSub.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib/pubsub">PubSub <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/PubSub"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h5>
<p><md:method>
boolean public eventExists ( string $id )</p>
<p>@TODO</p>
<p>$id
@TODO
</md:method></p>
<p><md:method>
<a href="#../../pubsubevent">PubSubEvent</a> public sub ( string $id, object $obj, callable $cb )</p>
<p>@TODO</p>
<p>$id
@TODO</p>
<p>$obj
@TODO</p>
<p>$cb
@TODO
</md:method></p>
<p><md:method>
void public addEvent ( string $id, PubSubEvent $obj )</p>
<p>@TODO</p>
<p>$id
@TODO</p>
<p>$obj
@TODO
</md:method></p>
<p><md:method>
void public removeEvent ( string $id )</p>
<p>@TODO</p>
<p>$id
@TODO
</md:method></p>
<p><md:method>
<a href="#../../pubsubevent">PubSubEvent</a> public unsub ( string $id, object $obj )</p>
<p>@TODO</p>
<p>$id
@TODO</p>
<p>$obj
@TODO
</md:method></p>
<p><md:method>
<a href="#../../pubsubevent">PubSubEvent</a> public pub ( string $id, mixed $data )</p>
<p>@TODO</p>
<p>$id
@TODO</p>
<p>$data
@TODO
</md:method></p>
<p><md:method>
boolean public unsubFromAll ( object $obj )</p>
<p>@TODO</p>
<p>$obj
@TODO
</md:method></p>
<h4 id="lib/pubsub/pubsubevent"><div class="in anchor">Класс PubSubEvent <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/PubSub/PubSubEvent.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#lib/pubsub">PubSub <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/PubSub"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h4>
<p>```php:p
namespace PHPDaemon\PubSub;
class PubSubEvent extends [SplObjectStorage](<a href="http://php.net/manual/class.splobjectstorage.php">http://php.net/manual/class.splobjectstorage.php</a>);</p>
<pre><code>
##### properties # Свойства

&lt;md:prop&gt;
array public $sub = [ ];
@TODO
&lt;/md:prop&gt;

&lt;md:prop&gt;
callable public $actCb;
@TODO
&lt;/md:prop&gt;

&lt;md:prop&gt;
callable public $deactCb;
@TODO
&lt;/md:prop&gt;

##### methods # Методы

&lt;md:method&gt;
void public __construct ( callable $act = null, callable $deact = null )

@TODO

$act
@TODO

$deact
@TODO
&lt;/md:method&gt;

&lt;md:method&gt;
[PubSubEvent](#../) public onActivation ( callable $cb )

@TODO

$cb
@TODO
&lt;/md:method&gt;

&lt;md:method&gt;
[PubSubEvent](#../) public onDeactivation ( callable $cb )

@TODO

$cb
@TODO
&lt;/md:method&gt;

&lt;md:method&gt;
[PubSubEvent](#../) public static init ( )

@TODO
&lt;/md:method&gt;

&lt;md:method&gt;
[PubSubEvent](#../) public sub ( object $obj, callable $cb )

@TODO

$obj
@TODO

$cb
@TODO
&lt;/md:method&gt;

&lt;md:method&gt;
[PubSubEvent](#../) public unsub ( object $obj )

@TODO

$obj
@TODO
&lt;/md:method&gt;

&lt;md:method&gt;
[PubSubEvent](#../) public pub ( mixed $data )

@TODO

$data
@TODO
&lt;/md:method&gt;

### sockjs # SockJS #&gt; SockJS &lt;a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/SockJS"&gt;&lt;i class="fa fa-github"&gt;&lt;/i&gt;&lt;/a&gt;

```php
namespace PHPDaemon\SockJS;</code></pre>
<h4 id="lib/pubsub/application"><div class="in anchor">Класс Application <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/SockJS/Application.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#lib/pubsub">PubSub <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/PubSub"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h4>
<pre><code class="language-php">namespace PHPDaemon\SockJS;
class Application extends \PHPDaemon\Core\AppInstance;</code></pre>
<h5 id="lib/pubsub/application/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#lib/pubsub/application">Класс Application <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/SockJS/Application.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib/pubsub">PubSub <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/PubSub"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#lib">Библиотеки</a></span></div>

</h5>
<p><md:method>
public function getLocalSubscribersCount ( $chan )</p>
<p>@DESC</p>
<p>$params
params
</md:method></p>
<p><md:method>
public function subscribe ( $chan, $cb, $opcb = null )</p>
<p>@DESC</p>
<p>$params
params
</md:method></p>
<p><md:method>
public function setnx ( $key, $value, $cb = null )</p>
<p>@DESC</p>
<p>$params
params
</md:method></p>
<p><md:method>
public function setkey ( $key, $value, $cb = null )</p>
<p>@DESC</p>
<p>$params
params
</md:method></p>
<p><md:method>
public function getkey ( $key, $cb = null )</p>
<p>@DESCNS</p>
<p>$params
params
</md:method></p>
<p><md:method>
public function expire ( $key, $seconds, $cb = null )</p>
<p>@DESC</p>
<p>$params
params
</md:method></p>
<p><md:method>
public function unsubscribe ( $chan, $cb, $opcb = null )</p>
<p>@DESC</p>
<p>$params
params
</md:method></p>
<p><md:method>
public function unsubscribeReal ( $chan, $opcb = null )</p>
<p>@DESC</p>
<p>$params
params
</md:method></p>
<p><md:method>
public function publish ( $chan, $cb, $opcb = null )</p>
<p>@DESC</p>
<p>$params
params
</md:method></p>
<p><md:method>
public function onReady (  )</p>
<p>@DESCспользуется в DNS</p>
<p>$params
params
</md:method></p>
<p><md:method>
public function onFinish (  )</p>
<p>@DESCпользуется в DNS</p>
<p>$params
params
</md:method></p>
<p><md:method>
public function attachWss ( $wss )</p>
<p>@DESCуется в DNS</p>
<p>$params
params
</md:method></p>
<p><md:method>
public function wsHandler ( $ws, $path, $client, $state )</p>
<p>@DESC</p>
<p>$params
params
</md:method></p>
<p><md:method>
public function detachWss ( $wss )</p>
<p>@DESCуется в DNS</p>
<p>$params
params
</md:method></p>
<p><md:method>
public function beginSession ( $path, $sessId, $server )</p>
<p>@DESC</p>
<p>$params
params
</md:method></p>
<p><md:method>
public function getRouteOptions ( $path )</p>
<p>@DESC DNS</p>
<p>$params
params
</md:method></p>
<p><md:method>
public function endSession ( $session )</p>
<p>@DESC в DNS</p>
<p>$params
params
</md:method></p>
<p><md:method>
public function beginRequest ( $req, $upstream )</p>
<p>@DESC</p>
<p>$params
params
</md:method></p>
<p><md:method>
public function callMethod ( $method, $req, $upstream )</p>
<p>@DESC</p>
<p>$params
params
</md:method></p>
<h2 id="apps"><div class="in anchor">Приложения</div>

</h2>
<h3 id="apps/mongonode"><div class="in anchor">MongoNode <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Examples/MongoNode.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#apps">Приложения</a></span></div>

</h3>
<p>```php:p
namespace PHPDaemon\Examples;
class MongoNode;</p>
<pre><code>
Это приложение предоставляет узел репликации MongoDB. Это дает возможность устанавливать произвольные хуки на добавление/изменение/удаление объектов.

#### requirements # Требования

Требуется установленный модуль pecl/mongo и включенный phpdaemon/MongoCllient.

#### use # Использование

Когда MongoNode включено, оно незамедлительно получает новые изменения в базе.

По-умолчанию:

Если объект обладает свойством “_key” сериализованное его значение отправляется в ключ Memcache под тем названием, которое задано в значении _key. Когда объект удаляется из MongoDB, он удаляется и из Memcache.

Если объект имеет свойство “_ev”, его значение отправляется в RTEP-событие под тем названием, которое задано в значении _ev.

### telnethoneypot # TelnetHoneypot #&gt; TelnetHoneypot &lt;a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Examples/TelnetHoneypot.php"&gt;&lt;i class="fa fa-github"&gt;&lt;/i&gt;&lt;/a&gt;

```php:p
namespace PHPDaemon\Examples;
class TelnetHoneypot;</code></pre>
<p>Это приложение предоставляет простой telnet сервер для phpDaemon.</p>
<h4 id="apps/mongonode/use"><div class="in anchor">Использование<span class="header-path"> <i>&larr;</i> <a href="#apps/mongonode">MongoNode <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Examples/MongoNode.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#apps">Приложения</a></span></div>

</h4>
<pre><code>[root@gf-home-server phpdaemon.wiki]# telnet 127.0.0.1 23
Trying 127.0.0.1...
Connected to 127.0.0.1.
Escape character is '^]'.
ping
pong</code></pre>
<h3 id="apps/serverstatus"><div class="in anchor">ServerStatus <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Applications/ServerStatus.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#apps">Приложения</a></span></div>

</h3>
<p>```php:p
namespace PHPDaemon\Applications;
class ServerStatus;</p>
<pre><code>
Это приложение обеспечивает получение информации о состоянии phpDaemon по протоколу HTTP, аналогично консольной команде `phpd fullstatus`.

#### use # Использование

Необходимо добавить в `conf/phpd.conf`:
</code></pre>
<p>ServerStatus {</p>
<pre><code>enable    1;</code></pre>
<p>}
HTTP {</p>
<pre><code>enable 1;
privileged;</code></pre>
<p>}</p>
<pre><code>
Также в `conf/AppResolver.php` в методе `getRequestRoute()` добавить условие для запуска метода `beginRequest()` в приложении ServerStatus. Например, чтобы получить информацию о phpDaemon по адресу http://&lt;host&gt;/ServerStatus/:

```php
/**
 * Routes incoming request to related application. Method is for overloading.   
 * @param object Request.
 * @param object AppInstance of Upstream.
 * @return string Application's name.
 */
public function getRequestRoute($req, $upstream) {
    if (preg_match('~^/(ServerStatus|Example)/~', $req-&gt;attrs-&gt;server['DOCUMENT_URI'], $m)) {
        return $m[1];
    }
}</code></pre>
<p>Пример ответа:</p>
<pre><code>Uptime: 1 day. 11 hour. 33 min. 51 sec.
State of workers:
        Total: 4
        Idle: 4
        Busy: 0
        Shutdown: 20
        Pre-init: 0
        Wait-init: 0
        Init: 0</code></pre>
<h4 id="apps/serverstatus/note"><div class="in anchor">Примечание<span class="header-path"> <i>&larr;</i> <a href="#apps/serverstatus">ServerStatus <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Applications/ServerStatus.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#apps">Приложения</a></span></div>

</h4>
<p>Если вы используете опцию --logworkersetstatus, то соответствие такое:</p>
<ul>
<li>1 - idle</li>
<li>2 - busy</li>
<li>3 - shutdown</li>
<li>4 - pre-init</li>
<li>5 - wait-init</li>
<li>6 - init</li>
</ul>
<h2 id="utils"><div class="in anchor">Утилиты</div>

</h2>
<h3 id="utils/binary"><div class="in anchor">Binary <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Utils/Binary.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#utils">Утилиты</a></span></div>

</h3>
<pre><code class="language-php">namespace PHPDaemon\Utils;
class Binary;</code></pre>
<p>Данный класс предоставляет набор статических методов для работы с бинарными данными.</p>
<h4 id="utils/binary/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#utils/binary">Binary <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Utils/Binary.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#utils">Утилиты</a></span></div>

</h4>
<p><md:method>
string public static labels ( string $q )</p>
<p>Возвращает структуру имен. Используется в DNS</p>
<p>$q
Список имен через точку
</md:method></p>
<p><md:method>
string public static parseLabels ( string &amp;$data, string $orig = null )</p>
<p>азбирает структуру имен. Используется в DNS</p>
<p>&amp;$data
Структура</p>
<p>$orig
Изначальный пакет данных для обработки ссылок на подстроки
</md:method></p>
<p><md:method>
string public static LV ( string $str, integer $len = 1, boolean $lrev = false )</p>
<p>Возвращает структуру Длина-Значение</p>
<p>$str
Значение</p>
<p>$len
Количество байтов для записи длины</p>
<p>$lrev
Если true, то Little-Endian
</md:method></p>
<p><md:method>
string public static LVnull ( string $str )</p>
<p>Возвращает структуру Длина-Значение с Little-Endian размером длины в два байта и NUL-байтом после строки</p>
<p>$str
Значение
</md:method></p>
<p><md:method>
string public static byte ( integer $int )</p>
<p>Кодирует целое число в один байт</p>
<p>$int
Число от 0 до 255
</md:method></p>
<p><md:method>
string public static word ( integer $int )</p>
<p>Кодирует целое число в два байта</p>
<p>$int
Целое от 0 до 65535
</md:method></p>
<p><md:method>
string public static wordl ( integer $int )</p>
<p>Кодирует целое число в два байта Little-Endian</p>
<p>$int
Целое от 0 до 65535
</md:method></p>
<p><md:method>
string public static dword ( integer $int )</p>
<p>Кодирует целое число в четыре байта</p>
<p>$int
Целое от 0 до 4294967295
</md:method></p>
<p><md:method>
string public static dwordl ( integer $int )</p>
<p>Кодирует целое число в четыре байта Little-Endian</p>
<p>$int
Целое от 0 до 4294967295
</md:method></p>
<p><md:method>
string public static qword ( integer $int )</p>
<p>Кодирует целое число в восемь байт</p>
<p>$int
Целое от 0 до 18446744073709551615
</md:method></p>
<p><md:method>
string public static qwordl ( integer $int )</p>
<p>Кодирует целое число в восемь байт Little-Endian</p>
<p>$int
Целое от 0 до 18446744073709551615
</md:method></p>
<p><md:method>
integer public static getByte ( string &amp;$p )</p>
<p>Удаляет первый байт из строки и возвращает его в виде целого числа от 0 до 255</p>
<p>&amp;$p
Строка
</md:method></p>
<p><md:method>
string public static getChar ( string &amp;$p )</p>
<p>Удаляет первый байт из строки и возвращает его в виде строки</p>
<p>&amp;$p
Строка
</md:method></p>
<p><md:method>
integer public static getWord ( string &amp;$p, boolean $l = false )</p>
<p>Удаляет первые два байта из строки и возвращает их в виде целого числа от 0 до 65535</p>
<p>&amp;$p
Строка</p>
<p>$l
Если true, то Little-Endian
</md:method></p>
<p><md:method>
string public static getStrWord ( string &amp;$p, boolean $l = false )</p>
<p>Удаляет первые два байта из строки и возвращает их</p>
<p>&amp;$p
Строка</p>
<p>$l
Если true, то Little-Endian
</md:method></p>
<p><md:method>
integer public static getDWord ( string &amp;$p, boolean $l = false )</p>
<p>Удаляет первые четыре байта из строки и возвращает их в виде целого от 0 до 4294967295</p>
<p>&amp;$p
Строка</p>
<p>$l
Если true, то Little-Endian
</md:method></p>
<p><md:method>
integer public static getQword ( string &amp;$p, boolean $l = false )</p>
<p>Удаляет первые восемь байт из строки и возвращает их в виде целого от 0 до 18446744073709551615</p>
<p>&amp;$p
Строка</p>
<p>$l
Если true, то Little-Endian
</md:method></p>
<p><md:method>
string public static getStrQWord ( string &amp;$p, boolean $l = false )</p>
<p>Удаляет первые восемь байт из строки и возвращает их в виде строки</p>
<p>&amp;$p
Строка</p>
<p>$l
Если true, то Little-Endian
</md:method></p>
<p><md:method>
string public static getString ( string &amp;$str )</p>
<p>Возвращает подстроку до первого NUL-байта и удаляет её из исходной вместе с NUL-байтом</p>
<p>&amp;$str
Строка
</md:method></p>
<p><md:method>
string public static getLV ( string &amp;$p, boolean $l = 1, boolean $nul = false, boolean $lrev = false )</p>
<p>Разбирает пару Длина-Значение, удаляет её из начала исходной строки и возвращает значение</p>
<p>&amp;$p
Строка</p>
<p>$l
Количество байтов для записи длины</p>
<p>$nul
Если true, то воспринимать как NUL-завершенную строку</p>
<p>$lrev
Если true, то Little-Endian
</md:method></p>
<p><md:method>
string public static flags2bitarray ( array $flags, integer $len = 4 )</p>
<p>Кодирует массив флагов (числа должны быть степенями двойки – 2, 4, 16, 32...)</p>
<p>$flags
массив чисел</p>
<p>$len
Количество байтов на выходе
</md:method></p>
<p><md:method>
string public static int2bytes ( integer $len, integer $int = 0, boolean $l = false )</p>
<p>Кодирует целое число</p>
<p>$len
Количество байтов на выходе</p>
<p>$int
Целое число</p>
<p>$l
Если true, то Little-Endian
</md:method></p>
<p><md:method>
string public static i2b ( integer $len, integer $int = 0, boolean $l = false )</p>
<p>Псевдоним метода <code>:hc</code>int2bytes`
</md:method></p>
<p><md:method>
integer public static bytes2int ( string $str, boolean $l = false )</p>
<p>Конвертирует строку в целое число</p>
<p>$str
Строку</p>
<p>$l
Если true, то Little-Endian
</md:method></p>
<p><md:method>
integer public static b2i ( string $str, boolean $l = false )</p>
<p>Псевдоним метода <code>:hc</code>bytes2int`
</md:method></p>
<p><md:method>
string public static bitmap2bytes ( string $bitmap, integer $check_len = 0 )</p>
<p>Конвертирует побитовое представление в массив байтов</p>
<p>$bitmap
Строка состоящая из 1 и 0 </p>
<p>$check_len
Ожидаемое количество байт на выходе, при несовпадении будет возвращено false
</md:method></p>
<p><md:method>
string public static getbitmap ( string $byte )</p>
<p>Получить побитовое представление в виде строки из 1 и 0</p>
<p>$byte
Строка из одного байта
</md:method></p>
<h3 id="utils/crypt"><div class="in anchor">Crypt <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Utils/Crypt.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#utils">Утилиты</a></span></div>

</h3>
<pre><code class="language-php">namespace PHPDaemon\Utils;
class Crypt;</code></pre>
<p>Данный класс содержит методы, относящиеся к криптографии.</p>
<h4 id="utils/crypt/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#utils/crypt">Crypt <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Utils/Crypt.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#utils">Утилиты</a></span></div>

</h4>
<p><md:method>
string public static hash ( string $str, string $salt = '', boolean $plain = false )</p>
<p>Возвращает хеш строки по алгоритму Keccak</p>
<p>$str
исходная строка</p>
<p>$salt
примесь для хеширования</p>
<p>$plain
если <code>false</code> то результат будет закодирован в base64
</md:method></p>
<p><md:method>
string public static randomString ( integer $len = 64, string $chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_-.' )</p>
<p>Генерирует псевдослучайную строку длиной <code>:hc</code>$len<code>из представленных в</code>:hc<code>$chars</code> символов</p>
<p>$len
длина выходной строки</p>
<p>$chars
набор используемых символов
</md:method></p>
<p><md:method>
boolean public static compareStrings ( string $a, string $b )</p>
<p>Сравнение строк устойчивое к атаке по времени (англ. Timing attack)</p>
<p>$a, $b
Строки для сравнения
</md:method></p>
<h3 id="utils/datetime"><div class="in anchor">DateTime <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Utils/DateTime.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#utils">Утилиты</a></span></div>

</h3>
<p>```php:p
namespace PHPDaemon\Utils;
class DateTime extends [DateTime](<a href="http://php.net/manual/class.datetime.php">http://php.net/manual/class.datetime.php</a>);</p>
<pre><code>
В конструтор можно передавать метку времени Unix.

#### methods # Методы

&lt;md:method&gt;
string public static diffAsText ( mixed $datetime1, mixed $datetime2, boolean $absolute = false )

Возвращает разницу двух временных меток в виде строки. Пример: `:c`1 year. 2 mon. 6 day. 4 hours. 21 min. 10 sec.`

$datetime1, $datetime2
временные метки. Может быть объектом &lt;a target="_blank" class="tpl-outlink" href="http://php.net/manual/class.datetimeinterface.php"&gt;DateTimeInterface&lt;i class="fa fa-external-link"&gt;&lt;/i&gt;&lt;/a&gt;, строкой или меткой времени Unix

$absolute
используется, чтобы вернуть абсолютную разницу
&lt;/md:method&gt;

&lt;md:method&gt;
&lt;/md:method&gt;

### encoding # Encoding #&gt; Encoding &lt;a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Utils/Encoding.php"&gt;&lt;i class="fa fa-github"&gt;&lt;/i&gt;&lt;/a&gt;

```php
namespace PHPDaemon\Utils;
class Encoding;</code></pre>
<p>Сторонняя библиотека — <a target="_blank" class="tpl-outlink" href="https://github.com/neitanod/forceutf8">forceutf8<i class="fa fa-external-link"></i></a></p>
<h4 id="utils/datetime/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#utils/datetime">DateTime <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Utils/DateTime.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#utils">Утилиты</a></span></div>

</h4>
<p><md:method>
string public static toUTF8 ( string $text )</p>
<p>Приводит текст к UTF-8</p>
<p>$text
Текст
</md:method></p>
<p><md:method>
string public static toWin1252 ( string $text )</p>
<p>Приводит к текст к Windows-1251</p>
<p>$text
Текст
</md:method></p>
<p><md:method>
string public static toISO8859 ( string $text )</p>
<p>Приводит к текст к ISO-8859</p>
<p>$text
Текст
</md:method></p>
<p><md:method>
string public static toLatin1 ( string $text )</p>
<p>Приводит к текст к Windows-1251</p>
<p>$text
Текст
</md:method></p>
<p><md:method>
string public static fixUTF8 ( string $text )</p>
<p>Исправляет UTF-8</p>
<p>$text
Текст
</md:method></p>
<p><md:method>
string public static UTF8FixWin1252Chars ( string $text )</p>
<p>Исправляет UTF-8 после конвертации из Windows-1252 так, будто это была ISO-8859</p>
<p>$text
Текст
</md:method></p>
<p><md:method>
string public static removeBOM ( string $str = "" )</p>
<p>Удаляет Byte-order mark</p>
<p>$str
Текст
</md:method></p>
<p><md:method>
string public static normalizeEncoding ( string $encodingLabel )</p>
<p>Приводит название кодировки к стандартной записи</p>
<p>$encodingLabel
Название кодировки
</md:method></p>
<h3 id="utils/irc"><div class="in anchor">IRC <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Utils/IRC.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#utils">Утилиты</a></span></div>

</h3>
<pre><code class="language-php">namespace PHPDaemon\Utils;
class IRC;</code></pre>
<p>Класс используемый в IRC-клиенте и IRC-баунсере</p>
<h4 id="utils/irc/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#utils/irc">IRC <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Utils/IRC.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#utils">Утилиты</a></span></div>

</h4>
<p><md:method>
string public static getCommandByCode ( integer $code )</p>
<p>Возвращает строковое представление команды по её коду</p>
<p>$code
код команды
</md:method></p>
<p><md:method>
string public static getCodeByCommand ( string $cmd )</p>
<p>Возвращает код команды по её строковому представлению</p>
<p>$cmd
строковое представление команды
</md:method></p>
<p><md:method>
string public static parseUsermask ( string $mask )</p>
<p>Возвращает ассоциативный массив вида {nick: string, unverified: bool, user: string, host: string, orig: string}</p>
<p>$mask
маска вида <code>nick!~?user@host</code>
</md:method></p>
<h3 id="utils/mime"><div class="in anchor">MIME <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Utils/MIME.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#utils">Утилиты</a></span></div>

</h3>
<pre><code class="language-php">namespace PHPDaemon\Utils;
class MIME;</code></pre>
<h4 id="utils/mime/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#utils/mime">MIME <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Utils/MIME.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#utils">Утилиты</a></span></div>

</h4>
<p><md:method>
string public static get ( string $path )</p>
<p>Возвращает MIME-заголовок файла или <code>false</code></p>
<p>$path
путь до файла
</md:method></p>
<p><md:method>
</md:method></p>
<h3 id="utils/shmentity"><div class="in anchor">ShmEntity <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Utils/ShmEntity.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#utils">Утилиты</a></span></div>

</h3>
<pre><code class="language-php">namespace PHPDaemon\Utils;
class ShmEntity;</code></pre>
<p>Эластичное хранилище кучи в разделяемой памяти</p>
<blockquote>
<p>Используется для хранения массива состояний рабочих процессов</p>
</blockquote>
<h4 id="utils/shmentity/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#utils/shmentity">ShmEntity <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Utils/ShmEntity.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#utils">Утилиты</a></span></div>

</h4>
<p><md:method>
string public __construct ( string $path, integer $segsize, string $name, boolean $create = false )</p>
<p>Конструктор</p>
<p>$path
путь до файла</p>
<p>$segsize
размер сегмента</p>
<p>$name
название</p>
<p>$create
флаг создания сегмента
</md:method></p>
<p><md:method>
string public open ( integer $segno = 0, boolean $create = false )</p>
<p>Открывает сегмент разделяемой памяти</p>
<p>$segno
номер сегмента</p>
<p>$create
флаг создания сегмента
</md:method></p>
<p><md:method>
string public getSegments ( )</p>
<p>Возвращает индексный массив всех сегментов
</md:method></p>
<p><md:method>
string public openall ( )</p>
<p>Открывает все сегменты
</md:method></p>
<p><md:method>
string public write ( string $data, integer $offset )</p>
<p>Записывает данные <code>:hc</code>$data<code>со смещением</code>:hc<code>$offset</code></p>
<p>$data
данные</p>
<p>$offset
смещение
</md:method></p>
<p><md:method>
string public read ( integer $offset, integer $length = 1 )</p>
<p>Считывает данные длиной <code>:hc</code>$length<code>со смещением</code>:hc<code>$offset</code></p>
<p>$offset
смещение</p>
<p>$length
длина читаемых данных
</md:method></p>
<p><md:method>
string public delete ( )</p>
<p>Удаляет все сегменты
</md:method></p>
<h3 id="utils/terminal"><div class="in anchor">Terminal <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Utils/Terminal.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#utils">Утилиты</a></span></div>

</h3>
<pre><code class="language-php">namespace PHPDaemon\Utils;
class Terminal;</code></pre>
<p><a target="_self" class="tpl-catimg" href="#contribute/code"><img src="/docs/imgs/cat.png" style="padding-right: 6px;" align="left"></a><br />Данный класс нуждается в доработке: не хватает полноценной поддержки ncurses.
Если хотите помочь, нажмите на кота!<br /></p>
<h4 id="utils/terminal/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#utils/terminal">Terminal <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Utils/Terminal.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#utils">Утилиты</a></span></div>

</h4>
<p><md:method>
string public readln ( )</p>
<p>@TODO
</md:method></p>
<p><md:method>
void public enableColor ( boolean $bool = true )</p>
<p>@TODO</p>
<p>$bool
@TODO
</md:method></p>
<p><md:method>
void public clearScreen ( )</p>
<p>@TODO
</md:method></p>
<p><md:method>
void public setStyle ( string $c )</p>
<p>@TODO</p>
<p>$c
@TODO
</md:method></p>
<p><md:method>
void public resetStyle ( )</p>
<p>@TODO
</md:method></p>
<p><md:method>
void public drawParam ( string $name, string $description, array $values = '' )</p>
<p>@TODO</p>
<p>$name
@TODO</p>
<p>$description
@TODO</p>
<p>$values
@TODO
</md:method></p>
<p><md:method>
void public drawTable ( array $rows )</p>
<p>@TODO</p>
<p>$rows
@TODO
</md:method></p>
<h2 id="structures"><div class="in anchor">Структуры</div>

</h2>
<h3 id="structures/object-storage"><div class="in anchor">ObjectStorage <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Structures/ObjectStorage.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#structures">Структуры</a></span></div>

</h3>
<p>```php:p
namespace PHPDaemon\Structures;
class ObjectStorage extends [SplObjectStorage](<a href="http://php.net/manual/class.splobjectstorage.php">http://php.net/manual/class.splobjectstorage.php</a>);</p>
<pre><code>
Данный класс предоставляет хранилище объектов с несколькими дополнительными методами

&gt; Можно создавать классы-наследники

#### methods # Методы

&lt;md:method&gt;
integer public each ( string $method, mixed $arg, ... )

Проходит по всем объектам, вызывая у каждого из них метод `:hc`$method` c заданными аргументами `:hc`$args` и возвращает количество объектов в хранилище

$method
вызываемый метод объекта

$arg, ...
аргументы
&lt;/md:method&gt;

&lt;md:method&gt;
void public removeAll ( object $obj = null )

Удаляет из текущего контейнера все объекты, которых нет в контейнере `:hc`$obj`

$obj
контейнер, содержащий элементы, которые должны остаться в текущем контейнере
&lt;/md:method&gt;

&lt;md:method&gt;
object public detachFirst ( )

Возвращает первый объект, удалив его из контейнера
&lt;/md:method&gt;

&lt;md:method&gt;
object public getFirst ( )

Возвращает первый объект контейнера
&lt;/md:method&gt;

### priority-queue-callbacks # PriorityQueueCallbacks #&gt; PriorityQueueCallbacks &lt;a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Structures/PriorityQueueCallbacks.php"&gt;&lt;i class="fa fa-github"&gt;&lt;/i&gt;&lt;/a&gt;

```php:p
namespace PHPDaemon\Structures;
class PriorityQueueCallbacks extends \[SplPriorityQueue](http://php.net/manual/class.splpriorityqueue.php);</code></pre>
<blockquote>
<p>Используется в <a target="_self" class="tpl-inlink" href="#network/client">Network/Client<i class="fa fa-caret-square-o-up"></i></a> для хранения вызовов, пока все доступные соединения заняты</p>
</blockquote>
<h4 id="structures/object-storage/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#structures/object-storage">ObjectStorage <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Structures/ObjectStorage.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#structures">Структуры</a></span></div>

</h4>
<p><md:method>
void public enqueue ( callable $cb, integer $pri = 0 )</p>
<p>Добавляет функцию обратного вызова в очередь и пересортирует её</p>
<p>$cb
функция обратного вызова</p>
<p>$pri
приоритет
</md:method></p>
<p><md:method>
void public insert ( callable $cb, integer $pri = 0 )</p>
<p>Псевдоним метода <code>:hc</code>enqueue`
</md:method></p>
<p><md:method>
CallbackWrapper public dequeue ( )</p>
<p>Извлекает функцию обратного вызова из начала очереди и пересортирует её. Псевдоним метода <code>:hc</code>SplPriorityQueue::extract`
</md:method></p>
<p><md:method>
boolean public executeOne ( mixed $arg, ... )</p>
<p>Извлекает первую из начала очереди функцию обратного вызова и выполняет её с переданными аргументами. Возвращает <code>false</code> если очередь пуста</p>
<p>$arg, ...
аргументы
</md:method></p>
<p><md:method>
integer public executeAll ( mixed $arg, ... )</p>
<p>Извлекает и выполняет все функции обратного вызова в очереди с переданными аргументами. Возвращает количество выполненных функций обратного вызова</p>
<p>$arg, ...
аргументы
</md:method></p>
<h3 id="structures/stack-callbacks"><div class="in anchor">StackCallbacks <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Structures/StackCallbacks.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#structures">Структуры</a></span></div>

</h3>
<p>```php:p
namespace PHPDaemon\Structures;
class StackCallbacks extends [SplStack](<a href="http://php.net/manual/class.splstack.php">http://php.net/manual/class.splstack.php</a>);</p>
<pre><code>
Данный класс предоставляет стек функций обратного вызова с несколькими дополнительными методами

&gt; Используется в &lt;a target="_self" class="tpl-inlink" href="#network/client"&gt;Network/Client&lt;i class="fa fa-caret-square-o-up"&gt;&lt;/i&gt;&lt;/a&gt; для хранения стека функций обратного вызова запросов

#### methods # Методы

&lt;md:method&gt;
void public push ( callable $cb )

Добавляет функцию обратного вызова в конец стека

$cb
функция
&lt;/md:method&gt;

&lt;md:method&gt;
void public unshift ( callable $cb )

Добавляет функцию обратного вызова в начало стека

$cb
функция
&lt;/md:method&gt;

&lt;md:method&gt;
boolean public executeOne ( mixed $arg, ... )

Извлекает первую функцию обратного вызова из начала стека и выполняет её с переданными аргументами. Возвращает `false` если стек пуст

$arg
аргументы
&lt;/md:method&gt;

&lt;md:method&gt;
boolean public executeAndKeepOne ( mixed $arg, ... )

Выполяет первую функцию обратного вызова из начала стека с переданными аргументами без извлечения её из стека. Возвращает `false` если стек пуст

$arg, ...
аргументы
&lt;/md:method&gt;

&lt;md:method&gt;
integer public executeAll ( mixed $arg, ... )

Извлекает все функции обратного вызова и выполняет с заданными аргументами. Возвращает количество выполненных функций.

$arg1, ...
аргументы
&lt;/md:method&gt;

&lt;md:method&gt;
array public toArray ( )

Возвращает индексный массив стека
&lt;/md:method&gt;

&lt;md:method&gt;
void public reset ( )

Удаляет все элементы из стека
&lt;/md:method&gt;

## traits # Примеси

Примеси (англ. traits). &lt;a target="_blank" class="tpl-outlink" href="http://php.net/traits"&gt;&lt;i class="fa fa-external-link"&gt;&lt;/i&gt;&lt;/a&gt;

Данный раздел описывает доступные для разработчиков встроенные примеси.

### class-watchdog # ClassWatchdog #&gt; ClassWatchdog &lt;a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Traits/ClassWatchdog.php"&gt;&lt;i class="fa fa-github"&gt;&lt;/i&gt;&lt;/a&gt;

```php
namespace PHPDaemon\Traits;
trait ClassWatchdog;</code></pre>
<blockquote>
<p>Данная примесь уже использована во всех базовых классах и при наследовании от них не нужно использовать её повторно.</p>
</blockquote>
<p>Эта примесь нужна, чтобы предотвратить появление ошибки уровня E_ERROR (Fatal error) при обращении к несуществующему методу. E_ERROR же прерывает работу всего рабочего процесса, что недопустимо в реалиях phpDaemon. Настоятельно рекомендуется к использованию во всех используемых классах.</p>
<p>Определены следующие <a target="_blank" class="tpl-outlink" href="http://php.net/language.oop5.magic">магические методы<i class="fa fa-external-link"></i></a>:</p>
<p>-.n.ti <code>__call</code> — бросает исключение UndefinedMethodCalled
-.n.ti <code>__callStatic</code> — бросает исключение UndefinedMethodCalled</p>
<h3 id="structures/static-object-watchdog"><div class="in anchor">StaticObjectWatchdog <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Traits/StaticObjectWatchdog.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#structures">Структуры</a></span></div>

</h3>
<pre><code class="language-php">namespace PHPDaemon\Traits;
trait StaticObjectWatchdog;</code></pre>
<blockquote>
<p>Данная примесь уже использована во всех базовых классах и при наследовании от них не нужно использовать её повторно.</p>
</blockquote>
<p>PHP-машина умеет хранить набор свойств объекта двумя способами: в виде фиксированного массива и в виде ассоциативной таблицы (англ. hash table) с использованием <a target="_blank" class="tpl-outlink" href="http://ru.wikipedia.org/wiki/B-дерево">B-дерева<i class="fa fa-external-link"></i></a>. Изначально, при создании любого объекта, свойства хранятся в виде массива с быстрым доступом. При первой попытке установить значение свойства не объявленного директивой <code>&lt;i&gt;visibility&lt;/i&gt; $&lt;i&gt;name&lt;/i&gt;</code>, набор свойств конвертируется в ассоциативную таблицу. То же самое происходит при удалении (<a target="_blank" class="tpl-outlink" href="http://php.net/unset">unset<i class="fa fa-external-link"></i></a>) любого свойства). Данная операция сама по себе не самая быстрая, особенно при большом количестве свойств), но и доступ к свойствам после неё замедляется. Разумеется, есть объекты с намеренно динамическим набором свойств, которые сродни ассоциативным массивам и с ними всё в порядке. Но часто бывает так, что программист забывает добавить объявление свойства или даже опечатывается в его названии. Порой это ведёт к сильному ухудшению производительности, которое трудно расследовать.</p>
<blockquote>
<p>Прежде чем говорить, что PHP медленный, неплохо бы научиться его готовить.</p>
</blockquote>
<p>Данная примесь определяет следующие магические методы:</p>
<p>-.n.ti <code>__set</code> — пишет в журнал с префиксом <code>[CODE WARN]</code> при попытке записать значение несуществующего или недоступного из этой области видимости свойства. 
-.n.ti <code>__unset</code> — пишет в журнал с префиксом <code>[CODE WARN]</code> при попытке удалить свойство.</p>
<h3 id="structures/strict-static-object-watchdog"><div class="in anchor">StrictStaticObjectWatchdog <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Traits/StrictStaticObjectWatchdog.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#structures">Структуры</a></span></div>

</h3>
<pre><code class="language-php">namespace PHPDaemon\Traits;
trait StrictStaticObjectWatchdog;</code></pre>
<p>Поведение аналогично <a target="_self" class="tpl-inlink" href="#../static-object-watchdog">StaticObjectWatchdog<i class="fa fa-caret-square-o-up"></i></a>, но эта примесь бросает исключение, вместо записи в журнал.</p>
<p>Определяет следующие магические методы:</p>
<p>-.n.ti <code>__set</code> — бросает исключение UndefinedPropertySetting при попытке записать значение несуществующего или недоступного из этой области видимости свойства. 
-.n.ti <code>__unset</code> — бросает исключение UnsettingProperty при попытке удалить свойство.</p>
<h3 id="structures/deferred-event-handlers"><div class="in anchor">DeferredEventHandlers <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Traits/DeferredEventHandlers.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#structures">Структуры</a></span></div>

</h3>
<pre><code class="language-php">namespace PHPDaemon\Traits;
trait DeferredEventHandlers;</code></pre>
<p>Данная примесь реализует механизм отложенных событий в объекте.</p>
<pre><code class="language-php">class MyClass {
    use \PHPDaemon\Traits\DeferredEventHandlers;
    protected function onSomethingEvent($foo, $bar) {
        return function($ev) {
            list ($foo, $bar = $ev-&gt;args;
            $ev-&gt;setResult("Foo is $foo, bar is $bar");
        };
    }
}
$o = new MyClass;
$o-&gt;onSomething(function($ev) {
    D($ev-&gt;result);
    // Foo is fooo, bar is barr
}, 'foo', 'barr');

$o-&gt;onSomething(function($ev) {
    D($ev-&gt;result);
    // Foo is fooo, bar is barr
});</code></pre>
<blockquote>
<p>При этом когда результат уже установлен, производящее его замыкание не будет вызвано повторно.
Не нужно беспокоиться о повторном вызове еще до того как результат установлен, ожидающие замыкания будут вызваны правильно.</p>
</blockquote>
<h3 id="structures/event-handlers"><div class="in anchor">EventHandlers <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Traits/EventHandlers.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#structures">Структуры</a></span></div>

</h3>
<pre><code class="language-php">namespace PHPDaemon\Traits;
trait EventHandlers;</code></pre>
<p>Данная примесь реализует простой механизм PUB/SUB для объекта.</p>
<pre><code class="language-php">class MyClass {
    use \PHPDaemon\Traits\EventHandlers;
}
$o = new MyClass;

$o-&gt;on('smth', function($o, $foo, $bar) {
    D("Foo is $foo, bar is $bar");
});

$o-&gt;trigger('smth', 'foo', 'barr');
</code></pre>
<blockquote>
<p>Не забывайте о том, что при удалении такого объекта необходимо вызвать метод <code>cleanupEventHandlers()</code>, чтобы избежать утечек памяти.</p>
</blockquote>
<h3 id="structures/sessions"><div class="in anchor">Sessions <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Traits/Sessions.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#structures">Структуры</a></span></div>

</h3>
<pre><code class="language-php">namespace PHPDaemon\Traits;
trait Sessions;</code></pre>
<p>Эта примесь реализует механизм сессий, именно реализует, а не является оберткой над <code>session_*</code> функциями.</p>
<p>Почему мы не можем использовать нативный механизм сессий PHP?</p>
<p>-.n <strong>Проблема №1:</strong> В долго живущих процессах(обслуживающих больше одного клиента) суперглобальный массив <code>$_SESSION</code> не будет создаваться заново.<br />
-.n <strong>Проблема №2:</strong> Нативная реализация сессий является блокируюей, что расходится с идеологией PhpDaemon - обеспечить неблокирующий I/O.</p>
<p>Как и нативная реализация, поведение сессий основывается на <code>php.ini</code>.</p>
<p>Текущая реализация поддерживает хранение сессий в файлах, <code>session.serialize_handler = php|php_binary</code>, lock <code>r+!</code> файлов - аналогичный нативному - для предотвращения race condition.</p>
<p>Вы можете безопасно использовать PhpDaemon c существующими сессиями, сериализация совместима с нативной
(См. <a target="_blank" class="tpl-outlink" href="http://php.net//manual/ru/function.session-encode.php">session_encode<i class="fa fa-external-link"></i></a>, <a target="_blank" class="tpl-outlink" href="http://php.net//manual/ru/function.session-decode.php">session_decode<i class="fa fa-external-link"></i></a>).</p>
<p>Пример использования:</p>
<pre><code class="language-php">$this-&gt;onSessionStart(function ($event) {
    if (!$event-&gt;getResult()) {
        //Session open failed
    }
    //Session open succeed
});</code></pre>
<blockquote>
<p>Данная примесь используется в <a target="_self" class="tpl-inlink" href="#HTTPRequest">HTTPRequest<i class="fa fa-caret-square-o-up"></i></a> и <a target="_self" class="tpl-inlink" href="#servers/websocket/route">Servers\WebSocket\Route<i class="fa fa-caret-square-o-up"></i></a></p>
</blockquote>
<h3 id="structures/dnode"><div class="in anchor">DNode <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/WebSocket/Traits/DNode.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#structures">Структуры</a></span></div>

</h3>
<p><code>:hp</code>trait \PHPDaemon\WebSocket\Traits\DNode`</p>
<p>Данная примесь применима в классах-наследниках  <a target="_self" class="tpl-inlink" href="#servers/websocket/route">Servers\WebSocket\Route<i class="fa fa-caret-square-o-up"></i></a></p>
<p>Примесь реализует серверную часть протокола <a target="_blank" class="tpl-outlink" href="https://github.com/substack/dnode">DNode<i class="fa fa-external-link"></i></a>, который служит для <a target="_blank" class="tpl-outlink" href="http://ru.wikipedia.org/wiki/Удалённый_вызов_процедур">Удалённого вызова процедур<i class="fa fa-external-link"></i></a> (RPC).</p>
<p>Для подключение примеси нужно внести <code>:hp</code>use \PHPDaemon\WebSocket\Traits\DNode` в определение своего класса-наследника <a target="_self" class="tpl-inlink" href="#servers/websocket/route">Servers\WebSocket\Route<i class="fa fa-caret-square-o-up"></i></a>.</p>
<p>Затем необходимо определить методы, доступные клиенту. Фактически это делает метод <a target="_self" class="tpl-inlink" href="#traits/dnode/methods/defineLocalMethods">defineLocalMethods<i class="fa fa-caret-square-o-up"></i></a>, который должен вызываться в <a target="_self" class="tpl-inlink" href="#servers/websocket/route/methods/onHandshake">onHandshake<i class="fa fa-caret-square-o-up"></i></a>.</p>
<p>Давайте, для примера, создадим метод <code>dummy</code> с аргументами <code>:hc</code>$foo<code>,</code>:hc<code>$bar</code> и <code>:hc</code>$callback`:</p>
<pre><code class="language-php">protected function dummyMethod($foo, $bar, $callback) {
    if (!static::ensureCallback($callback)) {
        /* $callback не содержит функцию обратного вызова */
        return;
    }
    $callback(md5($foo ^ $bar));
}</code></pre>
<p>При обращении <code>:h</code>dummy('Hello', 'World', function(result) {...})<code>ответом будет вызов этой функции с аргументом</code>bd7815679056a50c3f545b159ce5e385<code>— результатом выполнения</code>:h<code>md5('Hello' ^ 'World')</code></p>
<p>В качестве аргументов можно передавать передавать собственные функции обратного вызова, но учтите, что они удаляются  из памяти после вызова, если возвратное значение не является <code>:hc</code>true<code>. Таким образом, следует понимать ожидается ли повторный вызов, и в этом случае возвращать</code>:hc<code>true</code>. Это делается во избежание утечек памяти.</p>
<p>Для вызова удаленного метода по имени, используйте <a target="_self" class="tpl-inlink" href="#traits/dnode/methods/callRemote">callRemote<i class="fa fa-caret-square-o-up"></i></a>.</p>
<blockquote>
<p>Как вы могли заметить, пример <code>dummyMethod</code> использует вызов <code>:h</code>static::ensureCallback($callback)`. Всегда нужно проверять переданный аргумент с помощью <a target="_self" class="tpl-inlink" href="#traits/dnode/methods/ensureCallback">ensureCallback<i class="fa fa-caret-square-o-up"></i></a> перед его исполнением. В противном случае, это обернётся серьёзной брешью безопасности.</p>
</blockquote>
<h4 id="structures/dnode/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#structures/dnode">DNode <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/WebSocket/Traits/DNode.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#structures">Структуры</a></span></div>

</h4>
<p><md:method>
void public onHandshake ( )</p>
<p>Default onHandshake() method
</md:method></p>
<p><md:method>
<a href="#../">DNode</a> public callLocal ( )</p>
<p>Вызывает локальный метод
</md:method></p>
<p><md:method>
void protected extractCallbacks ( array &amp;$args, array &amp;$list, array &amp;$path )</p>
<p>Извлекает функции обратного вызова из массива аргуметнов</p>
<p>&amp;$args
Аргументы</p>
<p>&amp;$list
Выходной массив для свойства 'callbacks'</p>
<p>&amp;$path
Текущий путь
</md:method></p>
<p><md:method>
<a href="#../">DNode</a> public callRemote ( )</p>
<p>Вызов удаленного метода
</md:method></p>
<p><md:method>
<a href="#../">DNode</a> public callRemoteArray ( string $method, array $args )</p>
<p>Вызов удаленного метода с передачей аргументов массивом</p>
<p>$method
Название метода</p>
<p>$args
Аргументы
</md:method></p>
<p><md:method>
void protected methodsMethod ( array $methods )</p>
<p>Обработчик метода <code>methods</code></p>
<p>$methods
Ассоциативный массив методов
</md:method></p>
<p><md:method>
void public toJsonDebugResursive ( mixed &amp;$m )</p>
<p>Обработчик рекурсии для метода <a target="_self" class="tpl-inlink" href="#../toJsonDebug">toJsonDebug<i class="fa fa-caret-square-o-up"></i></a></p>
<p>&amp;$m
Значение
</md:method></p>
<p><md:method>
string string public toJsonDebug ( mixed $m )</p>
<p>Возвращает JSON-представление массива в отладочных целях</p>
<p>$m
Значение
</md:method></p>
<p><md:method>
void public onFinish ( )</p>
<p>Вызывается когда сессия завершена
</md:method></p>
<p><md:method>
void public cleanup ( )</p>
<p>Очищает внутренние структуры
</md:method></p>
<p><md:method>
mixed public __call ( string $m, array $args )</p>
<p>Магический метод __call</p>
<p>$m
Название метода</p>
<p>$args
Аргументы
</md:method></p>
<p><md:method>
void public onPacket ( array $pct )</p>
<p>Вызывается когда получен пакет</p>
<p>$pct
Data
</md:method></p>
<p><md:method>
void public onFrame ( string $data, string $type )</p>
<p>Вызывется когда получен фрейм</p>
<p>$data
Содержимое фрейма</p>
<p>$type
Тип фрейма
</md:method></p>
<h2 id="network"><div class="in anchor">Сеть</div>

</h2>
<h3 id="network/pool"><div class="in anchor">Пул <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Network/Pool.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#network">Сеть</a></span></div>

</h3>
<p>```php:p
namespace PHPDaemon\Network;
abstract class Pool extends <a href="#structures/object-storage">ObjectStorage</a>;</p>
<pre><code>
Хранит в себе активные объекты &lt;a target="_self" class="tpl-inlink" href="#network/connection"&gt;Соединение&lt;i class="fa fa-caret-square-o-up"&gt;&lt;/i&gt;&lt;/a&gt; и &lt;a target="_self" class="tpl-inlink" href="#network/boundsocket"&gt;ОткрытыйСокет&lt;i class="fa fa-caret-square-o-up"&gt;&lt;/i&gt;&lt;/a&gt;.

Пул (клиент или сервер) можно инстанцировать из пользовательского приложении, например:

```php
$this-&gt;httpclient = \PHPDaemon\Clients\HTTP\Pool::getInstance();</code></pre>
<p>или</p>
<pre><code class="language-php">/* ... */
$this-&gt;pool = \PHPDaemon\Servers\FlashPolicy\Pool::getInstance([
    'listen' =&gt; 'tcp://0.0.0.0:843'
]);
$this-&gt;pool-&gt;onReady();
/* ... */</code></pre>
<p>Но не забывайте отправлять ему onReady(), onShutdown() и onConfigUpdated() события.</p>
<p>В большинстве случаев сервер запускается одноименнным приложением Pool.</p>
<pre><code class="language-ruby"># контекст для ssl соединения (опционально)
TransportContext:myContext {
    ssl;
    certFile "/path/to/cert.pem";
    pkFile "/path/to/privkey.pem";
    passphrase "";
    verifyPeer true;
    allowSelfSigned true;
}

# слушаем 80 и 443 порт
Pool:HTTPServer {
    listen "tcp://0.0.0.0:80", "tcp://0.0.0.0:443##myContext";
    port 80;
    privileged;
    maxconcurrency 1;
}</code></pre>
<h4 id="network/pool/properties"><div class="in anchor">Свойства<span class="header-path"> <i>&larr;</i> <a href="#network/pool">Пул <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Network/Pool.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#network">Сеть</a></span></div>

</h4>
<p><md:prop>
string public $connectionClass;
Default connection class
</md:prop></p>
<p><md:prop>
string public $name;
Name
</md:prop></p>
<p><md:prop>
\PHPDaemon\Config\Section public $config;
Configuration
</md:prop></p>
<p><md:prop>
integer public $maxConcurrency = 0;
Max concurrency
</md:prop></p>
<p><md:prop>
integer public $maxAllowedPacket = 0;
Max allowed packet
</md:prop></p>
<p><md:prop>
object public $appInstance;
Application instance object
</md:prop></p>
<h4 id="network/pool/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#network/pool">Пул <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Network/Pool.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#network">Сеть</a></span></div>

</h4>
<p><md:method>
public __construct ( array $config = [], boolean $init = true )</p>
<p>Constructor</p>
<p>$config
Config variables</p>
<p>$init
@TODO
</md:method></p>
<p><md:method>
public onReady ( )</p>
<p>Called when the worker is ready to go
</md:method></p>
<p><md:method>
public onConfigUpdated ( )</p>
<p>Called when worker is going to update configuration
</md:method></p>
<p><md:method>
public static getInstance ( string $arg = '', boolean $spawn = true )</p>
<p>Returns instance object</p>
<p>$arg
name / array config / ConfigSection</p>
<p>$spawn
Spawn? Default is true
</md:method></p>
<p><md:method>
public setConnectionClass ( string $class )</p>
<p>Sets default connection class</p>
<p>$class
String name
</md:method></p>
<p><md:method>
public enable ( )</p>
<p>Enable socket events
</md:method></p>
<p><md:method>
public disable ( )</p>
<p>Disable all events of sockets
</md:method></p>
<p><md:method>
public onShutdown ( boolean $graceful = false )</p>
<p>Called when application instance is going to shutdown</p>
<p>$graceful
graceful
</md:method></p>
<p><md:method>
public finish ( boolean $graceful = false )</p>
<p>Finishes ConnectionPool</p>
<p>$graceful
graceful
</md:method></p>
<p><md:method>
public attach ( <a href="#../../connection">Connection</a> $conn, $inf = null )</p>
<p>Attach Connection</p>
<p>$conn
Connection</p>
<p>$inf
Info
</md:method></p>
<p><md:method>
public detach ( <a href="#../../connection">Connection</a> $conn )</p>
<p>Detach Connection</p>
<p>$conn
Connection
</md:method></p>
<p><md:method>
public connect ( string $url, callable $cb, string $class = null )</p>
<p>Establish a connection with remote peer</p>
<p>$url
URL</p>
<p>$cb
Optional. Callback</p>
<p>$class
Optional. Connection class name
</md:method></p>
<h3 id="network/client"><div class="in anchor">Client <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Network/Client.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#network">Сеть</a></span></div>

</h3>
<p>```php:p
namespace PHPDaemon\Network;
abstract class Client extends <a href="#../pool">Pool</a>;</p>
<pre><code>
@TODO

#### methods # Методы

&lt;md:method&gt;
void public addServer ( string $url, integer $weight = NULL )

Adds server

$url
Server URL

$weight
Weight
&lt;/md:method&gt;

&lt;md:method&gt;
boolean public getConnection ( string $url = null, callable $cb = null, integer $pri = 0 )

Returns available connection from the pool

$url
Address

$cb
onConnected

$pri
Optional. Priority.
&lt;/md:method&gt;

&lt;md:method&gt;
void public detach ( [Connection](#../../connection) $conn )

Detach Connection

$conn
Connection
&lt;/md:method&gt;

&lt;md:method&gt;
void public markConnFree ( [ClientConnection](#../../clientconnection) $conn, string $url )

Mark connection as free

$conn
Connection

$url
URL
&lt;/md:method&gt;

&lt;md:method&gt;
void public markConnBusy ( [ClientConnection](#../../clientconnection) $conn, string $url )

Mark connection as busy

$conn
Connection

$url
URL
&lt;/md:method&gt;

&lt;md:method&gt;
void public detachConnFromUrl ( [ClientConnection](#../../clientconnection) $conn, string $url )

Detaches connection from URL

$conn
Connection

$url
URL
&lt;/md:method&gt;

&lt;md:method&gt;
void public touchPending ( string $url )

Touch pending "requests for connection"

$url
URL
&lt;/md:method&gt;

&lt;md:method&gt;
boolean public getConnectionByKey ( string $key, callable $cb = null )

Returns available connection from the pool by key

$key
Key

$cb
Callback
&lt;/md:method&gt;

&lt;md:method&gt;
boolean public getConnectionRR ( callable $cb = null )

Returns available connection from the pool

$cb
Callback
&lt;/md:method&gt;

&lt;md:method&gt;
boolean public requestByServer ( string $server, string $data, callable $onResponse = null )

Sends a request to arbitrary server

$server
Server

$data
Request

$onResponse
Callback called when the request complete
&lt;/md:method&gt;

&lt;md:method&gt;
boolean public requestByKey ( string $key, string $data, callable $onResponse = null )

Sends a request to server according to the key

$key
Key

$data
Request

$onResponse
Callback called when the request complete
&lt;/md:method&gt;

&lt;md:method&gt;
boolean public onShutdown ( boolean $graceful = false )

Called when application instance is going to shutdown

$graceful
@TODO
&lt;/md:method&gt;

### clientconnection # ClientConnection #&gt; ClientConnection &lt;a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Network/ClientConnection.php"&gt;&lt;i class="fa fa-github"&gt;&lt;/i&gt;&lt;/a&gt;

```php:p
namespace PHPDaemon\Network;
class ClientConnection extends [Connection](#../connection);</code></pre>
<p>@TODO</p>
<h4 id="network/client/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#network/client">Client <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Network/Client.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#network">Сеть</a></span></div>

</h4>
<p><md:method>
void public __construct ( resource $fd, object $pool = null )</p>
<p>Constructor</p>
<p>$fd
File descriptor</p>
<p>$pool
ConnectionPool
</md:method></p>
<p><md:method>
boolean public isBusy ( )</p>
<p>Busy?
</md:method></p>
<p><md:method>
void public onResponse ( callable $cb )</p>
<p>Push callback to onReponse stack</p>
<p>$cb
callable
</md:method></p>
<p><md:method>
void public onReady ( )</p>
<p>Called when the connection is handshaked (at low-level), and peer is ready to recv. data
</md:method></p>
<p><md:method>
void public setFree ( boolean $free = true )</p>
<p>Set connection free/busy</p>
<p>$free
Free?
</md:method></p>
<p><md:method>
void public release ( )</p>
<p>Set connection free
</md:method></p>
<p><md:method>
void public checkFree ( )</p>
<p>Set connection free/busy according to onResponse emptiness and ->finished
</md:method></p>
<p><md:method>
integer public getQueueLength ( )</p>
<p>@TODO
</md:method></p>
<p><md:method>
boolean public isQueueEmpty ( )</p>
<p>@TODO
</md:method></p>
<p><md:method>
void public onFinish ( )</p>
<p>Called when connection finishes
</md:method></p>
<h3 id="network/connection"><div class="in anchor">Connection <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Network/Connection.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#network">Сеть</a></span></div>

</h3>
<p>```php:p
namespace PHPDaemon\Network;
abstract class Connection extends <a href="#../iostream">IOStream</a>;</p>
<pre><code>
@TODO

#### methods # Методы

&lt;md:method&gt;
boolean public isConnected ( )

Connected?
&lt;/md:method&gt;

&lt;md:method&gt;
void public setDgram ( boolean $bool )

Sets DGRAM mode

$bool
@TODO
&lt;/md:method&gt;

&lt;md:method&gt;
void public setPeername ( string $host, integer $port )

Sets peer name

$host
Hostname

$port
Port
&lt;/md:method&gt;

&lt;md:method&gt;
mixed public __get ( string $name )

Getter

$name
Name
&lt;/md:method&gt;

&lt;md:method&gt;
void public getSocketName ( string &amp;$addr, string &amp;$port )

Get socket name

&amp;$addr
Addr

&amp;$port
Port
&lt;/md:method&gt;

&lt;md:method&gt;
void public setParentSocket ( \PHPDaemon\BoundSocket\Generic $sock )

Sets parent socket
&lt;/md:method&gt;

&lt;md:method&gt;
void public onUdpPacket ( @TODO $pct )

Called when new UDP packet received

$pct
@TODO
&lt;/md:method&gt;

&lt;md:method&gt;
void public onReady ( )

Called when the connection is handshaked (at low-level), and peer is ready to recv. data
&lt;/md:method&gt;

&lt;md:method&gt;
void public onInheritanceFromRequest ( object $req )

Called if we inherit connection from request

$req
Parent Request
&lt;/md:method&gt;

&lt;md:method&gt;
void public onFailure ( )

Called when the connection failed to be established
&lt;/md:method&gt;

&lt;md:method&gt;
void public onFailureEv ( \EventBufferEvent $bev = null )

Called when the connection failed

$bev
@TODO
&lt;/md:method&gt;

&lt;md:method&gt;
void public __destruct ( )

Destructor
&lt;/md:method&gt;

&lt;md:method&gt;
boolean public write ( string $data )

Send data to the connection. Note that it just writes to buffer that flushes at every baseloop

$data
Data to send
&lt;/md:method&gt;

&lt;md:method&gt;
void public onConnected ( callable $cb )

Executes the given callback when/if the connection is handshaked

$cb
callable
&lt;/md:method&gt;

&lt;md:method&gt;
string public getUrl ( )

Get URL
&lt;/md:method&gt;

&lt;md:method&gt;
string public getHost ( )

Get host
&lt;/md:method&gt;

&lt;md:method&gt;
integer public getPort ( )

Get port
&lt;/md:method&gt;

&lt;md:method&gt;
boolean public connect ( string $url, callable $cb = null )

Connects to URL

$url
URL

$cb
Callback
&lt;/md:method&gt;

&lt;md:method&gt;
boolean public connectUnix ( string $path )

Establish UNIX socket connection

$path
Path
&lt;/md:method&gt;

&lt;md:method&gt;
boolean public connectRaw ( string $host )

Establish raw socket connection

$host
Host
&lt;/md:method&gt;

&lt;md:method&gt;
boolean public connectUdp ( string $host, integer $port )

Establish UDP connection

$host
Hostname

$port
Port
&lt;/md:method&gt;

&lt;md:method&gt;
boolean public connectTcp ( string $host, integer $port )

Establish TCP connection

$host
Hostname

$port
Port
&lt;/md:method&gt;

&lt;md:method&gt;
void public setKeepalive ( boolean $bool )

Set keepalive

$bool
@TODO
&lt;/md:method&gt;

&lt;md:method&gt;
void public close ( )

Close the connection
&lt;/md:method&gt;

&lt;md:method&gt;
void public setTimeouts ( integer $read, integer $write )

Set timeouts

$read
Read timeout in seconds

$write
Write timeout in seconds
&lt;/md:method&gt;

&lt;md:method&gt;
void public setOption ( integer $level, integer $optname, mixed $val )

Set socket option

$level
Level

$optname
Option

$val
Value
&lt;/md:method&gt;

&lt;md:method&gt;
void public onFinish ( )

Called when connection finishes
&lt;/md:method&gt;

### iostream # IOStream #&gt; IOStream &lt;a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Network/IOStream.php"&gt;&lt;i class="fa fa-github"&gt;&lt;/i&gt;&lt;/a&gt;

```php
namespace PHPDaemon\Network;
abstract class IOStream;</code></pre>
<p>@TODO</p>
<h4 id="network/connection/properties"><div class="in anchor">Свойства<span class="header-path"> <i>&larr;</i> <a href="#network/connection">Connection <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Network/Connection.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#network">Сеть</a></span></div>

</h4>
<p><md:prop>
ConnectionPool public $pool;
Associated pool
</md:prop></p>
<p><md:prop>
</md:prop></p>
<h4 id="network/connection/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#network/connection">Connection <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Network/Connection.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#network">Сеть</a></span></div>

</h4>
<p><md:method>
void public __construct ( resource $fd = null, object $pool = null )</p>
<p>IOStream constructor</p>
<p>$fd
File descriptor. Optional.</p>
<p>$pool
Pool. Optional.
</md:method></p>
<p><md:method>
mixed public __get ( string $name )</p>
<p>Getter</p>
<p>$name
Name
</md:method></p>
<p><md:method>
boolean public isFreed ( )</p>
<p>Freed?
</md:method></p>
<p><md:method>
boolean public isFinished ( )</p>
<p>Finished?
</md:method></p>
<p><md:method>
\EventBufferEvent public getBev ( )</p>
<p>Get EventBufferEvent
</md:method></p>
<p><md:method>
resource public getFd ( )</p>
<p>Get file descriptor
</md:method></p>
<p><md:method>
void public setContext ( object $ctx, integer $mode )</p>
<p>Sets context mode</p>
<p>$ctx
Context</p>
<p>$mode
Mode
</md:method></p>
<p><md:method>
void public setFd ( resource $fd, \EventBufferEvent $bev = null )</p>
<p>Sets fd</p>
<p>$fd
File descriptor</p>
<p>$bev
EventBufferEvent
</md:method></p>
<p><md:method>
void public setTimeout ( integer $rw )</p>
<p>Set timeout</p>
<p>$rw
Timeout
</md:method></p>
<p><md:method>
void public setTimeouts ( integer $read, integer $write )</p>
<p>Set timeouts</p>
<p>$read
Read timeout in seconds</p>
<p>$write
Write timeout in seconds
</md:method></p>
<p><md:method>
void public setPriority ( integer $p )</p>
<p>Sets priority</p>
<p>$p
Priority
</md:method></p>
<p><md:method>
void public setWatermark ( integer $low = null, integer $high = null )</p>
<p>Sets watermark</p>
<p>$low
Low</p>
<p>$high
High
</md:method></p>
<p><md:method>
string public readLine ( integer $eol = null )</p>
<p>Reads line from buffer</p>
<p>$eol
@TODO
</md:method></p>
<p><md:method>
boolean public drain ( integer $n )</p>
<p>Drains buffer</p>
<p>$n
Numbers of bytes to drain
</md:method></p>
<p><md:method>
boolean public drainIfMatch ( string $str )</p>
<p>Drains buffer it matches the string</p>
<p>$str
Data
</md:method></p>
<p><md:method>
string public lookExact ( integer $n, integer $o = 0 )</p>
<p>Reads exact $n bytes of buffer without draining</p>
<p>$n
Number of bytes to read</p>
<p>$o
Offset
</md:method></p>
<p><md:method>
boolean public prependInput ( string $str )</p>
<p>Prepends data to input buffer</p>
<p>$str
Data
</md:method></p>
<p><md:method>
boolean public prependOutput ( string $str )</p>
<p>Prepends data to output buffer</p>
<p>$str
Data
</md:method></p>
<p><md:method>
string public look ( integer $n, integer $o = 0 )</p>
<p>Read from buffer without draining</p>
<p>$n
Number of bytes to read</p>
<p>$o
Offset
</md:method></p>
<p><md:method>
string public substr ( integer $o, integer $n = -1 )</p>
<p>Read from buffer without draining</p>
<p>$o
Offset</p>
<p>$n
Number of bytes to read
</md:method></p>
<p><md:method>
integer public search ( string $what, integer $start = 0, integer $end = -1 )</p>
<p>Searches first occurence of the string in input buffer</p>
<p>$what
Needle</p>
<p>$start
Offset start</p>
<p>$end
Offset end
</md:method></p>
<p><md:method>
string public readExact ( integer $n )</p>
<p>Reads exact $n bytes from buffer</p>
<p>$n
Number of bytes to read
</md:method></p>
<p><md:method>
integer public getInputLength ( )</p>
<p>Returns length of input buffer
</md:method></p>
<p><md:method>
boolean public gracefulShutdown ( )</p>
<p>Called when the worker is going to shutdown
</md:method></p>
<p><md:method>
boolean public freezeInput ( boolean $at_front = false )</p>
<p>Freeze input</p>
<p>$at_front
At front. Default is true. If the front of a buffer is frozen, operations that drain data from the front of the buffer, or that prepend data to the buffer, will fail until it is unfrozen. If the back a buffer is frozen, operations that append data from the buffer will fail until it is unfrozen.
</md:method></p>
<p><md:method>
boolean public unfreezeInput ( boolean $at_front = false )</p>
<p>Unfreeze input</p>
<p>$at_front
At front. Default is true. If the front of a buffer is frozen, operations that drain data from the front of the buffer, or that prepend data to the buffer, will fail until it is unfrozen. If the back a buffer is frozen, operations that append data from the buffer will fail until it is unfrozen.
</md:method></p>
<p><md:method>
boolean public freezeOutput ( boolean $at_front = true )</p>
<p>Freeze output</p>
<p>$at_front
At front. Default is true. If the front of a buffer is frozen, operations that drain data from the front of the buffer, or that prepend data to the buffer, will fail until it is unfrozen. If the back a buffer is frozen, operations that append data from the buffer will fail until it is unfrozen.
</md:method></p>
<p><md:method>
boolean public unfreezeOutput ( boolean $at_front = true )</p>
<p>Unfreeze output</p>
<p>$at_front
At front. Default is true. If the front of a buffer is frozen, operations that drain data from the front of the buffer, or that prepend data to the buffer, will fail until it is unfrozen. If the back a buffer is frozen, operations that append data from the buffer will fail until it is unfrozen.
</md:method></p>
<p><md:method>
void public onWrite ( )</p>
<p>Called when the connection is ready to accept new data
</md:method></p>
<p><md:method>
boolean public write ( string $data )</p>
<p>Send data to the connection. Note that it just writes to buffer that flushes at every baseloop</p>
<p>$data
Data to send
</md:method></p>
<p><md:method>
boolean public writeln ( string $data )</p>
<p>Send data and appending \n to connection. Note that it just writes to buffer flushed at every baseloop</p>
<p>$data
Data to send
</md:method></p>
<p><md:method>
void public finish ( )</p>
<p>Finish the session. You should not worry about buffers, they are going to be flushed properly.
</md:method></p>
<p><md:method>
void public close ( )</p>
<p>Close the connection
</md:method></p>
<p><md:method>
void public unsetFd ( )</p>
<p>Unsets pointers of associated EventBufferEvent and File descriptr
</md:method></p>
<p><md:method>
void public onReadEv ( \EventBufferEvent $bev )</p>
<p>Called when the connection has got new data</p>
<p>$bev
Bufferevent
</md:method></p>
<p><md:method>
void public onWriteOnce ( callable $cb )</p>
<p>Push callback which will be called only once, when writing is available next time</p>
<p>$cb
Callback
</md:method></p>
<p><md:method>
void public onWriteEv ( \EventBufferEvent $bev )</p>
<p>Called when the connection is ready to accept new data</p>
<p>$bev
Bufferedevent
</md:method></p>
<p><md:method>
void public onStateEv ( \EventBufferEvent $bev, integer $events )</p>
<p>Called when the connection state changed</p>
<p>$bev
Bufferevent</p>
<p>$events
Events
</md:method></p>
<p><md:method>
integer public moveToBuffer ( \EventBuffer $dest, integer $n )</p>
<p>Moves arbitrary number of bytes from input buffer to given buffer</p>
<p>$dest
Destination nuffer</p>
<p>$n
Max. number of bytes to move
</md:method></p>
<p><md:method>
integer public writeFromBuffer ( \EventBuffer $src, integer $n )</p>
<p>Moves arbitrary number of bytes from given buffer to output buffer</p>
<p>$src
Source buffer</p>
<p>$n
Max. number of bytes to move
</md:method></p>
<p><md:method>
string public read ( integer $n )</p>
<p>Read data from the connection's buffer</p>
<p>$n
Max. number of bytes to read
</md:method></p>
<p><md:method>
string public readUnlimited ( )</p>
<p>Reads all data from the connection's buffer
</md:method></p>
<h3 id="network/server"><div class="in anchor">Server <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Network/Server.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#network">Сеть</a></span></div>

</h3>
<p>```php:p
namespace PHPDaemon\Network;
abstract class Server extends <a href="#../pool">Pool</a>;</p>
<pre><code>
@TODO

#### properties # Свойства

&lt;md:prop&gt;
array public $allowedClients = null;
Allowed clients
&lt;/md:prop&gt;

&lt;md:prop&gt;
integer public $maxAllowedPacket;
@TODO
&lt;/md:prop&gt;

#### methods # Методы

&lt;md:method&gt;
void public __construct ( array $config = [], boolean $init = true )

Constructor

$config
Config variables

$init
@TODO
&lt;/md:method&gt;

&lt;md:method&gt;
boolean public finish ( boolean $graceful = false )

Finishes ConnectionPool

$graceful
@TODO
&lt;/md:method&gt;

&lt;md:method&gt;
integer public bindSockets ( mixed $addrs = [], integer $max = 0 )

Bind given sockets

$addrs
Addresses to bind

$max
Number of bound
&lt;/md:method&gt;

&lt;md:method&gt;
boolean public bindSocket ( string $uri )

Bind given socket

$uri
Address to bind
&lt;/md:method&gt;

&lt;md:method&gt;
void public attachBound ( \PHPDaemon\BoundSocket\Generic $bound, mixed $inf = null )

Attach Generic

$bound
Generic

$inf
Info
&lt;/md:method&gt;

&lt;md:method&gt;
void public detachBound ( \PHPDaemon\BoundSocket\Generic $bound )

Detach Generic

$bound
Generic
&lt;/md:method&gt;

&lt;md:method&gt;
void public closeBound ( )

Close each of binded sockets
&lt;/md:method&gt;

&lt;md:method&gt;
boolean public inheritFromRequest ( object $req, object $oldConn )

Called when a request to HTTP-server looks like another connection

$req
@TODO

$oldConn
@TODO
&lt;/md:method&gt;

## httprequest # HTTPRequest

### generic # Generic #&gt; Generic &lt;a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/HTTPRequest/Generic.php"&gt;&lt;i class="fa fa-github"&gt;&lt;/i&gt;&lt;/a&gt;

```php
namespace PHPDaemon\HTTPRequest;
abstract class Generic extends \PHPDaemon\Request\Generic;</code></pre>
<p>@TODO</p>
<h4 id="network/server/properties"><div class="in anchor">Свойства<span class="header-path"> <i>&larr;</i> <a href="#network/server">Server <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Network/Server.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#network">Сеть</a></span></div>

</h4>
<p><md:prop>
boolean public $keepalive = false;
@TODO
</md:prop></p>
<p><md:prop>
integer public $responseLength = 0;
Current response length
</md:prop></p>
<p><md:prop>
array public static $hvaltr = ['; ' => '&amp;', ';' => '&amp;', ' ' => '%20'];
Replacement pairs for processing some header values in parse_str()
</md:prop></p>
<p><md:prop>
array public static $htr = ['-' => '_'];
State
</md:prop></p>
<h4 id="network/server/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#network/server">Server <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/Network/Server.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#network">Сеть</a></span></div>

</h4>
<p><md:method>
void public firstDeferredEventUsed ( )</p>
<p>@TODO
</md:method></p>
<p><md:method>
boolean public sendfile ( string $path, callable $cb, integer $pri = EIO_PRI_DEFAULT )</p>
<p>Output whole contents of file</p>
<p>$path
Path</p>
<p>$cb
Callback</p>
<p>$pri
Priority
</md:method></p>
<p><md:method>
boolean public checkIfReady ( )</p>
<p>Called to check if Request is ready
</md:method></p>
<p><md:method>
integer public getUploadMaxSize ( )</p>
<p>Upload maximum file size
</md:method></p>
<p><md:method>
void public postPrepare ( )</p>
<p>Prepares the request body
</md:method></p>
<p><md:method>
boolean public ensureSentHeaders ( )</p>
<p>Ensure that headers are sent
</md:method></p>
<p><md:method>
boolean public out ( string $s, boolean $flush = true )</p>
<p>Output some data</p>
<p>$s
String to out</p>
<p>$flush
Flush
</md:method></p>
<p><md:method>
void public onParsedParams ( )</p>
<p>Called when request's headers parsed
</md:method></p>
<p><md:method>
boolean public combinedOut ( string $s )</p>
<p>Outputs data with headers (split by \r\n\r\n)</p>
<p>$s
String to out
</md:method></p>
<p><md:method>
void public chunked ( )</p>
<p>Use chunked encoding
</md:method></p>
<p><md:method>
void public onWakeup ( )</p>
<p>Called when the request wakes up
</md:method></p>
<p><md:method>
void public onSleep ( )</p>
<p>Called when the request starts sleep
</md:method></p>
<p><md:method>
boolean public status ( integer $code = 200 )</p>
<p>Send HTTP-status</p>
<p>$code
Code
</md:method></p>
<p><md:method>
boolean public headers_sent ( string &amp;$file, integer &amp;$line )</p>
<p>Checks if headers have been sent</p>
<p>&amp;$file
File name where output started in the file and line variables</p>
<p>&amp;$line
Line number where output started in the file and line variables
</md:method></p>
<p><md:method>
array public headers_list ( )</p>
<p>Return current list of headers
</md:method></p>
<p><md:method>
void public setcookie ( string $name, string $value = '', штеупук $maxage = 0, string $path = '', string $domain = '', boolean $secure = false, boolean $HTTPOnly = false )</p>
<p>Set the cookie</p>
<p>$name
Name of cookie</p>
<p>$value
Value</p>
<p>$maxage
Optional. Max-Age. Default is 0</p>
<p>$path
Optional. Path. Default is empty string</p>
<p>$domain
@TODO</p>
<p>$secure
Optional. Secure. Default is false</p>
<p>$HTTPOnly
Optional. HTTPOnly. Default is false
</md:method></p>
<p><md:method>
boolean public header ( string $s, boolean $replace = true, integer $code = false )</p>
<p>Send the header</p>
<p>$s
Header. Example: <code>Location: http://php.net/</code></p>
<p>$replace
Optional. Replace?</p>
<p>$code
Optional. HTTP response code
</md:method></p>
<p><md:method>
void public removeHeader ( string $s )</p>
<p>Removes a header</p>
<p>$s
Header name. Example: <code>Location</code>
</md:method></p>
<p><md:method>
integer public static parseSize ( string $value )</p>
<p>Converts human-readable representation of size to number of bytes</p>
<p>$value
Data
</md:method></p>
<p><md:method>
void public onUploadFileStart ( <a href="#../input">Input</a> $in )</p>
<p>Called when file upload started</p>
<p>$in
Input
</md:method></p>
<p><md:method>
void public onUploadFileChunk ( <a href="#../input">Input</a> $in, boolean $last = false )</p>
<p>Called when chunk of incoming file has arrived</p>
<p>$in
Input</p>
<p>$last
Last?
</md:method></p>
<p><md:method>
string public getUploadTempDir ( )</p>
<p>@TODO
</md:method></p>
<p><md:method>
boolean public isUploadedFile ( string $path )</p>
<p>Tells whether the file was uploaded via HTTP POST</p>
<p>$path
The filename being checked
</md:method></p>
<p><md:method>
boolean public moveUploadedFile ( string $filename, string $dest )</p>
<p>Moves an uploaded file to a new location</p>
<p>$filename
The filename of the uploaded file</p>
<p>$dest
The destination of the moved file
</md:method></p>
<p><md:method>
boolean public readBodyFile ( )</p>
<p>Read request body from the file given in REQUEST_BODY_FILE parameter
</md:method></p>
<p><md:method>
void public static parse_str ( string $s, array &amp;$var, boolean $header = false )</p>
<p>Replacement for default parse_str(), it supoorts UCS-2 like this: %uXXXX</p>
<p>$s
String to parse</p>
<p>&amp;$var
Reference to the resulting array</p>
<p>$header
Header-style string
</md:method></p>
<h3 id="network/input"><div class="in anchor">Input <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/HTTPRequest/Input.php"><i class="fa fa-github"></i></a><span class="header-path"> <i>&larr;</i> <a href="#network">Сеть</a></span></div>

</h3>
<pre><code class="language-php">namespace PHPDaemon\HTTPRequest;
class Input extends \EventBuffer;</code></pre>
<p>@TODO</p>
<h4 id="network/input/properties"><div class="in anchor">Свойства<span class="header-path"> <i>&larr;</i> <a href="#network/input">Input <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/HTTPRequest/Input.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#network">Сеть</a></span></div>

</h4>
<p><md:prop>
array public $curPart;
Current Part
</md:prop></p>
<p><md:prop>
</md:prop></p>
<h4 id="network/input/methods"><div class="in anchor">Методы<span class="header-path"> <i>&larr;</i> <a href="#network/input">Input <a target="_blank" class="tpl-git" href="https://github.com/kakserpom/phpdaemon/tree/master/PHPDaemon/HTTPRequest/Input.php"><i class="fa fa-github"></i></a></a> <i>&larr;</i> <a href="#network">Сеть</a></span></div>

</h4>
<p><md:method>
void public setBoundary ( string $boundary )</p>
<p>Set boundary</p>
<p>$boundary
@TODO
</md:method></p>
<p><md:method>
void public freeze ( boolean $at_front = false )</p>
<p>Freeze input</p>
<p>$at_front
At front. Default is true. If the front of a buffer is frozen, operations that drain data from the front of the buffer, or that prepend data to the buffer, will fail until it is unfrozen. If the back a buffer is frozen, operations that append data from the buffer will fail until it is unfrozen.
</md:method></p>
<p><md:method>
void public unfreeze ( boolean $at_front = false )</p>
<p>Unfreeze input</p>
<p>$at_front
At front. Default is true. If the front of a buffer is frozen, operations that drain data from the front of the buffer, or that prepend data to the buffer, will fail until it is unfrozen. If the back a buffer is frozen, operations that append data from the buffer will fail until it is unfrozen.
</md:method></p>
<p><md:method>
boolean public isFrozen ( )</p>
<p>Is frozen?
</md:method></p>
<p><md:method>
boolean public isEof ( )</p>
<p>Is EOF?
</md:method></p>
<p><md:method>
void public setRequest ( <a href="#../generic">Generic</a> $req )</p>
<p>Set request</p>
<p>$req
@TODO
</md:method></p>
<p><md:method>
void public sendEOF ( )</p>
<p>Send EOF
</md:method></p>
<p><md:method>
integer public readFromBuffer ( \EventBuffer $buf )</p>
<p>Moves $n bytes from input buffer to arbitrary buffer</p>
<p>$buf
Source nuffer
</md:method></p>
<p><md:method>
void public readFromString ( string $chunk, boolean $final = true )</p>
<p>Append string to input buffer</p>
<p>$chunk
Piece of request input</p>
<p>$final
Final call is THIS SEQUENCE of calls (not mandatory final in request)?
</md:method></p>
<p><md:method>
string public look ( integer $n, integer $o = 0 )</p>
<p>Read from buffer without draining</p>
<p>$n
Number of bytes to read</p>
<p>$o
Offset
</md:method></p>
<p><md:method>
void public parseMultipart ( )</p>
<p>Parses multipart
</md:method></p>
<p><md:method>
string public getChunkString ( )</p>
<p>Get current upload chunk as string
</md:method></p>
<p><md:method>
boolean public writeChunkToFd ( resource $fd, callable $cb = null )</p>
<p>Write current upload chunk to file descriptor</p>
<p>$fd
File destriptor</p>
<p>$cb
Callback
</md:method></p>
<p><md:method>
void public log ( string $msg )</p>
<p>Log</p>
<p>$msg
Message
</md:method></p>
<h2 id="faq"><div class="in anchor">ЧаВО</div>

</h2>
<p><i class="fa fa-question-circle"></i> Как сделать событие, которое вызывается через заданный временной интервал?</p>
<p>См. <a target="_self" class="tpl-inlink" href="#lib/timer">Библиотеки/Timer<i class="fa fa-caret-square-o-up"></i></a></p>
<h2 id="publications"><div class="in anchor">Публикации</div>

</h2>
<ul>
<li><a href="http://habrahabr.ru/blogs/php/104811">phpDaemon и runkit: новый уровень</a> (23 сентября 2010)</li>
<li><a href="http://javascript.ru/blog/Ilya-Kantor/True-FastCGI-dlya-PHP-migraciya-testy">True FastCGI для PHP: миграция и тесты</a> (7 сентября 2010)</li>
<li><a href="http://habrahabr.ru/blogs/webdev/94921">WebSocket: будущее уже здесь!</a> (8 июня 2010)</li>
<li><a href="http://habrahabr.ru/blogs/php/91014">phpDaemon: хорошие новости</a> (24 мая 2010)</li>
<li><a href="http://habrahabr.ru/blogs/php/79377">phpDaemon: фреймворк асинхронных приложений</a> (11 января 2010)</li>
</ul>
<h2 id="contribute"><div class="in anchor">Внести свою лепту</div>

</h2>
<p>Если хотите помочь, то даже если располагаете ограниченным временем, не стесняйтесь!
Проекту пригодится любая помощь. </p>
<h3 id="contribute/this-doc"><div class="in anchor">Эта документация<span class="header-path"> <i>&larr;</i> <a href="#contribute">Внести свою лепту</a></span></div>

</h3>
<p>Мы очень хотим свести количество недокументированного кода к минимуму, но нам не хватает рук.
Даже написав абзац текста, потратив десять минут, вы уже сделаете большое дело.</p>
<h4 id="contribute/this-doc/commiting"><div class="in anchor">Внесение изменений<span class="header-path"> <i>&larr;</i> <a href="#contribute/this-doc">Эта документация</a> <i>&larr;</i> <a href="#contribute">Внести свою лепту</a></span></div>

</h4>
<blockquote>
<p>Старайтесь вносить изменения в на том языке, которым владеете лучше всего.
Если набрались смелости добавить новый язык, возьмите за основу наиболее близкий из присутствующих.</p>
</blockquote>
<p>Чтобы внести изменения в эту документацию, необходимо:</p>
<ol>
<li>Сделать Fork репозитория <a target="_blank" class="tpl-outlink" href="https://github.com/kakserpom/daemon.io">kakserpom/daemon.io<i class="fa fa-external-link"></i></a></li>
<li>Внести изменения в Markdown (.md) файлыв папке <code>./docs/&lt;язык&gt;/</code></li>
<li>Скомпилировать index.html, выполнив команду <code>./docs/build</code></li>
<li>Посмотреть как выглядят внесенные изменения в браузере</li>
<li>Послать Pull Request</li>
</ol>
<blockquote>
<p>Хотите видеть изменения в браузере, не запуская каждый раз команду?
Запустите <code>watch -n1 ./docs/build</code> — она будет выполняться раз в секунду</p>
</blockquote>
<h4 id="contribute/this-doc/markdown"><div class="in anchor">Формат документации<span class="header-path"> <i>&larr;</i> <a href="#contribute/this-doc">Эта документация</a> <i>&larr;</i> <a href="#contribute">Внести свою лепту</a></span></div>

</h4>
<p>Мы используем <a target="_blank" class="tpl-outlink" href="http://ru.wikipedia.org/wiki/Markdown">Markdown<i class="fa fa-external-link"></i></a> (<a target="_blank" class="tpl-outlink" href="http://rukeba.com/by-the-way/markdown-sintaksis-po-russki/">о синтаксисе по-русски<i class="fa fa-external-link"></i></a>) с некоторыми дополнениями.</p>
<h5 id="contribute/this-doc/markdown/nesting"><div class="in anchor">Вложенность<span class="header-path"> <i>&larr;</i> <a href="#contribute/this-doc/markdown">Формат документации</a> <i>&larr;</i> <a href="#contribute/this-doc">Эта документация</a> <i>&larr;</i> <a href="#contribute">Внести свою лепту</a></span></div>

</h5>
<p>Для удобства работы документация разбита на множество мелких файлов.
Подключение файла осуществляется строкой иморта: <code>&amp;lt;!-- import filepath.md --&amp;gt;</code>.
Путь к подключаемому файлу указывается относительно текущего.</p>
<h5 id="contribute/this-doc/markdown/const"><div class="in anchor">Константы<span class="header-path"> <i>&larr;</i> <a href="#contribute/this-doc/markdown">Формат документации</a> <i>&larr;</i> <a href="#contribute/this-doc">Эта документация</a> <i>&larr;</i> <a href="#contribute">Внести свою лепту</a></span></div>

</h5>
<p>Константы используются для языковых настроек и короткой записи часто используемых шаблонов.
Записываются в виде <code>&amp;lt;!-- pvar **название** строка значения --&amp;gt;</code></p>
<p>Обязательные языковые константы <code>lang</code>, <code>title</code>, <code>menu-*</code> должны быть переведены для каждой языковой версии документации.</p>
<p>Константы могут быть использованы как шаблоны. Применение шаблона: <code>{**название** переменная1 переменная2...}</code>. Переменные будут подставлены в шаблон вместо <code>%s</code>.</p>
<p>Пример шаблона:<br />
<code>&amp;lt;!-- pvar tpl-outlink &amp;lt;a target="_blank" href="%s"&amp;gt;%s&amp;lt;i class="fa fa-external-link"&amp;gt;&amp;lt;/i&amp;gt;&amp;lt;/a&amp;gt; --&amp;gt;</code></p>
<p>Пример использования:
<code>&amp;#123;tpl-outlink http://ru.wikipedia.org/wiki/Markdown Markdown&amp;#125;</code></p>
<h5 id="contribute/this-doc/markdown/headers"><div class="in anchor">Заголовки<span class="header-path"> <i>&larr;</i> <a href="#contribute/this-doc/markdown">Формат документации</a> <i>&larr;</i> <a href="#contribute/this-doc">Эта документация</a> <i>&larr;</i> <a href="#contribute">Внести свою лепту</a></span></div>

</h5>
<p>Заголовки могут быть описаны следующими способами:</p>
<ul>
<li><code>## якорь # Заголовок</code></li>
<li><code>## якорь # Заголовок #&gt; Форматированный заголовок</code></li>
</ul>
<p><code>якорь</code> - идентификатор заголовка для навигации. Разрешенные символы <code>[a-zA-Z0-9_-]</code>. Должен быть уникальным по отношению к идентификаторам заголовков текущего уровня в пределах родительского заголовка.</p>
<p><code>Форматированный заголовок</code> используется в тех случаях, когда заголовок в контенте должен отличаться от заголовка в навигационной панели.</p>
<p>Примеры:</p>
<ul>
<li>Заголовок первого уровня: <code>## contribute # Внести свою лепту</code></li>
<li>Заголовок второго уровня: <code>### this-doc # Эта документация</code></li>
<li>Заголовок третьего уровня: <code>#### markdown # Формат документации</code></li>
<li>Заголовок четвертого уровня: <code>#### markdown # Заголовки</code></li>
<li>Форматированный заголовок: <code>### mysql # MySQL #&gt; Клиенты \ MySQL</code></li>
</ul>
<blockquote>
<p>При добавлении нового заголовка учтите, что якорь должен быть строго на английском языке и быть простым и информативным. При переводе якори не изменяются</p>
</blockquote>
<h5 id="contribute/this-doc/markdown/lists"><div class="in anchor">Списки<span class="header-path"> <i>&larr;</i> <a href="#contribute/this-doc/markdown">Формат документации</a> <i>&larr;</i> <a href="#contribute/this-doc">Эта документация</a> <i>&larr;</i> <a href="#contribute">Внести свою лепту</a></span></div>

</h5>
<p>Для списков добавлена возможность указать CSS-класс элемента:</p>
<pre><code> -.n Элемент без символа списка
 -.n.ti Элемент без символа списка и с отступом от предыдущего</code></pre>
<p>На данный момент используются CSS-классы:</p>
<ul>
<li><code>.n</code> - без иконки элемента списка</li>
<li><code>.ti</code> - отступ от предыдущего элемента</li>
<li><code>.method</code> - специальный CSS-класс для записи методов библиотек</li>
</ul>
<h5 id="contribute/this-doc/markdown/italic_bold"><div class="in anchor">Курсив и жирный<span class="header-path"> <i>&larr;</i> <a href="#contribute/this-doc/markdown">Формат документации</a> <i>&larr;</i> <a href="#contribute/this-doc">Эта документация</a> <i>&larr;</i> <a href="#contribute">Внести свою лепту</a></span></div>

</h5>
<p>Выделение курсивом и жирным работает только с помощью звездочки <code>*</code>, знак подчеркивания <code>_</code> отключен для совместимости с программным кодом.</p>
<h5 id="contribute/this-doc/markdown/simple_code"><div class="in anchor">Однострочный код<span class="header-path"> <i>&larr;</i> <a href="#contribute/this-doc/markdown">Формат документации</a> <i>&larr;</i> <a href="#contribute/this-doc">Эта документация</a> <i>&larr;</i> <a href="#contribute">Внести свою лепту</a></span></div>

</h5>
<p>Простое выделение кода апострофами <code>&amp;#96;...&amp;#96;</code> дополнено возможностью применять модификаторы и CSS-классы.<br />
Модификаторы — это опции, включающие дополнительную обработку текста.</p>
<p>Модификаторы и классы пишутся после открывающего апострофа и должны быть закрыты дополнительным перед началом текста. Перед указанием модификаторов ставится символ <code>:</code> (двоеточие). Каждый модификатор указывается одним латинским символом. Классы указываются с помощью ведущей точки.</p>
<blockquote>
<p>При указании одновременно и модификаторов, и классов, сначала должны быть записаны модификаторы.</p>
</blockquote>
<p>Список модификаторов:</p>
<ul>
<li><code>:e</code> - кодировать символы (по-умолчаниб кодирование символов выключено)</li>
<li><code>:p</code> - парсинг ссылок</li>
<li><code>:h</code> - php подсветка кода</li>
<li><code>:c</code> - стилевое оформление без фона и обводки</li>
</ul>
<p>Из классов на данный момент может применять только <code>&amp;#46;clear</code>, но лучше указывайте модификатор <code>&amp;#58;c</code>.</p>
<p>Примеры использования:</p>
<ul>
<li><code>&amp;#96;:hc&amp;#96;$url&amp;#96;</code></li>
<li><code>&amp;#96;:p&amp;#96;max-requests (&amp;#91;Number&amp;#93;(#config/types/number) = '10k')&amp;#96;</code></li>
<li><code>&amp;#96;:ph.clear&amp;#96;callback ( &amp;#91;Connection&amp;#93;(#clients/http/connection) $conn, boolean $success )&amp;#96;</code></li>
</ul>
<h5 id="contribute/this-doc/markdown/multi_code"><div class="in anchor">Многострочный код<span class="header-path"> <i>&larr;</i> <a href="#contribute/this-doc/markdown">Формат документации</a> <i>&larr;</i> <a href="#contribute/this-doc">Эта документация</a> <i>&larr;</i> <a href="#contribute">Внести свою лепту</a></span></div>

</h5>
<p>Многострочный код добавлен возможностью подсветки синтаксиса и указанием CSS-классов.
Код, содержащий конфигурацию, обозначается синтаксисом <code>ruby</code>.</p>
<p>Из классов на данный момент может применять только <code>.inline</code> для оформления методов.</p>
<p>Примеры:</p>
<blockquote>
<p>&#96;&#96;&#96;php.inline<br />
void public post ( url $url, array $data, array $params )<br />
void public post ( url $url, array $data, callable $resultcb )<br />
&#96;&#96;&#96;</p>
<p>&#96;&#96;&#96;ruby<br />
Pool:HTTPServer {  </p>
<pre><code>listen "tcp://0.0.0.0:80", "tcp://0.0.0.0:443##myContext";  
port 80;  
privileged;  
maxconcurrency 1;  </code></pre>
<p>}<br />
&#96;&#96;&#96;</p>
</blockquote>
<h5 id="contribute/this-doc/markdown/tables"><div class="in anchor">Таблицы<span class="header-path"> <i>&larr;</i> <a href="#contribute/this-doc/markdown">Формат документации</a> <i>&larr;</i> <a href="#contribute/this-doc">Эта документация</a> <i>&larr;</i> <a href="#contribute">Внести свою лепту</a></span></div>

</h5>
<p>Включена возможность создавать таблицы по формату <a target="_blank" class="tpl-outlink" href="http://code.google.com/p/support/wiki/WikiSyntax#Tables">Google Code Wiki-style<i class="fa fa-external-link"></i></a>.</p>
<h3 id="contribute/php-doc"><div class="in anchor">PHPDoc<span class="header-path"> <i>&larr;</i> <a href="#contribute">Внести свою лепту</a></span></div>

</h3>
<p>Аналогично, чтобы восполнить пробелы в PHPDoc-комментариях в коде, сделайте Fork <a href="https://github.com/kakserpom/phpdaemon">основного репозитория</a>, внесите изменения и пошлите Pull Request.</p>
<blockquote>
<p>Учтите, что все PHPDoc-комментарии пишутся строго на английском языке</p>
</blockquote>
<h3 id="contribute/code"><div class="in anchor">Программный код<span class="header-path"> <i>&larr;</i> <a href="#contribute">Внести свою лепту</a></span></div>

</h3>
<p>Улучшения программного кода всегда приветствуется. Если у вас есть модуль для публикации, и вы считаете, что он заслуживает включения в основной репозиторий, пришлите Pull Request. Аналогично поступайте с улучшениями существующего кода.</p>
<h2 id="doc-authors"><div class="in anchor">Авторы документации</div>

</h2>
<h3 id="doc-authors/writing"><div class="in anchor">Написание<span class="header-path"> <i>&larr;</i> <a href="#doc-authors">Авторы документации</a></span></div>

</h3>
<p>-.n <a target="_blank" href="https://github.com/EzheG"><i class="fa fa-github"></i></a> Dmitry Efimenko <a href="mailto:[ezheg89@gmail.com](mailto:ezheg89@gmail.com)">[ezheg89@gmail.com](mailto:ezheg89@gmail.com)</a>
-.n <a target="_blank" href="https://github.com/kakserpom"><i class="fa fa-github"></i></a> Vasily Zorin <a href="mailto:[maintainer@daemon.io](mailto:maintainer@daemon.io)">[maintainer@daemon.io](mailto:maintainer@daemon.io)</a>
-.n <a target="_blank" href="https://github.com/nizsheanez"><i class="fa fa-github"></i></a> Alexey Sharov <a href="mailto:[www.pismeco@gmail.com](mailto:www.pismeco@gmail.com)">[www.pismeco@gmail.com](mailto:www.pismeco@gmail.com)</a></p>
<h3 id="doc-authors/translation"><div class="in anchor">Перевод на русский<span class="header-path"> <i>&larr;</i> <a href="#doc-authors">Авторы документации</a></span></div>

</h3>
<p>-.n <a target="_blank" href="https://github.com/kakserpom"><i class="fa fa-github"></i></a> Vasily Zorin <a href="mailto:[maintainer@daemon.io](mailto:maintainer@daemon.io)">[maintainer@daemon.io](mailto:maintainer@daemon.io)</a></p>
<h3 id="doc-authors/proofreading"><div class="in anchor">Корректура русской версии<span class="header-path"> <i>&larr;</i> <a href="#doc-authors">Авторы документации</a></span></div>

</h3>
<p>...</p>
<h3 id="doc-authors/scripting"><div class="in anchor">Программирование<span class="header-path"> <i>&larr;</i> <a href="#doc-authors">Авторы документации</a></span></div>

</h3>
<p>-.n <a target="_blank" href="https://github.com/EzheG"><i class="fa fa-github"></i></a> Dmitry Efimenko <a href="mailto:[ezheg89@gmail.com](mailto:ezheg89@gmail.com)">[ezheg89@gmail.com](mailto:ezheg89@gmail.com)</a></p>
<p>Движок документации был изначально основан на <a target="_blank" href="https://github.com/chibisov/backdoc">Backdoc <i class="fa fa-github"></i></a></p>
        </div>
    </div>
    <a href="https://github.com/kakserpom/phpdaemon" class="forkButton" target="_blank"><img src="/img/forkme.png" height="149" width="149" alt="Fork me on GitHub"></a>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="../js/jquery-1.11.0.min.js"><\/script>')</script>
    <script src="../js/jquery.ba-throttle-debounce.js"></script>
    <script src="../js/waypoints.js"></script>
    <!-- <script src="../js/highlight.pack.js"></script> -->
    <script src="../js/highlight_source/build/highlight.pack.js"></script>
    <script src="../js/main.js"></script>
<!--
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'phpdaemon';
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
-->
</body>
</html>